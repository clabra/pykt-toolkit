
================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   7d3d89adaf048b23dd42b85e812e242e
  Computed MD5: 7d3d89adaf048b23dd42b85e812e242e
  Total parameters: 32
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  Model uses explicit parameter pattern (not config dict)
  config.get() calls:          0
  config['key'] direct access: 0
  Pattern: ‚úÖ Explicit parameters (standard pykt)

  Result: ‚úÖ PASS - Model uses explicit parameters (no fallbacks possible)

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Model: idkt
  Core training params:  ‚úÖ (7/7)
  Attention config:      ‚úÖ
  Model size config:     ‚úÖ
  Depth config:          ‚úÖ
  FFN config:            ‚úÖ
  Dropout config:        ‚úÖ
  Model-specific params: ‚úÖ (2/2)

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    32
  Launcher-only (excluded):         5
  Should have argparse:             27
  Found in argparse:                27
  Boolean flags (store_true/false): 1
  Non-boolean params:               26
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (1 boolean flags, 26 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 32
  Should be excluded:           4
  Should pass to training:      28

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
Loading dataset: assist2009, fold: 0
  Using augmented training file: train_valid_sequences_bkt.csv
dataset_name:assist2009
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences_bkt.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_0.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 741 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 741, clen: 741, rlen: 741
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_1_2_3_4.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 3016 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 3016, clen: 3016, rlen: 3016
  Loaded BKT skill parameters from: /workspaces/pykt-toolkit/data/assist2009/bkt_skill_params.pkl
Initializing iDKT model...
  d_model=256, n_heads=8, n_blocks=4
  dropout=0.2, final_fc_dim=512
Starting training for 100 epochs...
  learning_rate=0.0001, batch_size=64
  optimizer=Adam, l2=1e-05

================================================================================
LOSS CALIBRATION PASS (WARM-UP)
================================================================================
Executing initial forward pass to normalize lambda weights...
  ‚úì L_ref: Target Ratio 45.0%, Calibrated Lambda: 5.166694 (Init MSE: 0.062362)
  ‚úì L_initmastery: Target Ratio 10.0%, Calibrated Lambda: 1.531303 (Init MSE: 0.046758)
  ‚úì L_rate: Target Ratio 10.0%, Calibrated Lambda: 0.447817 (Init MSE: 0.159889)
Calibrated weights will be used to maintain theory/supervised signal balance.
================================================================================

ts.shape: (52825,), ps.shape: (52825,)
Epoch 1/100: Loss=0.7367 (SUP=0.5863, REF=0.0217, IM=0.0165, RT=0.0293), Valid AUC=0.7548
  ‚úì Saved best model (AUC: 0.7548)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 2/100: Loss=0.6426 (SUP=0.5513, REF=0.0158, IM=0.0049, RT=0.0047), Valid AUC=0.7719
  ‚úì Saved best model (AUC: 0.7719)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 3/100: Loss=0.6253 (SUP=0.5433, REF=0.0150, IM=0.0022, RT=0.0028), Valid AUC=0.7796
  ‚úì Saved best model (AUC: 0.7796)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 4/100: Loss=0.6151 (SUP=0.5392, REF=0.0142, IM=0.0013, RT=0.0018), Valid AUC=0.7842
  ‚úì Saved best model (AUC: 0.7842)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 5/100: Loss=0.6091 (SUP=0.5364, REF=0.0137, IM=0.0009, RT=0.0013), Valid AUC=0.7851
  ‚úì Saved best model (AUC: 0.7851)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 6/100: Loss=0.6050 (SUP=0.5348, REF=0.0133, IM=0.0007, RT=0.0009), Valid AUC=0.7855
  ‚úì Saved best model (AUC: 0.7855)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 7/100: Loss=0.6024 (SUP=0.5337, REF=0.0131, IM=0.0006, RT=0.0008), Valid AUC=0.7858
  ‚úì Saved best model (AUC: 0.7858)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 8/100: Loss=0.6000 (SUP=0.5329, REF=0.0128, IM=0.0005, RT=0.0006), Valid AUC=0.7865
  ‚úì Saved best model (AUC: 0.7865)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 9/100: Loss=0.5983 (SUP=0.5319, REF=0.0127, IM=0.0005, RT=0.0005), Valid AUC=0.7864
ts.shape: (52825,), ps.shape: (52825,)
Epoch 10/100: Loss=0.5966 (SUP=0.5318, REF=0.0124, IM=0.0004, RT=0.0005), Valid AUC=0.7855
ts.shape: (52825,), ps.shape: (52825,)
Epoch 11/100: Loss=0.5948 (SUP=0.5308, REF=0.0122, IM=0.0004, RT=0.0004), Valid AUC=0.7864
ts.shape: (52825,), ps.shape: (52825,)
Epoch 12/100: Loss=0.5935 (SUP=0.5306, REF=0.0120, IM=0.0003, RT=0.0004), Valid AUC=0.7865
  ‚úì Saved best model (AUC: 0.7865)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 13/100: Loss=0.5920 (SUP=0.5297, REF=0.0119, IM=0.0003, RT=0.0003), Valid AUC=0.7862
ts.shape: (52825,), ps.shape: (52825,)
Epoch 14/100: Loss=0.5908 (SUP=0.5292, REF=0.0118, IM=0.0003, RT=0.0003), Valid AUC=0.7868
  ‚úì Saved best model (AUC: 0.7868)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 15/100: Loss=0.5894 (SUP=0.5289, REF=0.0116, IM=0.0003, RT=0.0003), Valid AUC=0.7863
ts.shape: (52825,), ps.shape: (52825,)
Epoch 16/100: Loss=0.5886 (SUP=0.5286, REF=0.0115, IM=0.0003, RT=0.0003), Valid AUC=0.7868
ts.shape: (52825,), ps.shape: (52825,)
Epoch 17/100: Loss=0.5875 (SUP=0.5282, REF=0.0114, IM=0.0003, RT=0.0003), Valid AUC=0.7870
  ‚úì Saved best model (AUC: 0.7870)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 18/100: Loss=0.5862 (SUP=0.5276, REF=0.0112, IM=0.0002, RT=0.0002), Valid AUC=0.7858
ts.shape: (52825,), ps.shape: (52825,)
Epoch 19/100: Loss=0.5850 (SUP=0.5267, REF=0.0112, IM=0.0002, RT=0.0002), Valid AUC=0.7865
ts.shape: (52825,), ps.shape: (52825,)
Epoch 20/100: Loss=0.5843 (SUP=0.5263, REF=0.0111, IM=0.0002, RT=0.0002), Valid AUC=0.7869
ts.shape: (52825,), ps.shape: (52825,)
Epoch 21/100: Loss=0.5831 (SUP=0.5262, REF=0.0109, IM=0.0002, RT=0.0002), Valid AUC=0.7874
  ‚úì Saved best model (AUC: 0.7874)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 22/100: Loss=0.5821 (SUP=0.5253, REF=0.0109, IM=0.0002, RT=0.0002), Valid AUC=0.7873
ts.shape: (52825,), ps.shape: (52825,)
Epoch 23/100: Loss=0.5811 (SUP=0.5247, REF=0.0108, IM=0.0002, RT=0.0002), Valid AUC=0.7876
  ‚úì Saved best model (AUC: 0.7876)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 24/100: Loss=0.5799 (SUP=0.5236, REF=0.0108, IM=0.0002, RT=0.0002), Valid AUC=0.7872
ts.shape: (52825,), ps.shape: (52825,)
Epoch 25/100: Loss=0.5788 (SUP=0.5232, REF=0.0107, IM=0.0002, RT=0.0002), Valid AUC=0.7880
  ‚úì Saved best model (AUC: 0.7880)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 26/100: Loss=0.5774 (SUP=0.5218, REF=0.0107, IM=0.0002, RT=0.0002), Valid AUC=0.7879
ts.shape: (52825,), ps.shape: (52825,)
Epoch 27/100: Loss=0.5761 (SUP=0.5207, REF=0.0106, IM=0.0002, RT=0.0002), Valid AUC=0.7871
ts.shape: (52825,), ps.shape: (52825,)
Epoch 28/100: Loss=0.5755 (SUP=0.5201, REF=0.0106, IM=0.0002, RT=0.0002), Valid AUC=0.7882
  ‚úì Saved best model (AUC: 0.7882)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 29/100: Loss=0.5739 (SUP=0.5187, REF=0.0106, IM=0.0002, RT=0.0002), Valid AUC=0.7886
  ‚úì Saved best model (AUC: 0.7886)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 30/100: Loss=0.5733 (SUP=0.5180, REF=0.0106, IM=0.0002, RT=0.0002), Valid AUC=0.7874
ts.shape: (52825,), ps.shape: (52825,)
Epoch 31/100: Loss=0.5720 (SUP=0.5166, REF=0.0107, IM=0.0002, RT=0.0002), Valid AUC=0.7880
ts.shape: (52825,), ps.shape: (52825,)
Epoch 32/100: Loss=0.5712 (SUP=0.5156, REF=0.0107, IM=0.0002, RT=0.0002), Valid AUC=0.7876
ts.shape: (52825,), ps.shape: (52825,)
Epoch 33/100: Loss=0.5699 (SUP=0.5142, REF=0.0107, IM=0.0002, RT=0.0002), Valid AUC=0.7883
ts.shape: (52825,), ps.shape: (52825,)
Epoch 34/100: Loss=0.5692 (SUP=0.5132, REF=0.0108, IM=0.0002, RT=0.0002), Valid AUC=0.7893
  ‚úì Saved best model (AUC: 0.7893)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_valid.csv
ts.shape: (52825,), ps.shape: (52825,)
Epoch 35/100: Loss=0.5680 (SUP=0.5122, REF=0.0107, IM=0.0002, RT=0.0002), Valid AUC=0.7885
ts.shape: (52825,), ps.shape: (52825,)
Epoch 36/100: Loss=0.5675 (SUP=0.5115, REF=0.0108, IM=0.0002, RT=0.0002), Valid AUC=0.7887
ts.shape: (52825,), ps.shape: (52825,)
Epoch 37/100: Loss=0.5670 (SUP=0.5109, REF=0.0108, IM=0.0002, RT=0.0002), Valid AUC=0.7888
ts.shape: (52825,), ps.shape: (52825,)
Epoch 38/100: Loss=0.5660 (SUP=0.5100, REF=0.0108, IM=0.0002, RT=0.0002), Valid AUC=0.7889
ts.shape: (52825,), ps.shape: (52825,)
Epoch 39/100: Loss=0.5654 (SUP=0.5092, REF=0.0108, IM=0.0001, RT=0.0002), Valid AUC=0.7888
ts.shape: (52825,), ps.shape: (52825,)
Epoch 40/100: Loss=0.5646 (SUP=0.5082, REF=0.0109, IM=0.0001, RT=0.0001), Valid AUC=0.7882
ts.shape: (52825,), ps.shape: (52825,)
Epoch 41/100: Loss=0.5643 (SUP=0.5079, REF=0.0108, IM=0.0001, RT=0.0001), Valid AUC=0.7890
ts.shape: (52825,), ps.shape: (52825,)
Epoch 42/100: Loss=0.5639 (SUP=0.5074, REF=0.0109, IM=0.0001, RT=0.0001), Valid AUC=0.7887
ts.shape: (52825,), ps.shape: (52825,)
Epoch 43/100: Loss=0.5637 (SUP=0.5069, REF=0.0109, IM=0.0001, RT=0.0001), Valid AUC=0.7880
ts.shape: (52825,), ps.shape: (52825,)
Epoch 44/100: Loss=0.5628 (SUP=0.5062, REF=0.0109, IM=0.0001, RT=0.0001), Valid AUC=0.7884
Early stopping at epoch 44

Training completed!
  Best epoch: 34
  Valid AUC: 0.7893, Valid Acc: 0.7471
‚úì Saved training results: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/results.json
Loading dataset: assist2009, fold: 0
dataset_name:assist2009
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences.csv_0.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 741 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences.csv, qlen: 741, clen: 741, rlen: 741
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences.csv_1_2_3_4.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 3016 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences.csv, qlen: 3016, clen: 3016, rlen: 3016
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/test_sequences.csv_-1.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 904 students
file path: /workspaces/pykt-toolkit/data/assist2009/test_sequences.csv, qlen: 904, clen: 904, rlen: 904
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/test_window_sequences.csv_-1.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 20362 students
file path: /workspaces/pykt-toolkit/data/assist2009/test_window_sequences.csv, qlen: 20362, clen: 20362, rlen: 20362
‚úì Loaded datasets (train: 3016, valid: 741, test: 904)
Initializing model...
Loading checkpoint from /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/best_model.pt
Evaluating on validation set...
ts.shape: (52825,), ps.shape: (52825,)
Valid AUC: 0.7893, Valid Acc: 0.7471
Evaluating on test set...
ts.shape: (61904,), ps.shape: (61904,)
Test AUC: 0.7848, Test Acc: 0.7371
ts.shape: (62040,), ps.shape: (62040,)
Window Test AUC: 0.7871, Window Test Acc: 0.7382
‚úì Saved test metrics: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/metrics_test.csv

Results saved to /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/eval_results.json
dataset_name:assist2009
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences_bkt.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_0.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 741 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 741, clen: 741, rlen: 741
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_1_2_3_4.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 3016 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 3016, clen: 3016, rlen: 3016
Pre-initializing rosters for 1000 students...
Running inference for interpretability alignment...
‚úì Saved Initial Mastery Alignment: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/traj_initmastery.csv
‚úì Saved Prediction Trajectory Alignment: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/traj_predictions.csv
‚úì Saved Learning Rate Alignment: /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/traj_rate.csv

Alignment Results:
  prediction_mse: 0.0179
  prediction_corr: 0.8317
  initmastery_mse: 0.0000
  initmastery_corr: 0.9995
  learning_rate_mse: 0.0001
  learning_rate_corr: 0.9980
================================================================================
Generating Analysis Plots for iKT Experiment
================================================================================
Run directory: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116

‚úì Plots directory: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/plots

‚úì Loading metrics from: metrics_epoch.csv
‚úì Detected comprehensive iDKT metrics format
‚úì Loaded config: epsilon=0.05, lambda_penalty=100.0

================================================================================
Generating Plots
================================================================================

1. Loss Evolution (iDKT)...
‚úì Saved: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/plots/loss_evolution.png
2. Per-Skill Alignment Heatmaps...
‚úì Loaded 44226 records from traj_initmastery.csv
   Generating per_skill_alignment_initmastery.png...
üìä Using columns for alignment plot: idkt_im vs bkt_im
‚úì Saved: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/plots/per_skill_alignment_initmastery.png
‚úì Loaded 44226 records from traj_predictions.csv
   Generating per_skill_alignment_predictions.png...
üìä Using columns for alignment plot: p_idkt vs p_bkt
‚úì Saved: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/plots/per_skill_alignment_predictions.png
‚úì Loaded 44226 records from traj_rate.csv
   Generating per_skill_alignment_rate.png...
üìä Using columns for alignment plot: idkt_rate vs bkt_rate
‚úì Saved: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/plots/per_skill_alignment_rate.png

================================================================================
‚úÖ All plots generated successfully
================================================================================

Plots saved in: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/plots
Generating validation plots for experiments/20251219_165515_idkt_pareto_highres_l0.45_285116...
Error: Required files missing. (pred: True, roster: False)
================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 285116
‚úì Created experiment folder: 20251219_165515_idkt_pareto_highres_l0.45_285116
  Override: short_title = pareto_highres_l0.45 (type: str)
  Override: epochs = 100 (type: int)
  Override: lambda_ref = 0.45 (type: float)
  Override: theory_guided = 1 (type: int)
  Override: calibrate = 1 (type: int)
‚úì Saved config.json
‚úì Config integrity verified (MD5: 7d3d89adaf048b23dd42b85e812e242e)

Experiment ID:            285116
Dataset:                  assist2009
Fold:                     0
Epochs:                   100
Batch size:               64
Learning rate:            0.0001

Training command:        
  EXPERIMENT_DIR=/workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116 /home/vscode/.pykt-env/bin/python examples/train_idkt.py --batch_size 64 --bkt_guess_threshold 0.3 --bkt_slip_threshold 0.3 --calibrate 1 --d_ff 512 --d_model 256 --dataset assist2009 --dropout 0.2 --emb_type qid --epochs 100 --final_fc_dim 512 --fold 0 --gradient_clip 1.0 --l2 1e-05 --lambda_initmastery 0.1 --lambda_rate 0.1 --lambda_ref 0.45 --learning_rate 0.0001 --n_blocks 4 --n_heads 8 --optimizer Adam --patience 10 --seed 42 --seq_len 200 --theory_guided 1 --weight_decay 0.0 --save_dir /workspaces/pykt-toolkit/experiments/20251219_165515_idkt_pareto_highres_l0.45_285116

================================================================================
SINGLE-PHASE TRAINING (iDKT)
================================================================================
Standard training with Rasch-based difficulty regularization
================================================================================


================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116

================================================================================
LAUNCHING EVALUATION
================================================================================


‚úì Evaluation completed successfully
  Results saved to: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/eval_results.json

================================================================================
COMPUTING iDKT INTERPRETABILITY ALIGNMENT
================================================================================

Comparing model predictions and projections vs BKT ground truth...

‚úì iDKT interpretability evaluation completed successfully
  Output file: experiments/20251219_165515_idkt_pareto_highres_l0.45_285116/interpretability_alignment.json

================================================================================
Generating analysis plots...
================================================================================

‚úì Analysis plots generated successfully

================================================================================
Generating validation plots (Consensus, Residual, Uncertainty)...
================================================================================

‚úì Validation plots generated successfully

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 285116
