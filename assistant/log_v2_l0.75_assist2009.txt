
================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   29c47dbc897d943abafb8b4d9ae79f90
  Computed MD5: 29c47dbc897d943abafb8b4d9ae79f90
  Total parameters: 34
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  Model uses explicit parameter pattern (not config dict)
  config.get() calls:          0
  config['key'] direct access: 0
  Pattern: ‚úÖ Explicit parameters (standard pykt)

  Result: ‚úÖ PASS - Model uses explicit parameters (no fallbacks possible)

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Model: idkt
  Core training params:  ‚úÖ (7/7)
  Attention config:      ‚úÖ
  Model size config:     ‚úÖ
  Depth config:          ‚úÖ
  FFN config:            ‚úÖ
  Dropout config:        ‚úÖ
  Model-specific params: ‚úÖ (2/2)

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    34
  Launcher-only (excluded):         5
  Should have argparse:             29
  Found in argparse:                29
  Boolean flags (store_true/false): 1
  Non-boolean params:               28
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (1 boolean flags, 28 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 34
  Should be excluded:           4
  Should pass to training:      30

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
Loading dataset: assist2009, fold: 0
  Using augmented training file: train_valid_sequences_bkt.csv
dataset_name:assist2009
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences_bkt.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_0.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 741 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 741, clen: 741, rlen: 741
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_1_2_3_4.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 3016 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 3016, clen: 3016, rlen: 3016
  Detected 2465 unique students in training set.
  Loaded BKT skill parameters from: /workspaces/pykt-toolkit/data/assist2009/bkt_skill_params.pkl
Initializing iDKT model...
  d_model=256, n_heads=8, n_blocks=4
  dropout=0.2, final_fc_dim=512
  [iDKT] Theory bases initialized from BKT parameters.
Starting training for 100 epochs...
  learning_rate=0.0001, batch_size=64
  optimizer=Adam, l2=1e-05

================================================================================
LOSS CALIBRATION PASS (WARM-UP)
================================================================================
Executing initial forward pass to normalize lambda weights...
  ‚úì L_ref: Target Ratio 75.0%, Calibrated Lambda: 8.773795 (Init MSE: 0.060906)
  ‚úì L_initmastery: Target Ratio 75.0%, Calibrated Lambda: 44.939745 (Init MSE: 0.011891)
  ‚úì L_rate: Target Ratio 75.0%, Calibrated Lambda: 2.871694 (Init MSE: 0.186083)
Calibrated weights will be used to maintain theory/supervised signal balance.
================================================================================

Epoch 1/100: Loss=1.8643 (Raw SUP=0.5895, REF=0.0214, IM=0.0124, RT=0.1841), Gap_L2=62.0829, Stu_L2=59.9076, Valid AUC=0.7485
  ‚úì Saved best model (AUC: 0.7485)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 2/100: Loss=1.7742 (Raw SUP=0.5620, REF=0.0154, IM=0.0122, RT=0.1831), Gap_L2=62.0560, Stu_L2=59.8866, Valid AUC=0.7559
  ‚úì Saved best model (AUC: 0.7559)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 3/100: Loss=1.7507 (Raw SUP=0.5577, REF=0.0143, IM=0.0121, RT=0.1822), Gap_L2=62.0284, Stu_L2=59.8726, Valid AUC=0.7590
  ‚úì Saved best model (AUC: 0.7590)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 4/100: Loss=1.7308 (Raw SUP=0.5549, REF=0.0134, IM=0.0119, RT=0.1813), Gap_L2=62.0029, Stu_L2=59.8528, Valid AUC=0.7607
  ‚úì Saved best model (AUC: 0.7607)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 5/100: Loss=1.7122 (Raw SUP=0.5529, REF=0.0126, IM=0.0118, RT=0.1804), Gap_L2=61.9756, Stu_L2=59.8267, Valid AUC=0.7592
Epoch 6/100: Loss=1.6960 (Raw SUP=0.5518, REF=0.0119, IM=0.0116, RT=0.1795), Gap_L2=61.9497, Stu_L2=59.7954, Valid AUC=0.7607
  ‚úì Saved best model (AUC: 0.7607)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 7/100: Loss=1.6814 (Raw SUP=0.5505, REF=0.0114, IM=0.0115, RT=0.1787), Gap_L2=61.9261, Stu_L2=59.7641, Valid AUC=0.7618
  ‚úì Saved best model (AUC: 0.7618)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 8/100: Loss=1.6685 (Raw SUP=0.5497, REF=0.0110, IM=0.0114, RT=0.1778), Gap_L2=61.9033, Stu_L2=59.7311, Valid AUC=0.7633
  ‚úì Saved best model (AUC: 0.7633)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 9/100: Loss=1.6564 (Raw SUP=0.5491, REF=0.0107, IM=0.0112, RT=0.1770), Gap_L2=61.8814, Stu_L2=59.6981, Valid AUC=0.7630
Epoch 10/100: Loss=1.6444 (Raw SUP=0.5489, REF=0.0103, IM=0.0111, RT=0.1761), Gap_L2=61.8596, Stu_L2=59.6650, Valid AUC=0.7626
Epoch 11/100: Loss=1.6335 (Raw SUP=0.5486, REF=0.0101, IM=0.0109, RT=0.1753), Gap_L2=61.8387, Stu_L2=59.6310, Valid AUC=0.7635
  ‚úì Saved best model (AUC: 0.7635)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 12/100: Loss=1.6224 (Raw SUP=0.5481, REF=0.0098, IM=0.0108, RT=0.1745), Gap_L2=61.8183, Stu_L2=59.5991, Valid AUC=0.7634
Epoch 13/100: Loss=1.6120 (Raw SUP=0.5477, REF=0.0096, IM=0.0107, RT=0.1736), Gap_L2=61.7984, Stu_L2=59.5666, Valid AUC=0.7631
Epoch 14/100: Loss=1.6017 (Raw SUP=0.5473, REF=0.0094, IM=0.0106, RT=0.1728), Gap_L2=61.7791, Stu_L2=59.5342, Valid AUC=0.7635
  ‚úì Saved best model (AUC: 0.7635)
  ‚úì Saved validation metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_valid.csv
Epoch 15/100: Loss=1.5920 (Raw SUP=0.5472, REF=0.0092, IM=0.0104, RT=0.1720), Gap_L2=61.7598, Stu_L2=59.5021, Valid AUC=0.7629
Epoch 16/100: Loss=1.5813 (Raw SUP=0.5465, REF=0.0089, IM=0.0103, RT=0.1712), Gap_L2=61.7421, Stu_L2=59.4707, Valid AUC=0.7633
Epoch 17/100: Loss=1.5728 (Raw SUP=0.5465, REF=0.0089, IM=0.0102, RT=0.1704), Gap_L2=61.7249, Stu_L2=59.4387, Valid AUC=0.7626
Epoch 18/100: Loss=1.5634 (Raw SUP=0.5465, REF=0.0087, IM=0.0101, RT=0.1696), Gap_L2=61.7080, Stu_L2=59.4070, Valid AUC=0.7623
Epoch 19/100: Loss=1.5541 (Raw SUP=0.5462, REF=0.0085, IM=0.0100, RT=0.1688), Gap_L2=61.6907, Stu_L2=59.3745, Valid AUC=0.7626
Epoch 20/100: Loss=1.5452 (Raw SUP=0.5458, REF=0.0084, IM=0.0098, RT=0.1680), Gap_L2=61.6741, Stu_L2=59.3420, Valid AUC=0.7623
Epoch 21/100: Loss=1.5359 (Raw SUP=0.5455, REF=0.0082, IM=0.0097, RT=0.1672), Gap_L2=61.6581, Stu_L2=59.3103, Valid AUC=0.7626
Epoch 22/100: Loss=1.5276 (Raw SUP=0.5455, REF=0.0081, IM=0.0096, RT=0.1664), Gap_L2=61.6412, Stu_L2=59.2793, Valid AUC=0.7618
Epoch 23/100: Loss=1.5192 (Raw SUP=0.5450, REF=0.0080, IM=0.0095, RT=0.1656), Gap_L2=61.6268, Stu_L2=59.2475, Valid AUC=0.7618
Epoch 24/100: Loss=1.5104 (Raw SUP=0.5447, REF=0.0079, IM=0.0094, RT=0.1648), Gap_L2=61.6123, Stu_L2=59.2157, Valid AUC=0.7615
Early stopping at epoch 24

Running final evaluation on sets...
‚úì Saved training results: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/results.json
Loading dataset: assist2009, fold: 0
dataset_name:assist2009
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
  Using augmented training file: train_valid_sequences_bkt.csv
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_0.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 741 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 741, clen: 741, rlen: 741
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_1_2_3_4.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 3016 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 3016, clen: 3016, rlen: 3016
  Using augmented test file: /workspaces/pykt-toolkit/data/assist2009/test_sequences_bkt.csv
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/test_sequences_bkt.csv_-1.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 904 students
file path: /workspaces/pykt-toolkit/data/assist2009/test_sequences_bkt.csv, qlen: 904, clen: 904, rlen: 904
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/test_window_sequences.csv_-1.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 20362 students
file path: /workspaces/pykt-toolkit/data/assist2009/test_window_sequences.csv, qlen: 20362, clen: 20362, rlen: 20362
‚úì Loaded datasets (train: 3016, valid: 741, test: 904)
  Loaded BKT skill parameters from: /workspaces/pykt-toolkit/data/assist2009/bkt_skill_params.pkl
Loading checkpoint from /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/best_model.pt to detect n_uid...
Detected 2465 students in checkpoint.
Initializing model...
Evaluating on validation set...
Valid AUC: 0.7635, Valid Acc: 0.7367
Evaluating on test set...
Test AUC: 0.7579, Test Acc: 0.7244
Window Test AUC: 0.7597, Window Test Acc: 0.7254
‚úì Saved test metrics: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/metrics_test.csv

Results saved to /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/eval_results.json
dataset_name:assist2009
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences_bkt.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_0.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 741 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 741, clen: 741, rlen: 741
Read data from processed file: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv_1_2_3_4.pkl
Computing per-skill practice counts...
‚úì Added per-skill practice counts for 3016 students
file path: /workspaces/pykt-toolkit/data/assist2009/train_valid_sequences_bkt.csv, qlen: 3016, clen: 3016, rlen: 3016
Loading checkpoint from /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/best_model.pt to detect n_uid...
Detected 2465 students in checkpoint.
Pre-initializing rosters for 1000 students...
Running inference for interpretability alignment...
‚úì Saved Initial Mastery Alignment: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/traj_initmastery.csv
‚úì Saved Prediction Trajectory Alignment: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/traj_predictions.csv
‚úì Saved Learning Rate Alignment: /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/traj_rate.csv

Alignment Results:
  prediction_mse: 0.0166
  prediction_corr: 0.8315
  initmastery_mse: 0.0101
  initmastery_corr: 0.9877
  learning_rate_mse: 0.1713
  learning_rate_corr: 0.9984
================================================================================
Generating Analysis Plots for iKT Experiment
================================================================================
Run directory: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607

‚úì Plots directory: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/plots

‚úì Loading metrics from: metrics_epoch.csv
‚úì Detected comprehensive iDKT metrics format
‚úì Loaded config: epsilon=0.05, lambda_penalty=100.0

================================================================================
Generating Plots
================================================================================

1. Loss Evolution (iDKT)...
‚úì Saved: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/plots/loss_evolution.png
2. Per-Skill Alignment Heatmaps...
‚úì Loaded 44226 records from traj_initmastery.csv
   Generating per_skill_alignment_initmastery.png...
üìä Using columns for alignment plot: idkt_im vs bkt_im
‚úì Saved: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/plots/per_skill_alignment_initmastery.png
‚úì Loaded 44226 records from traj_predictions.csv
   Generating per_skill_alignment_predictions.png...
üìä Using columns for alignment plot: p_idkt vs p_bkt
‚úì Saved: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/plots/per_skill_alignment_predictions.png
‚úì Loaded 44226 records from traj_rate.csv
   Generating per_skill_alignment_rate.png...
üìä Using columns for alignment plot: idkt_rate vs bkt_rate
‚úì Saved: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/plots/per_skill_alignment_rate.png

================================================================================
‚úÖ All plots generated successfully
================================================================================

Plots saved in: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/plots
Generating validation plots for experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607...
Error: Required files missing. (pred: True, roster: False)
================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 817607
‚úì Created experiment folder: 20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607
  Override: short_title = pareto_v2_l0.75_assist2009 (type: str)
  Override: epochs = 100 (type: int)
  Override: lambda_ref = 0.75 (type: float)
  Override: lambda_initmastery = 0.75 (type: float)
  Override: lambda_rate = 0.75 (type: float)
  Override: theory_guided = 1 (type: int)
  Override: calibrate = 1 (type: int)
‚úì Saved config.json
‚úì Config integrity verified (MD5: 29c47dbc897d943abafb8b4d9ae79f90)

Experiment ID:            817607
Dataset:                  assist2009
Fold:                     0
Epochs:                   100
Batch size:               64
Learning rate:            0.0001

Training command:        
  EXPERIMENT_DIR=/workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607 /home/vscode/.pykt-env/bin/python examples/train_idkt.py --batch_size 64 --bkt_guess_threshold 0.3 --bkt_slip_threshold 0.3 --calibrate 1 --d_ff 512 --d_model 256 --dataset assist2009 --dropout 0.2 --emb_type qid --epochs 100 --final_fc_dim 512 --fold 0 --gradient_clip 1.0 --l2 1e-05 --lambda_gap 1e-05 --lambda_initmastery 0.75 --lambda_rate 0.75 --lambda_ref 0.75 --lambda_student 1e-05 --learning_rate 0.0001 --n_blocks 4 --n_heads 8 --optimizer Adam --patience 10 --seed 42 --seq_len 200 --theory_guided 1 --weight_decay 0.0 --save_dir /workspaces/pykt-toolkit/experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607

================================================================================
SINGLE-PHASE TRAINING (iDKT)
================================================================================
Standard training with Rasch-based difficulty regularization
================================================================================


================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607

================================================================================
LAUNCHING EVALUATION
================================================================================


‚úì Evaluation completed successfully
  Results saved to: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/eval_results.json

================================================================================
COMPUTING iDKT INTERPRETABILITY ALIGNMENT
================================================================================

Comparing model predictions and projections vs BKT ground truth...

‚úì iDKT interpretability evaluation completed successfully
  Output file: experiments/20251221_134728_idkt_pareto_v2_l0.75_assist2009_817607/interpretability_alignment.json

================================================================================
Generating analysis plots...
================================================================================

‚úì Analysis plots generated successfully

================================================================================
Generating validation plots (Consensus, Residual, Uncertainty)...
================================================================================

‚úì Validation plots generated successfully

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 817607
