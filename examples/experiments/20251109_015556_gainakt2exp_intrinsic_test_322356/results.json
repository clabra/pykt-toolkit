{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7193815307377749,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.021226461365025553,
    "gain_correlation": 0.026560434816404244
  },
  "train_history": {
    "train_loss": [
      0.608705973995782,
      0.5987669396276919,
      0.5973479973219837,
      0.5984113126838763,
      0.5981169843303107,
      0.593740692101612,
      0.5876437453408315,
      0.5842483442064395,
      0.5596404228494575,
      0.5435306457657888,
      0.5322803845677351,
      0.524055867306309
    ],
    "train_auc": [
      0.6802406603038559,
      0.7178227464759043,
      0.7331601245766066,
      0.7467761660700607,
      0.7620082587784724,
      0.7776422841810432,
      0.7923632716553433,
      0.8056617064097383,
      0.8261686227880305,
      0.8393138476222423,
      0.8482346976394519,
      0.8538909786232156
    ],
    "val_auc": [
      0.7112255046171562,
      0.7193815307377749,
      0.7187823338482114,
      0.7122418349372454,
      0.7048715247979656,
      0.6974304173884533,
      0.6900858373582919,
      0.6776041263267496,
      0.6718029141769125,
      0.6631994991799838,
      0.6575980543017839,
      0.6605783509322452
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0627125922281875,
        "gain_correlation": 0.050665059961907954
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.060145443577197345,
        "gain_correlation": 0.08631543723378293
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05926837581251117,
        "gain_correlation": 0.056461799725587146
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05778856671317956,
        "gain_correlation": 0.07182223673825046
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.059089601948046265,
        "gain_correlation": 0.05617559036808062
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05924922413933355,
        "gain_correlation": 0.06268326278512198
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.060583158754391776,
        "gain_correlation": 0.052050972411353695
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05965416999708885,
        "gain_correlation": 0.06009558060220314
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.059704084296839176,
        "gain_correlation": 0.06509648090130016
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.059953838497849125,
        "gain_correlation": 0.06341054411299976
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.060686945911580324,
        "gain_correlation": 0.05913333493482578
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06210693308051785,
        "gain_correlation": 0.06724925155712273
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.0627125922281875,
        "gain_correlation": 0.050665059961907954,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.879344910747919,
          "constraint_total": 0.12065509096441701,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16563669654230276,
        "min_mastery_variance": 0.13089711964130402,
        "max_mastery_variance": 0.215284064412117,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.060145443577197345,
        "gain_correlation": 0.08631543723378293,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8650363986867483,
          "constraint_total": 0.13496360202244992,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16345877613428342,
        "min_mastery_variance": 0.14200882613658905,
        "max_mastery_variance": 0.17761686444282532,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.05926837581251117,
        "gain_correlation": 0.056461799725587146,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8508620541920776,
          "constraint_total": 0.14913794470928515,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15644435847052637,
        "min_mastery_variance": 0.1418965458869934,
        "max_mastery_variance": 0.171797513961792,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.05778856671317956,
        "gain_correlation": 0.07182223673825046,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8339764766851547,
          "constraint_total": 0.16602352376642157,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14769010199475166,
        "min_mastery_variance": 0.13133181631565094,
        "max_mastery_variance": 0.1618768721818924,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.059089601948046265,
        "gain_correlation": 0.05617559036808062,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8157684293755386,
          "constraint_total": 0.1842315728834536,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14043737712456156,
        "min_mastery_variance": 0.12040524184703827,
        "max_mastery_variance": 0.154835507273674,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.05924922413933355,
        "gain_correlation": 0.06268326278512198,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8009592771525752,
          "constraint_total": 0.199040721417021,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.13121011023231122,
        "min_mastery_variance": 0.11115854233503342,
        "max_mastery_variance": 0.14902764558792114,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.060583158754391776,
        "gain_correlation": 0.052050972411353695,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7877276613688481,
          "constraint_total": 0.21227233810560844,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1208496323444065,
        "min_mastery_variance": 0.09848946332931519,
        "max_mastery_variance": 0.14030757546424866,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.05965416999708885,
        "gain_correlation": 0.06009558060220314,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7719029838935066,
          "constraint_total": 0.22809701868340723,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11667593344660003,
        "min_mastery_variance": 0.09427763521671295,
        "max_mastery_variance": 0.1375676691532135,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.059704084296839176,
        "gain_correlation": 0.06509648090130016,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7687330855293273,
          "constraint_total": 0.23126691316005113,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11583960214581514,
        "min_mastery_variance": 0.09373261779546738,
        "max_mastery_variance": 0.13537494838237762,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.059953838497849125,
        "gain_correlation": 0.06341054411299976,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7647603823998796,
          "constraint_total": 0.23523961610860383,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11535088254688936,
        "min_mastery_variance": 0.09324125945568085,
        "max_mastery_variance": 0.13631318509578705,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.060686945911580324,
        "gain_correlation": 0.05913333493482578,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7622994123168424,
          "constraint_total": 0.23770059000398228,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11530569438952856,
        "min_mastery_variance": 0.09373129159212112,
        "max_mastery_variance": 0.13617154955863953,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.06210693308051785,
        "gain_correlation": 0.06724925155712273,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.76080200586117,
          "constraint_total": 0.2391979936231821,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1155672971294334,
        "min_mastery_variance": 0.09372925013303757,
        "max_mastery_variance": 0.13690078258514404,
        "per_lag_correlations": []
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.06210693308051785,
    "local_gain_corr": 0.06724925155712273,
    "global_mastery_corr": null,
    "global_gain_corr": null,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}