{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7258054388679775,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.10334357239326733,
    "gain_correlation": 0.03898906297532657
  },
  "train_history": {
    "train_loss": [
      0.5369570647496633,
      0.5186317952185715,
      0.5075117815961492,
      0.49573568096432663,
      0.4787732884673875,
      0.47398458212768474,
      0.46762750571873524,
      0.4384462981644072,
      0.42124832942695817,
      0.38752423636036215,
      0.35656484683560585,
      0.3256272302235964
    ],
    "train_auc": [
      0.693783427225831,
      0.7241826633713894,
      0.736453095812202,
      0.7462743321411827,
      0.7576690916642703,
      0.772823761178995,
      0.7932631230162657,
      0.8192389711575977,
      0.8475180805285535,
      0.882687315813641,
      0.9056042955264554,
      0.9216832935049022
    ],
    "val_auc": [
      0.7153981637896604,
      0.7241856464182963,
      0.7258054388679775,
      0.7245185509025203,
      0.7199809059511691,
      0.7105864843708447,
      0.6989579472062051,
      0.6808551067100395,
      0.6661326653637893,
      0.6636982142853537,
      0.6569043699195657,
      0.6514370400793795
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1143879987399753,
        "gain_correlation": 0.015904693827082123
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10101665040054028,
        "gain_correlation": 0.03273964821618027
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1444878573111828,
        "gain_correlation": 0.0009198293289232018
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11570483032438039,
        "gain_correlation": 0.012928234754162908
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13109179900875345,
        "gain_correlation": 0.0058363355627813664
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1431920344795707,
        "gain_correlation": 0.02373019456298533
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1397389179235744,
        "gain_correlation": 0.04447249104557973
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14087043019878956,
        "gain_correlation": 0.047806498737612474
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11879204228143261,
        "gain_correlation": 0.017409251917925306
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11969383778833537,
        "gain_correlation": 0.042059339566942716
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12803587751675038,
        "gain_correlation": 0.05695662017815791
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1353320547992016,
        "gain_correlation": 0.0610402007932131
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.1143879987399753,
        "gain_correlation": 0.015904693827082123,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.026592152193188667,
        "alignment_corr_gain": 0.14920131862163544,
        "global_alignment_mastery_corr": 0.10400273626951578,
        "global_alignment_gain_corr": 0.026936951823481648,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.10400273626951578,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9841712026863473,
          "constraint_total": 0.015828798456375717,
          "alignment": -0.005808181684638129,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014010498775557304,
        "min_mastery_variance": 0.00989624671638012,
        "max_mastery_variance": 0.04203426465392113,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.10101665040054028,
        "gain_correlation": 0.03273964821618027,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.060677457600831985,
        "alignment_corr_gain": 0.18265098333358765,
        "global_alignment_mastery_corr": 0.09594680002321183,
        "global_alignment_gain_corr": 0.029748283656372224,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.10400273626951578,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9911353296658647,
          "constraint_total": 0.008864672060082679,
          "alignment": -0.022839230683867912,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009906458928988079,
        "min_mastery_variance": 0.009863067418336868,
        "max_mastery_variance": 0.01000676117837429,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.1444878573111828,
        "gain_correlation": 0.0009198293289232018,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.06485647708177567,
        "alignment_corr_gain": 0.20041900873184204,
        "global_alignment_mastery_corr": 0.11971741392835004,
        "global_alignment_gain_corr": 0.03751388903532643,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.11971741392835004,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9972569298003287,
          "constraint_total": 0.002743074716049708,
          "alignment": -0.04439164379572241,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009904522439127142,
        "min_mastery_variance": 0.009870529174804688,
        "max_mastery_variance": 0.01003859844058752,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.11570483032438039,
        "gain_correlation": 0.012928234754162908,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.07168475538492203,
        "alignment_corr_gain": 0.23284980654716492,
        "global_alignment_mastery_corr": 0.1208634857872433,
        "global_alignment_gain_corr": 0.03925030529227418,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.1208634857872433,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0073217594875365,
          "constraint_total": -0.007321758961899089,
          "alignment": -0.07092120139561932,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009902202852379164,
        "min_mastery_variance": 0.009832131676375866,
        "max_mastery_variance": 0.009949305094778538,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.13109179900875345,
        "gain_correlation": 0.0058363355627813664,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.07930459827184677,
        "alignment_corr_gain": 0.2703063488006592,
        "global_alignment_mastery_corr": 0.11704997104141512,
        "global_alignment_gain_corr": 0.030927514275366167,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.1208634857872433,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.025956498800197,
          "constraint_total": -0.025956499626666452,
          "alignment": -0.10767812989407946,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009904457656714891,
        "min_mastery_variance": 0.009891113266348839,
        "max_mastery_variance": 0.009934529662132263,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.1431920344795707,
        "gain_correlation": 0.02373019456298533,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.08137238770723343,
        "alignment_corr_gain": 0.3340248167514801,
        "global_alignment_mastery_corr": 0.11481578396429541,
        "global_alignment_gain_corr": 0.02877815360625391,
        "effective_alignment_weight": 0.13124999999999998,
        "peak_mastery_corr": 0.1208634857872433,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0116466170425253,
          "constraint_total": -0.011646610425055687,
          "alignment": -0.11008920785892548,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00990094019129023,
        "min_mastery_variance": 0.009893978014588356,
        "max_mastery_variance": 0.009911617264151573,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.1397389179235744,
        "gain_correlation": 0.04447249104557973,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.07876396179199219,
        "alignment_corr_gain": 0.3945426642894745,
        "global_alignment_mastery_corr": 0.12151887256295595,
        "global_alignment_gain_corr": 0.028170388289921296,
        "effective_alignment_weight": 0.10718749999999999,
        "peak_mastery_corr": 0.12151887256295595,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9883775454556599,
          "constraint_total": 0.011622457186035407,
          "alignment": -0.10441570364561105,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900775738060474,
        "min_mastery_variance": 0.009898791089653969,
        "max_mastery_variance": 0.009921870194375515,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.14087043019878956,
        "gain_correlation": 0.047806498737612474,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08151992410421371,
        "alignment_corr_gain": 0.42050427198410034,
        "global_alignment_mastery_corr": 0.12302163751019937,
        "global_alignment_gain_corr": 0.020819000544900823,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.12302163751019937,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9985169293529268,
          "constraint_total": 0.0014830707351205863,
          "alignment": -0.14003465500206436,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009901116467008628,
        "min_mastery_variance": 0.00989776011556387,
        "max_mastery_variance": 0.009910893626511097,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.11879204228143261,
        "gain_correlation": 0.017409251917925306,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.07877067476511002,
        "alignment_corr_gain": 0.49827030301094055,
        "global_alignment_mastery_corr": 0.12342537913267733,
        "global_alignment_gain_corr": 0.021995165470637706,
        "effective_alignment_weight": 0.08574999999999998,
        "peak_mastery_corr": 0.12342537913267733,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9664810652723802,
          "constraint_total": 0.03351893335298959,
          "alignment": -0.11402848606025617,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899939960496104,
        "min_mastery_variance": 0.009897992014884949,
        "max_mastery_variance": 0.009902913123369217,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.11969383778833537,
        "gain_correlation": 0.042059339566942716,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08621176332235336,
        "alignment_corr_gain": 0.5165041089057922,
        "global_alignment_mastery_corr": 0.12391846815706231,
        "global_alignment_gain_corr": 0.024475403340523675,
        "effective_alignment_weight": 0.06002499999999998,
        "peak_mastery_corr": 0.12391846815706231,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9357230227667039,
          "constraint_total": 0.06427697798042437,
          "alignment": -0.09621998878854851,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899521709801002,
        "min_mastery_variance": 0.009894635528326035,
        "max_mastery_variance": 0.00990284513682127,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.12803587751675038,
        "gain_correlation": 0.05695662017815791,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08458951860666275,
        "alignment_corr_gain": 0.5339819192886353,
        "global_alignment_mastery_corr": 0.124414924539354,
        "global_alignment_gain_corr": 0.032882595540334784,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.124414924539354,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9186153417641518,
          "constraint_total": 0.0813846609695785,
          "alignment": -0.09119243784676867,
          "lag": -0.0018051987737435114,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00990033184945429,
        "min_mastery_variance": 0.009895673021674156,
        "max_mastery_variance": 0.009904672391712666,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": 0.02915355935692787,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03295798972249031,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04533371329307556,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.020671676844358444,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0003861167060676962,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.040000490844249725,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12007688730955124,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12792621552944183,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.053804658353328705,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.018554961308836937,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.023260340094566345,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04946088418364525,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.000977660994976759,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11640672385692596,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.013036581687629223,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.045509111136198044,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08338622003793716,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08235261589288712,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05355276167392731,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09870540350675583,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06843280047178268,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07577916234731674,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04408801719546318,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.001861581695266068,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.00425571296364069,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03074643760919571,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.023285627365112305,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.046262435615062714,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06906858086585999,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04173716902732849,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.035618849098682404,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08661923557519913,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04083050787448883,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.02632603794336319,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.16901735961437225,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.013812530785799026,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02189069613814354,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08141225576400757,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0511925034224987,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.019953954964876175,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06864181160926819,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03369370847940445,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08388020843267441,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.16274413466453552,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03897590562701225,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06719577312469482,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15007470548152924,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.052386123687028885,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.038508813828229904,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11276406794786453,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09192603081464767,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0034367970656603575,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0833747386932373,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18433146178722382,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.055476635694503784,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.005706350319087505,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17373554408550262,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01835237629711628,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04539503529667854,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0698338970541954,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.044330086559057236,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.021672848612070084,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.052972462028265,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.062229007482528687,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05541862174868584,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09334994852542877,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03464164584875107,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0847078412771225,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.10623891651630402,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03205806389451027,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09726335108280182,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01439896784722805,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08015593886375427,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.005565944127738476,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15215899050235748,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18369197845458984,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.080795519053936,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.025313764810562134,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06390887498855591,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02830948866903782,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.008158701471984386,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05329345911741257,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12249594181776047,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03860655054450035,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06573445349931717,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0367448627948761,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09165829420089722,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0781191810965538,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02247331291437149,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10376591980457306,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2141564041376114,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12058648467063904,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.01154913380742073,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11056866496801376,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02573316916823387,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.023381730541586876,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0424417108297348,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.17286857962608337,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008602171204984188,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.02768293209373951,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06841789931058884,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13463608920574188,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.15088243782520294,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.011092355474829674,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.01947002299129963,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1432204246520996,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09647360444068909,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04488229379057884,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09063294529914856,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.009475943632423878,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.038531895726919174,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.027456654235720634,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.033256836235523224,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.060301605612039566,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.061207760125398636,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11991773545742035,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.058610111474990845,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08840635418891907,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.029532086104154587,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06201224401593208,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.003446776419878006,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01760668307542801,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1442990005016327,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12902015447616577,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.026220619678497314,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.023579521104693413,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.005295070819556713,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04551081731915474,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07958930730819702,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.026271147653460503,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1773548722267151,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16960644721984863,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008220101706683636,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05299368128180504,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08947169035673141,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06786228716373444,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.038449399173259735,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0690450668334961,
            "weight": 0.3
          }
        ]
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.1353320547992016,
        "gain_correlation": 0.0610402007932131,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0837358608841896,
        "alignment_corr_gain": 0.5594479441642761,
        "global_alignment_mastery_corr": 0.12581164486924534,
        "global_alignment_gain_corr": 0.032310026053455655,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.12581164486924534,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9199034915478546,
          "constraint_total": 0.08009650575506744,
          "alignment": -0.10257239925304128,
          "lag": -0.008303950100175945,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00990012972832807,
        "min_mastery_variance": 0.009897449053823948,
        "max_mastery_variance": 0.00990418903529644,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": 0.23808853328227997,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16220544278621674,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23580487072467804,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.210230752825737,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0349612832069397,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.022216206416487694,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.36685729026794434,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.3378552794456482,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.007544192019850016,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.075221486389637,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08350469917058945,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09672021865844727,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23383189737796783,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.24600262939929962,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09425623714923859,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1683872640132904,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.27408474683761597,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1999683976173401,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03942462429404259,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04853072762489319,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.28646180033683777,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.22020666301250458,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008714526891708374,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02007290907204151,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.036205872893333435,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.009351438842713833,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17679506540298462,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.22498731315135956,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.019523533061146736,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04311142489314079,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13820382952690125,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.14769208431243896,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14380832016468048,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0405229777097702,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1603824943304062,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01641421765089035,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.005906773265451193,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08597488701343536,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2133685052394867,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13055843114852905,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19345635175704956,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.14848700165748596,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05234105885028839,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.19891035556793213,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.002932024421170354,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04917145520448685,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2589156925678253,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1590552181005478,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.011155642569065094,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.02289232797920704,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21039153635501862,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1025724709033966,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2514266073703766,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2708083987236023,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.015165050514042377,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.056192800402641296,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.33220914006233215,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10793469846248627,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1616404503583908,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.19232845306396484,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24162133038043976,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.19680234789848328,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14867061376571655,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.00441103707998991,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06349494308233261,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11131002008914948,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1431674063205719,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17507648468017578,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03877629339694977,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.016359752044081688,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19561529159545898,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08247840404510498,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.11158622801303864,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.013025423511862755,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19343958795070648,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.23759889602661133,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24681580066680908,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15301211178302765,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.254111111164093,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15027281641960144,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19992463290691376,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1092260554432869,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21349216997623444,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.059403497725725174,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10862231254577637,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.056194525212049484,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0763644352555275,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15306724607944489,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13744604587554932,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0022713979706168175,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.36367207765579224,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2810068130493164,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.014127246104180813,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1551356017589569,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06699817627668381,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.040180787444114685,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.035088129341602325,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.13510005176067352,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02130470983684063,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03843839839100838,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14313320815563202,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2231820672750473,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.11879400163888931,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.000994026893749833,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0007202986162155867,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.13030454516410828,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21720850467681885,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02088373899459839,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.29352006316185,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17703959345817566,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10567183792591095,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12430518865585327,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2421705573797226,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09646821022033691,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10307414829730988,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1687646061182022,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07370048761367798,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20408861339092255,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23535339534282684,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20508070290088654,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12942147254943848,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.054056886583566666,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.45310133695602417,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.3569104075431824,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.01691587083041668,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.021923432126641273,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06148279830813408,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.021900879219174385,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14961065351963043,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07040421664714813,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3503483235836029,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.3271905779838562,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17777897417545319,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09938500821590424,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24688556790351868,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.19924503564834595,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1257610023021698,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03087855502963066,
            "weight": 0.3
          }
        ]
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "intrinsic_gain_attention": false,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-09T10:27:22.511518",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.1353320547992016,
    "local_gain_corr": 0.0610402007932131,
    "global_mastery_corr": 0.12581164486924534,
    "global_gain_corr": 0.032310026053455655,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}