{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7204651073686063,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.020004121493875655,
    "gain_correlation": -0.026749038656598896
  },
  "train_history": {
    "train_loss": [
      0.6205791034229061,
      0.6051429831302227,
      0.6114923308550385,
      0.6125561573344809,
      0.6118969599200036,
      0.6042140923015812,
      0.6005895329262926,
      0.5992532242765081,
      0.5670549236431023,
      0.5496289873679068,
      0.5422132029125728,
      0.5276454423066865
    ],
    "train_auc": [
      0.6803364318328892,
      0.7188714554083105,
      0.7329269552060447,
      0.7460447170330043,
      0.76087315248247,
      0.7762707276199812,
      0.7912352204355984,
      0.8036080196018254,
      0.8284490754624422,
      0.8420208169200633,
      0.8473865588901579,
      0.8578532658431037
    ],
    "val_auc": [
      0.7122066888865057,
      0.7204651073686063,
      0.7204575827925898,
      0.7160106945727501,
      0.708698299777345,
      0.700846972187704,
      0.6935787305206276,
      0.6866128588299737,
      0.6714513278083586,
      0.6640288338107658,
      0.6620610768874675,
      0.6494911694506884
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06462951909959651,
        "gain_correlation": 0.06792524106971261
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05989748303390911,
        "gain_correlation": 0.04733820005944715
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05697266802259331,
        "gain_correlation": -0.004603887091611222
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.058376440540933335,
        "gain_correlation": -0.0043175967623279
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05725909740648697,
        "gain_correlation": -0.010156609443887027
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05671898852542821,
        "gain_correlation": -0.024343832279849955
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05502745622230648,
        "gain_correlation": -0.004758191485984102
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05684966756188765,
        "gain_correlation": 0.0018372842098933876
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0588697630974799,
        "gain_correlation": 0.010992338670409734
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05823066614589014,
        "gain_correlation": 0.0030476560350923016
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05866221715404287,
        "gain_correlation": 0.006387801290758145
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05830025277620444,
        "gain_correlation": 0.0031063292312974375
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.06462951909959651,
        "gain_correlation": 0.06792524106971261,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8625423263808488,
          "constraint_total": 0.1374576743345258,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.17648973447891572,
        "min_mastery_variance": 0.1413864642381668,
        "max_mastery_variance": 0.217719167470932,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.05989748303390911,
        "gain_correlation": 0.04733820005944715,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8549574725386622,
          "constraint_total": 0.1450425263130592,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.17461988932110484,
        "min_mastery_variance": 0.15055124461650848,
        "max_mastery_variance": 0.18889614939689636,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.05697266802259331,
        "gain_correlation": -0.004603887091611222,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8315079088607428,
          "constraint_total": 0.16849209189682768,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.17010407813781284,
        "min_mastery_variance": 0.1580129861831665,
        "max_mastery_variance": 0.18421748280525208,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.058376440540933335,
        "gain_correlation": -0.0043175967623279,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8154018952483403,
          "constraint_total": 0.1845981044995747,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16349567750883845,
        "min_mastery_variance": 0.15135754644870758,
        "max_mastery_variance": 0.17490236461162567,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.05725909740648697,
        "gain_correlation": -0.010156609443887027,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7985591332873578,
          "constraint_total": 0.20144086658646398,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15783604493104114,
        "min_mastery_variance": 0.14346347749233246,
        "max_mastery_variance": 0.17008207738399506,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.05671898852542821,
        "gain_correlation": -0.024343832279849955,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7885082467522482,
          "constraint_total": 0.2114917536949911,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14938473176462044,
        "min_mastery_variance": 0.1347963958978653,
        "max_mastery_variance": 0.16240794956684113,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.05502745622230648,
        "gain_correlation": -0.004758191485984102,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7722855651315287,
          "constraint_total": 0.22771443403287145,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1376773340559994,
        "min_mastery_variance": 0.11911982297897339,
        "max_mastery_variance": 0.15449486672878265,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.05684966756188765,
        "gain_correlation": 0.0018372842098933876,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7557695421836731,
          "constraint_total": 0.24423045156756226,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.13298580278232308,
        "min_mastery_variance": 0.11402931809425354,
        "max_mastery_variance": 0.15054237842559814,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.0588697630974799,
        "gain_correlation": 0.010992338670409734,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7541478612445967,
          "constraint_total": 0.24585214032120065,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12858643938685946,
        "min_mastery_variance": 0.11069367825984955,
        "max_mastery_variance": 0.14587797224521637,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.05823066614589014,
        "gain_correlation": 0.0030476560350923016,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7499671094170676,
          "constraint_total": 0.25003288742228746,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1283603553404462,
        "min_mastery_variance": 0.110933318734169,
        "max_mastery_variance": 0.14457069337368011,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.05866221715404287,
        "gain_correlation": 0.006387801290758145,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7493286950736379,
          "constraint_total": 0.2506713066350941,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12822838498211894,
        "min_mastery_variance": 0.11108911037445068,
        "max_mastery_variance": 0.14533507823944092,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.05830025277620444,
        "gain_correlation": 0.0031063292312974375,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7445823653367554,
          "constraint_total": 0.2554176326878477,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12783332806022674,
        "min_mastery_variance": 0.11069804430007935,
        "max_mastery_variance": 0.14496584236621857,
        "per_lag_correlations": []
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": false,
    "use_gain_head": false,
    "intrinsic_gain_attention": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-09T11:33:59.219437",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.05830025277620444,
    "local_gain_corr": 0.0031063292312974375,
    "global_mastery_corr": null,
    "global_gain_corr": null,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}