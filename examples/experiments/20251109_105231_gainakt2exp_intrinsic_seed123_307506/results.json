{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7205907180347476,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.022889473057176764,
    "gain_correlation": -0.024079093025952136
  },
  "train_history": {
    "train_loss": [
      0.6137992285693865,
      0.6070584605394868,
      0.6069345881901874,
      0.610957441243483,
      0.6120088168376469,
      0.6121304554025127,
      0.6121074134204054,
      0.6103175257771744,
      0.5941536568607073,
      0.5621805716055045,
      0.5463049927523717,
      0.5307439216678007
    ],
    "train_auc": [
      0.6787290936683725,
      0.7166250481643476,
      0.7319442138300343,
      0.7456653029002552,
      0.7616528804137203,
      0.7768441770051826,
      0.7906840647526423,
      0.805607627286659,
      0.8172436856464136,
      0.8377015658891888,
      0.8494823095199555,
      0.8608939718272638
    ],
    "val_auc": [
      0.7107005739382056,
      0.719567685300172,
      0.7205907180347476,
      0.7158669369937718,
      0.7084408060767204,
      0.7003481383639825,
      0.693154699849441,
      0.6810327332554156,
      0.680174982820691,
      0.6672213397409322,
      0.6640166905490059,
      0.6607831676746816
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0748978792355901,
        "gain_correlation": 0.012620780905119054
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0647631149133125,
        "gain_correlation": 0.058082263484445715
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06268573650576323,
        "gain_correlation": 0.055637938630248344
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06055878908519345,
        "gain_correlation": 0.050967610921483705
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06120038602884073,
        "gain_correlation": 0.04207021734724331
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.061233215335157395,
        "gain_correlation": 0.05175549105105401
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06104288383859402,
        "gain_correlation": 0.05271925249982959
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06324713545598715,
        "gain_correlation": 0.05627140399568527
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06420968798051671,
        "gain_correlation": 0.054161088340897875
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0651425877383699,
        "gain_correlation": 0.05592549326998789
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06493033512712307,
        "gain_correlation": 0.051825446769622904
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06559649569040212,
        "gain_correlation": 0.05475683360049117
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.0748978792355901,
        "gain_correlation": 0.012620780905119054,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8730640093870826,
          "constraint_total": 0.126935986744961,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.17572253554438552,
        "min_mastery_variance": 0.14250630140304565,
        "max_mastery_variance": 0.21796639263629913,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.0647631149133125,
        "gain_correlation": 0.058082263484445715,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8543449614389398,
          "constraint_total": 0.14565503932416382,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.17197869818445313,
        "min_mastery_variance": 0.1518794149160385,
        "max_mastery_variance": 0.18387471139431,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.06268573650576323,
        "gain_correlation": 0.055637938630248344,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8386225594747352,
          "constraint_total": 0.16137744046165983,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16899740209542408,
        "min_mastery_variance": 0.15724244713783264,
        "max_mastery_variance": 0.18153724074363708,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.06055878908519345,
        "gain_correlation": 0.050967610921483705,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.818051983914565,
          "constraint_total": 0.1819480115992189,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16417985892048773,
        "min_mastery_variance": 0.15158849954605103,
        "max_mastery_variance": 0.1753893941640854,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.06120038602884073,
        "gain_correlation": 0.04207021734724331,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7977447177491916,
          "constraint_total": 0.2022552790338509,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15963478494493455,
        "min_mastery_variance": 0.1488196849822998,
        "max_mastery_variance": 0.1691470593214035,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.061233215335157395,
        "gain_correlation": 0.05175549105105401,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7780811361373565,
          "constraint_total": 0.22191886197069152,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15671459519801362,
        "min_mastery_variance": 0.14581768214702606,
        "max_mastery_variance": 0.1656666100025177,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.06104288383859402,
        "gain_correlation": 0.05271925249982959,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7588020141417876,
          "constraint_total": 0.2411979837769871,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15266019600043024,
        "min_mastery_variance": 0.14114293456077576,
        "max_mastery_variance": 0.16293074190616608,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.06324713545598715,
        "gain_correlation": 0.05627140399568527,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7386780675439717,
          "constraint_total": 0.26132193119098046,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1491849061893058,
        "min_mastery_variance": 0.13699689507484436,
        "max_mastery_variance": 0.15916213393211365,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.06420968798051671,
        "gain_correlation": 0.054161088340897875,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7400125340411443,
          "constraint_total": 0.2599874647893387,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14878448898001656,
        "min_mastery_variance": 0.1363937258720398,
        "max_mastery_variance": 0.15926912426948547,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.0651425877383699,
        "gain_correlation": 0.05592549326998789,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7426469339197356,
          "constraint_total": 0.2573530673162957,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14475482640488777,
        "min_mastery_variance": 0.13279421627521515,
        "max_mastery_variance": 0.15616635978221893,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.06493033512712307,
        "gain_correlation": 0.051825446769622904,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7380992676203425,
          "constraint_total": 0.2619007302597404,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1451909919631296,
        "min_mastery_variance": 0.13334986567497253,
        "max_mastery_variance": 0.15631195902824402,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.06559649569040212,
        "gain_correlation": 0.05475683360049117,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7334235819797051,
          "constraint_total": 0.2665764193295378,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1453714208590552,
        "min_mastery_variance": 0.13365720212459564,
        "max_mastery_variance": 0.15619812905788422,
        "per_lag_correlations": []
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.06559649569040212,
    "local_gain_corr": 0.05475683360049117,
    "global_mastery_corr": null,
    "global_gain_corr": null,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}