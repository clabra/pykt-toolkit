{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7209573003537496,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.022706058295528932,
    "gain_correlation": -0.0044447253734349965
  },
  "train_history": {
    "train_loss": [
      0.605089585089313,
      0.5954797604541087,
      0.5984564889897954,
      0.6016503553934048,
      0.603101904836961,
      0.6031646571011123,
      0.6040795074843373,
      0.6027676497098695,
      0.5877544972563037,
      0.5620835245890938,
      0.5456153361290847,
      0.5334084835386029
    ],
    "train_auc": [
      0.6790039968877148,
      0.7170001807426208,
      0.7324729851585726,
      0.7466569732823954,
      0.7620906024811988,
      0.7777486909617388,
      0.791459310192941,
      0.8056562030197902,
      0.8172554862220665,
      0.8394767385678167,
      0.8523759299476141,
      0.8614579229733555
    ],
    "val_auc": [
      0.7104140262609231,
      0.7196355577147516,
      0.7209573003537496,
      0.716708116612613,
      0.7090118112986482,
      0.7018949872535653,
      0.6939633149259299,
      0.6834386906979606,
      0.675045022949612,
      0.6680390675592691,
      0.6536276616438902,
      0.6494403385382366
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0625160063558629,
        "gain_correlation": -0.005964688209912184
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0605139750350547,
        "gain_correlation": 0.022961416618810952
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06047247823660051,
        "gain_correlation": 0.030170067957791546
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.060551736530767626,
        "gain_correlation": 0.005613536112903377
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0629055595492641,
        "gain_correlation": 0.0003480153301242599
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06245272819834907,
        "gain_correlation": 0.001398706458678191
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06057273394297212,
        "gain_correlation": 0.003783321790477391
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06006114503108788,
        "gain_correlation": -0.0029310999017554467
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.062129017551531766,
        "gain_correlation": -0.0005123604628587231
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06299067288237019,
        "gain_correlation": -0.0017648321302638594
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06195484036545454,
        "gain_correlation": -0.005589291825016071
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06155331107999422,
        "gain_correlation": -0.003875083351290616
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.0625160063558629,
        "gain_correlation": -0.005964688209912184,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8857083072040508,
          "constraint_total": 0.11429169171136794,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16770549956709146,
        "min_mastery_variance": 0.13303424417972565,
        "max_mastery_variance": 0.21742825210094452,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.0605139750350547,
        "gain_correlation": 0.022961416618810952,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8705029566542842,
          "constraint_total": 0.12949704652231112,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16302488026223652,
        "min_mastery_variance": 0.14468826353549957,
        "max_mastery_variance": 0.17711575329303741,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.06047247823660051,
        "gain_correlation": 0.030170067957791546,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8500127732234924,
          "constraint_total": 0.14998722974378437,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15558277101405543,
        "min_mastery_variance": 0.13883526623249054,
        "max_mastery_variance": 0.1715768575668335,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.060551736530767626,
        "gain_correlation": 0.005613536112903377,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8294228737235139,
          "constraint_total": 0.1705771260198317,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14432494635717857,
        "min_mastery_variance": 0.12763415277004242,
        "max_mastery_variance": 0.16083863377571106,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.0629055595492641,
        "gain_correlation": 0.0003480153301242599,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.808909629311199,
          "constraint_total": 0.19109036844848054,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.13698450993225364,
        "min_mastery_variance": 0.1191345751285553,
        "max_mastery_variance": 0.1541225165128708,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.06245272819834907,
        "gain_correlation": 0.001398706458678191,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7884074985631401,
          "constraint_total": 0.21159250329293233,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1323495057117136,
        "min_mastery_variance": 0.11314146965742111,
        "max_mastery_variance": 0.150152325630188,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.06057273394297212,
        "gain_correlation": 0.003783321790477391,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7680390688014046,
          "constraint_total": 0.23196093484121277,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12878038996705118,
        "min_mastery_variance": 0.10999026894569397,
        "max_mastery_variance": 0.14681826531887054,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.06006114503108788,
        "gain_correlation": -0.0029310999017554467,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7477399549075436,
          "constraint_total": 0.2522600443879651,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12558643940662473,
        "min_mastery_variance": 0.10735657811164856,
        "max_mastery_variance": 0.14544132351875305,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.062129017551531766,
        "gain_correlation": -0.0005123604628587231,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7483434230425992,
          "constraint_total": 0.25165657840237327,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12266588527612736,
        "min_mastery_variance": 0.1023511067032814,
        "max_mastery_variance": 0.14079567790031433,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.06299067288237019,
        "gain_correlation": -0.0017648321302638594,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7403938126360552,
          "constraint_total": 0.25960618963039356,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12261819526784778,
        "min_mastery_variance": 0.10239512473344803,
        "max_mastery_variance": 0.14064231514930725,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.06195484036545454,
        "gain_correlation": -0.005589291825016071,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7348664049636954,
          "constraint_total": 0.26513359439952566,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12316315775553797,
        "min_mastery_variance": 0.10370135307312012,
        "max_mastery_variance": 0.14114129543304443,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.06155331107999422,
        "gain_correlation": -0.003875083351290616,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7309292512693089,
          "constraint_total": 0.26907074945441495,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12323598532787876,
        "min_mastery_variance": 0.10369125753641129,
        "max_mastery_variance": 0.14130085706710815,
        "per_lag_correlations": []
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.06155331107999422,
    "local_gain_corr": -0.003875083351290616,
    "global_mastery_corr": null,
    "global_gain_corr": null,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}