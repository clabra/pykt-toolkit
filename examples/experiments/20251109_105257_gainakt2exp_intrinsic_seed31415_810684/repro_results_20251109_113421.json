{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7207498065371161,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.019242547262820608,
    "gain_correlation": -0.02689894403959122
  },
  "train_history": {
    "train_loss": [
      0.6086801089771053,
      0.6040337947366151,
      0.6081985139476203,
      0.6012002634260939,
      0.5954507129179999,
      0.5913774235260919,
      0.5852993368484813,
      0.5791575144300807,
      0.5648570662953075,
      0.5394612180136646,
      0.5263622332113395,
      0.5164027683475475
    ],
    "train_auc": [
      0.6783887236690698,
      0.7173953997140092,
      0.7327000742707055,
      0.7465867903364596,
      0.7623122522371539,
      0.7791597337349085,
      0.7952745719523809,
      0.8113850524015004,
      0.8214611723237762,
      0.842735750184144,
      0.8528310720092647,
      0.8599310525374659
    ],
    "val_auc": [
      0.7111693828563439,
      0.7205537545094932,
      0.7207498065371161,
      0.7161165410963943,
      0.707895446235461,
      0.700547191601385,
      0.6908409762213004,
      0.6830609744694904,
      0.6743773391179022,
      0.6684033301906467,
      0.6563223733979741,
      0.6625917299387452
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0699696195014901,
        "gain_correlation": 0.07704653792292192
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06628348194726541,
        "gain_correlation": 0.06724972482513362
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.06304542594858804,
        "gain_correlation": 0.056045323952790604
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.057816497392456145,
        "gain_correlation": 0.04611403162143601
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05730575523087511,
        "gain_correlation": 0.0411447001441705
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.056542716500599985,
        "gain_correlation": 0.04487089889477649
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05581428075311886,
        "gain_correlation": 0.043893756538689085
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05449014391477087,
        "gain_correlation": 0.04903878299994367
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05500736744597148,
        "gain_correlation": 0.050168909452721254
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.056593855035726594,
        "gain_correlation": 0.0572478149362421
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05595023406956915,
        "gain_correlation": 0.05340988046429848
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.05753167404724535,
        "gain_correlation": 0.05656713016318808
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.0699696195014901,
        "gain_correlation": 0.07704653792292192,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8808012759180124,
          "constraint_total": 0.11919872110112766,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.1713319825163732,
        "min_mastery_variance": 0.13073444366455078,
        "max_mastery_variance": 0.2172609120607376,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.06628348194726541,
        "gain_correlation": 0.06724972482513362,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.857766571203558,
          "constraint_total": 0.14223342847688983,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.16593411140182476,
        "min_mastery_variance": 0.15003064274787903,
        "max_mastery_variance": 0.1782708615064621,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.06304542594858804,
        "gain_correlation": 0.056045323952790604,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.836016692258016,
          "constraint_total": 0.16398330729767469,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.15858370791445126,
        "min_mastery_variance": 0.14433375000953674,
        "max_mastery_variance": 0.17104525864124298,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.057816497392456145,
        "gain_correlation": 0.04611403162143601,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8299407990566977,
          "constraint_total": 0.1700592011359371,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.14377659590133113,
        "min_mastery_variance": 0.12656418979167938,
        "max_mastery_variance": 0.15765905380249023,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.05730575523087511,
        "gain_correlation": 0.0411447001441705,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8188271563290748,
          "constraint_total": 0.18117284483789467,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.13624224074455124,
        "min_mastery_variance": 0.11562240123748779,
        "max_mastery_variance": 0.15267792344093323,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.056542716500599985,
        "gain_correlation": 0.04487089889477649,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8019276694351718,
          "constraint_total": 0.19807232821481363,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.13031608067028264,
        "min_mastery_variance": 0.1110479012131691,
        "max_mastery_variance": 0.14630688726902008,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.05581428075311886,
        "gain_correlation": 0.043893756538689085,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7865457750175125,
          "constraint_total": 0.21345422715903778,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.12235399161904587,
        "min_mastery_variance": 0.10105232894420624,
        "max_mastery_variance": 0.13975226879119873,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.05449014391477087,
        "gain_correlation": 0.04903878299994367,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7687917148049823,
          "constraint_total": 0.23120828686140563,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11792810562361089,
        "min_mastery_variance": 0.09651399403810501,
        "max_mastery_variance": 0.13776040077209473,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.05500736744597148,
        "gain_correlation": 0.050168909452721254,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7705598438490533,
          "constraint_total": 0.22944015389562675,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11632231758048497,
        "min_mastery_variance": 0.0954705998301506,
        "max_mastery_variance": 0.13648805022239685,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.056593855035726594,
        "gain_correlation": 0.0572478149362421,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.763681113687563,
          "constraint_total": 0.23631888717116137,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11562373713044923,
        "min_mastery_variance": 0.09262607246637344,
        "max_mastery_variance": 0.1359778642654419,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.05595023406956915,
        "gain_correlation": 0.05340988046429848,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.759850132653073,
          "constraint_total": 0.24014986976718705,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11611095213673893,
        "min_mastery_variance": 0.09344176203012466,
        "max_mastery_variance": 0.13617254793643951,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.05753167404724535,
        "gain_correlation": 0.05656713016318808,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0,
        "alignment_corr_gain": 0.0,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": null,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7571017617109773,
          "constraint_total": 0.24289823701817587,
          "alignment": 0.0,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.11605910748397748,
        "min_mastery_variance": 0.09282101690769196,
        "max_mastery_variance": 0.13609451055526733,
        "per_lag_correlations": []
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": false,
    "use_gain_head": false,
    "intrinsic_gain_attention": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-09T11:34:21.731349",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.05753167404724535,
    "local_gain_corr": 0.05656713016318808,
    "global_mastery_corr": null,
    "global_gain_corr": null,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}