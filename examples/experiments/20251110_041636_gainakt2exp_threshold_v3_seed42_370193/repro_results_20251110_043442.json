{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7251750165889191,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": -0.008164812986833114,
    "gain_correlation": 0.042696748489260444
  },
  "train_history": {
    "train_loss": [
      0.9821516704682859,
      0.9619370726723745,
      0.9800391299119268,
      0.9991785840666974,
      1.0120498581253803,
      1.0158569599680332,
      1.0099697174803581,
      1.0165281230921572,
      0.9992178224529009,
      0.9390373832203563,
      0.9202938947652906,
      0.8854005599268977
    ],
    "train_auc": [
      0.6848466367913832,
      0.7220089772777414,
      0.7365049417698881,
      0.7482027356988105,
      0.7625189148729156,
      0.7820480466281693,
      0.8061586506115154,
      0.8342993344253409,
      0.8587963761018438,
      0.8916556861711489,
      0.9133441696999414,
      0.9278449009466869
    ],
    "val_auc": [
      0.7154186451683396,
      0.7240143373148267,
      0.7251750165889191,
      0.7215438534925689,
      0.7135812262168288,
      0.701748288070287,
      0.6873490054660736,
      0.6723847198131879,
      0.654908792508208,
      0.6559268545891472,
      0.6462751200950657,
      0.6424158480605295
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.019217238163876216,
        "gain_correlation": 0.11429820055641086
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.029630851416967356,
        "gain_correlation": 0.06127202004902233
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.03241166688890829,
        "gain_correlation": 0.04504218857296196
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.02749696131280696,
        "gain_correlation": 0.033022559866830996
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.026057628905089333,
        "gain_correlation": 0.039665730678637164
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.02330689451322705,
        "gain_correlation": 0.02967703637414246
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.020615920467882687,
        "gain_correlation": 0.023262650671171246
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.019483122724508008,
        "gain_correlation": 0.0355498471116633
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.018004605404656884,
        "gain_correlation": 0.02472211496384502
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.020273179104058157,
        "gain_correlation": 0.01681812648193634
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0196817493672155,
        "gain_correlation": 0.015864168827236142
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.01975252729943438,
        "gain_correlation": 0.006109923403479716
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.019217238163876216,
        "gain_correlation": 0.11429820055641086,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": -0.0008012339239940047,
        "alignment_corr_gain": -0.004435746464878321,
        "global_alignment_mastery_corr": -0.0004043042105816615,
        "global_alignment_gain_corr": -0.023098332284716888,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.5425418122318951,
          "constraint_total": 0.45745818585333725,
          "alignment": -0.00023481034656998716,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.005596245514122226,
        "min_mastery_variance": 0.002045887056738138,
        "max_mastery_variance": 0.012832505628466606,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.029630851416967356,
        "gain_correlation": 0.06127202004902233,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0002635446726344526,
        "alignment_corr_gain": 0.14791829884052277,
        "global_alignment_mastery_corr": 0.005338663146928108,
        "global_alignment_gain_corr": 0.01945537361568616,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.005338663146928108,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.5359383200981552,
          "constraint_total": 0.4640616818990566,
          "alignment": -0.0047394858019670395,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009875111518321569,
        "min_mastery_variance": 0.006642570719122887,
        "max_mastery_variance": 0.012554913759231567,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.03241166688890829,
        "gain_correlation": 0.04504218857296196,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0007347980281338096,
        "alignment_corr_gain": 0.20514775812625885,
        "global_alignment_mastery_corr": 0.008556865066226844,
        "global_alignment_gain_corr": 0.04120223216712475,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.008556865066226844,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.5165301343554263,
          "constraint_total": 0.4834698659572343,
          "alignment": -0.014930700456255306,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011184186510587295,
        "min_mastery_variance": 0.008185213431715965,
        "max_mastery_variance": 0.013868695124983788,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.02749696131280696,
        "gain_correlation": 0.033022559866830996,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0009467335767112672,
        "alignment_corr_gain": 0.22540618479251862,
        "global_alignment_mastery_corr": 0.009381125839039063,
        "global_alignment_gain_corr": 0.04442848818342706,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.009381125839039063,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.49864664903231354,
          "constraint_total": 0.5013533439746102,
          "alignment": -0.02676143184939726,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011561999744084214,
        "min_mastery_variance": 0.00841673742979765,
        "max_mastery_variance": 0.014320050366222858,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.026057628905089333,
        "gain_correlation": 0.039665730678637164,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.0011294990545138717,
        "alignment_corr_gain": 0.2799428403377533,
        "global_alignment_mastery_corr": 0.009596521167307704,
        "global_alignment_gain_corr": 0.050234916861906335,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.48192238402893367,
          "constraint_total": 0.5180776133963187,
          "alignment": -0.04339132289442756,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011707615372700703,
        "min_mastery_variance": 0.008496048860251904,
        "max_mastery_variance": 0.014515643939375877,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.02330689451322705,
        "gain_correlation": 0.02967703637414246,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.0012053503887727857,
        "alignment_corr_gain": 0.337543785572052,
        "global_alignment_mastery_corr": 0.009061787028501082,
        "global_alignment_gain_corr": 0.050605066093961475,
        "effective_alignment_weight": 0.1875,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.4650175096561938,
          "constraint_total": 0.5349824913318442,
          "alignment": -0.06548815786787303,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011775285603932149,
        "min_mastery_variance": 0.008541219867765903,
        "max_mastery_variance": 0.014582451432943344,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.020615920467882687,
        "gain_correlation": 0.023262650671171246,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0011801481014117599,
        "alignment_corr_gain": 0.3897053599357605,
        "global_alignment_mastery_corr": 0.009039363436604617,
        "global_alignment_gain_corr": 0.054563192350324245,
        "effective_alignment_weight": 0.21875,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.4468175284166241,
          "constraint_total": 0.5531824719656055,
          "alignment": -0.09320694448354229,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011819260383092368,
        "min_mastery_variance": 0.00855559017509222,
        "max_mastery_variance": 0.014610979706048965,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.019483122724508008,
        "gain_correlation": 0.0355498471116633,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0013978590723127127,
        "alignment_corr_gain": 0.47121840715408325,
        "global_alignment_mastery_corr": 0.009057089930392977,
        "global_alignment_gain_corr": 0.047040697947004446,
        "effective_alignment_weight": 0.2036724453233182,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.4163008134663782,
          "constraint_total": 0.5836991909768567,
          "alignment": -0.10126659943371252,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011845624976709409,
        "min_mastery_variance": 0.008571099489927292,
        "max_mastery_variance": 0.01463475450873375,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.018004605404656884,
        "gain_correlation": 0.02472211496384502,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0014425382250919938,
        "alignment_corr_gain": 0.5170375108718872,
        "global_alignment_mastery_corr": 0.00866302701770716,
        "global_alignment_gain_corr": 0.05539765908648406,
        "effective_alignment_weight": 0.14256202605366705,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.39534695283119137,
          "constraint_total": 0.6046530483664708,
          "alignment": -0.07985413742803077,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01186090376266698,
        "min_mastery_variance": 0.008581846952438354,
        "max_mastery_variance": 0.014650637283921242,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.020273179104058157,
        "gain_correlation": 0.01681812648193634,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0014426081907004118,
        "alignment_corr_gain": 0.5596800446510315,
        "global_alignment_mastery_corr": 0.008767327376748048,
        "global_alignment_gain_corr": 0.051270963792921974,
        "effective_alignment_weight": 0.1427551169581711,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.37407000051175004,
          "constraint_total": 0.6259299963638724,
          "alignment": -0.09313254658902287,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011871000713248944,
        "min_mastery_variance": 0.008590630255639553,
        "max_mastery_variance": 0.014652612619102001,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.0196817493672155,
        "gain_correlation": 0.015864168827236142,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.001561135402880609,
        "alignment_corr_gain": 0.5708522796630859,
        "global_alignment_mastery_corr": 0.008367286861733495,
        "global_alignment_gain_corr": 0.05354935374232203,
        "effective_alignment_weight": 0.09989280673824248,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.3436643565603714,
          "constraint_total": 0.6563356418036754,
          "alignment": -0.0703961679081686,
          "lag": -0.0006280180209795453,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011868027125731342,
        "min_mastery_variance": 0.008586777374148369,
        "max_mastery_variance": 0.014657179825007915,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": -0.08100038766860962,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06362830102443695,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0005467615555971861,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07985004037618637,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02321663498878479,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09516123682260513,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05622505769133568,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0214217659085989,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0436527356505394,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09345272928476334,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05874872952699661,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1318603754043579,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1392965018749237,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20533232390880585,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.040043700486421585,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06595522165298462,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16879872977733612,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0219856109470129,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04482235014438629,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.13797976076602936,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.039009835571050644,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04622986912727356,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.01393392775207758,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1036212146282196,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.004506730940192938,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.060096338391304016,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1052769124507904,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.028550678864121437,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03175225108861923,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04633888974785805,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.018708016723394394,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06422381848096848,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0490880087018013,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.13470116257667542,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05001508444547653,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.032488707453012466,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0009049666114151478,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10529014468193054,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14086733758449554,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0405605286359787,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06055742874741554,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06512928754091263,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.025287708267569542,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09663113206624985,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0296466201543808,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.044467754662036896,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18178807199001312,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.016010913997888565,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.017276648432016373,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0533832386136055,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10648256540298462,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.021761836484074593,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14089302718639374,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10506754368543625,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.008735616691410542,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.02812078222632408,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08230438083410263,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12153495103120804,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0059449151158332825,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.061412591487169266,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.01568860374391079,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0006423977902159095,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05134327709674835,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.051662396639585495,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0015537281287834048,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11057426035404205,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03675510361790657,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.14098306000232697,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03892747312784195,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10216230154037476,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0723685696721077,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.024435171857476234,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.049061719328165054,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05677598714828491,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03763642534613609,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04775524511933327,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16869978606700897,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0051122382283210754,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.038068726658821106,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.030113453045487404,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16033723950386047,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.013814955949783325,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.013327526859939098,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12220607697963715,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.025148456916213036,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0007537038181908429,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.052966270595788956,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.048379022628068924,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03736349567770958,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0576469711959362,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16213098168373108,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.044821884483098984,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.023032519966363907,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08209294080734253,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.029543185606598854,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.061128485947847366,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0014196070842444897,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11287174373865128,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.033048633486032486,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.026994889602065086,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03282417729496956,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0041506621055305,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08828666806221008,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09903571009635925,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0273318849503994,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.2251289039850235,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0866703987121582,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.029809478670358658,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0776706412434578,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.052909672260284424,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.050929512828588486,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.005998526234179735,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09455519169569016,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0010722586885094643,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06250659376382828,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.060456421226263046,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.024973616003990173,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11310335248708725,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0536133348941803,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.026862850412726402,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06488624960184097,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0413983017206192,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.32721850275993347,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20770145952701569,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12700846791267395,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.008602209389209747,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06528455764055252,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06648459285497665,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0553705208003521,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.031020352616906166,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07356436550617218,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06518518179655075,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.10037130862474442,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1329430341720581,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07260028272867203,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.008111506700515747,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0007060022326186299,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08849969506263733,
            "weight": 0.3
          }
        ]
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.01975252729943438,
        "gain_correlation": 0.006109923403479716,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0015989103121683002,
        "alignment_corr_gain": 0.6052164435386658,
        "global_alignment_mastery_corr": 0.008393404858215945,
        "global_alignment_gain_corr": 0.04929516970097514,
        "effective_alignment_weight": 0.1000300205606967,
        "peak_mastery_corr": 0.009596521167307704,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.327057599600954,
          "constraint_total": 0.6729424012928595,
          "alignment": -0.07505627779424703,
          "lag": -0.0017855950474206731,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011869911987508208,
        "min_mastery_variance": 0.00858602486550808,
        "max_mastery_variance": 0.014652485027909279,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": -0.0750519409775734,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04951215162873268,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04396503046154976,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07224418967962265,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.062314774841070175,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07007654756307602,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2654113471508026,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16984127461910248,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06131022050976753,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0611056312918663,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04080277681350708,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11883026361465454,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.27211445569992065,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.3424971103668213,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14004671573638916,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13367588818073273,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2652145028114319,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09318093210458755,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.00830723624676466,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12929369509220123,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012104528024792671,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.038049083203077316,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012215342372655869,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.008403879590332508,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1125921756029129,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09109761565923691,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02741388976573944,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.02396259643137455,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.034086648374795914,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09843163192272186,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06725794821977615,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.058079712092876434,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0023217794951051474,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08370501548051834,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.002367007778957486,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.004017123021185398,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0052916607819497585,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08150999993085861,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24833045899868011,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17274990677833557,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17811118066310883,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10788821429014206,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02269720658659935,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09039593487977982,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02752332016825676,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05019669234752655,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17463533580303192,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04008083418011665,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.042448002845048904,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.035878829658031464,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16663795709609985,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01670265756547451,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21247433125972748,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16358478367328644,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.025030208751559258,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.030075186863541603,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1750417798757553,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04551829397678375,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02628316543996334,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09191735088825226,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.015013963915407658,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03128693252801895,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13796544075012207,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.007358044385910034,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.030272847041487694,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08812753856182098,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17000992596149445,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.25227800011634827,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03332404047250748,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08933190256357193,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18565629422664642,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1291138082742691,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03688235953450203,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05417657271027565,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18143175542354584,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17145583033561707,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26509222388267517,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12081502377986908,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.013063238933682442,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03169325366616249,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18088164925575256,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.056484028697013855,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08316265791654587,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11465143412351608,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09787172079086304,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10512194037437439,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0429692380130291,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07655129581689835,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15970540046691895,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0702660009264946,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2825945019721985,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18403369188308716,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04816482588648796,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05136056989431381,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0528467558324337,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.042959995567798615,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02133588306605816,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07099202275276184,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012275404296815395,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0685219019651413,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03853828087449074,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06046196445822716,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.10533784329891205,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11148928105831146,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.047674983739852905,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.19775298237800598,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19123657047748566,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02796521782875061,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.25771695375442505,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10809554904699326,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.020074600353837013,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05608135461807251,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13573943078517914,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.036172520369291306,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11515441536903381,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12599657475948334,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08390463143587112,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1822558045387268,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.20179860293865204,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16422022879123688,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03920404613018036,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.005201749037951231,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.40251025557518005,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2754579484462738,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23474852740764618,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08760634064674377,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0846579521894455,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0734366774559021,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.007969336584210396,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07708073407411575,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05392293259501457,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07826250791549683,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.12155435979366302,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10229703783988953,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0653388649225235,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01880698651075363,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.015017909929156303,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12473441660404205,
            "weight": 0.3
          }
        ]
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "intrinsic_gain_attention": false,
    "use_causal_mastery": true,
    "alpha_learning_rate": 1.0,
    "num_students": 12220,
    "use_learnable_alpha": true,
    "use_learnable_threshold": true,
    "threshold_temperature": 0.1,
    "threshold_loss_weight": 0.5,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-10T04:34:42.910581",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.01975252729943438,
    "local_gain_corr": 0.006109923403479716,
    "global_mastery_corr": 0.008393404858215945,
    "global_gain_corr": 0.04929516970097514,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}