{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7258355901273248,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.09005250493017355,
    "gain_correlation": 0.06407702489344747
  },
  "train_history": {
    "train_loss": [
      0.5454977435769195,
      0.5325006099871403,
      0.5276459302618096,
      0.5218359951528243,
      0.5105178998541956,
      0.5122209767294671,
      0.49088587801073497,
      0.4845837973868909,
      0.468377247529944,
      0.4342253716189627,
      0.4029262195597041,
      0.37277594872706915
    ],
    "train_auc": [
      0.6934447620044331,
      0.7243417817441636,
      0.7367028372269856,
      0.7468092498930861,
      0.7582538030752876,
      0.7742797811906365,
      0.7963247342551953,
      0.823507264559978,
      0.8514133057748846,
      0.8870995247692166,
      0.909866246395874,
      0.9253074132317994
    ],
    "val_auc": [
      0.7172561781584331,
      0.7247140975150865,
      0.7258355901273248,
      0.723845797649417,
      0.7180615947359318,
      0.7074048904305723,
      0.694915473543539,
      0.6821898728999851,
      0.6655325098604827,
      0.6649000683842334,
      0.656193640586969,
      0.6487459063781857
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12103864898437619,
        "gain_correlation": 0.03169946458629697
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.09830960591740381,
        "gain_correlation": 0.04644860001064472
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10678577341004532,
        "gain_correlation": 0.025995745557810736
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.08370348059835674,
        "gain_correlation": 0.017722759135902492
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10410209530915973,
        "gain_correlation": 0.03755746097244467
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14068005532939107,
        "gain_correlation": 0.02308682487403411
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12391619114376798,
        "gain_correlation": 0.0201915639068507
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11624923929066587,
        "gain_correlation": 0.020628561235299603
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10856174820441881,
        "gain_correlation": 0.05735487790068221
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13302632976082882,
        "gain_correlation": 0.0592561588928331
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12954882523259637,
        "gain_correlation": 0.06928933148801392
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12857895730669475,
        "gain_correlation": 0.06009925770918561
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.12103864898437619,
        "gain_correlation": 0.03169946458629697,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.027498047798871994,
        "alignment_corr_gain": 0.15683838725090027,
        "global_alignment_mastery_corr": 0.10157259661296848,
        "global_alignment_gain_corr": 0.023446292855138988,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.10157259661296848,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9690374936826396,
          "constraint_total": 0.030962506670995465,
          "alignment": -0.004661071194826577,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01415558012862069,
        "min_mastery_variance": 0.009855389595031738,
        "max_mastery_variance": 0.04240371286869049,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.09830960591740381,
        "gain_correlation": 0.04644860001064472,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.058271460235118866,
        "alignment_corr_gain": 0.20913353562355042,
        "global_alignment_mastery_corr": 0.10622668608712653,
        "global_alignment_gain_corr": 0.0175184348152834,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.10622668608712653,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9652329183284551,
          "constraint_total": 0.034767078749058995,
          "alignment": -0.02154494686553805,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009908711875504163,
        "min_mastery_variance": 0.009858209639787674,
        "max_mastery_variance": 0.009994473308324814,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.10678577341004532,
        "gain_correlation": 0.025995745557810736,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.07076288759708405,
        "alignment_corr_gain": 0.23882745206356049,
        "global_alignment_mastery_corr": 0.10640031458877881,
        "global_alignment_gain_corr": 0.04013228969241027,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.10640031458877881,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9589200088238647,
          "constraint_total": 0.04107998862458323,
          "alignment": -0.042285363925045116,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00990820351814359,
        "min_mastery_variance": 0.00988424476236105,
        "max_mastery_variance": 0.01007454190403223,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.08370348059835674,
        "gain_correlation": 0.017722759135902492,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.06918638199567795,
        "alignment_corr_gain": 0.2659221291542053,
        "global_alignment_mastery_corr": 0.093594969340085,
        "global_alignment_gain_corr": 0.04437556749170957,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.10640031458877881,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9564671330125878,
          "constraint_total": 0.043532864305733165,
          "alignment": -0.06809624099226992,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009904377278268647,
        "min_mastery_variance": 0.00989104900509119,
        "max_mastery_variance": 0.009996045380830765,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.10410209530915973,
        "gain_correlation": 0.03755746097244467,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.07891413569450378,
        "alignment_corr_gain": 0.3007223308086395,
        "global_alignment_mastery_corr": 0.09066472152946517,
        "global_alignment_gain_corr": 0.05091684290093933,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.10640031458877881,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9613088496262452,
          "constraint_total": 0.03869114878578888,
          "alignment": -0.10342738078434607,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900968188873536,
        "min_mastery_variance": 0.00989639014005661,
        "max_mastery_variance": 0.00991443544626236,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.14068005532939107,
        "gain_correlation": 0.02308682487403411,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.08263716846704483,
        "alignment_corr_gain": 0.36964336037635803,
        "global_alignment_mastery_corr": 0.12026621168673349,
        "global_alignment_gain_corr": 0.054817379944676455,
        "effective_alignment_weight": 0.13124999999999998,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9340050624045543,
          "constraint_total": 0.06599494189130757,
          "alignment": -0.10339810978564708,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900661904384126,
        "min_mastery_variance": 0.009894409216940403,
        "max_mastery_variance": 0.00991336815059185,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.12391619114376798,
        "gain_correlation": 0.0201915639068507,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.08174207806587219,
        "alignment_corr_gain": 0.39862099289894104,
        "global_alignment_mastery_corr": 0.1105451053599245,
        "global_alignment_gain_corr": 0.04317760971130762,
        "effective_alignment_weight": 0.15312499999999998,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9365703001203766,
          "constraint_total": 0.06342969641939365,
          "alignment": -0.14263015462239909,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009902150698314986,
        "min_mastery_variance": 0.009892468340694904,
        "max_mastery_variance": 0.009922394528985023,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.11624923929066587,
        "gain_correlation": 0.020628561235299603,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08646740764379501,
        "alignment_corr_gain": 0.4534832239151001,
        "global_alignment_mastery_corr": 0.11485472813612432,
        "global_alignment_gain_corr": 0.03626873342388232,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8951415801153292,
          "constraint_total": 0.10485841673792967,
          "alignment": -0.1336406042465403,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900693887835032,
        "min_mastery_variance": 0.009891725145280361,
        "max_mastery_variance": 0.009918387979269028,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.10856174820441881,
        "gain_correlation": 0.05735487790068221,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08852089196443558,
        "alignment_corr_gain": 0.490797221660614,
        "global_alignment_mastery_corr": 0.11323961728417392,
        "global_alignment_gain_corr": 0.036268181079552354,
        "effective_alignment_weight": 0.08574999999999998,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.0002837232163583393,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8604518258233445,
          "constraint_total": 0.13954817714380577,
          "alignment": -0.10727222561785629,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900664466727584,
        "min_mastery_variance": 0.009894102811813354,
        "max_mastery_variance": 0.009912041947245598,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.13302632976082882,
        "gain_correlation": 0.0592561588928331,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08753757923841476,
        "alignment_corr_gain": 0.5150092244148254,
        "global_alignment_mastery_corr": 0.1180224358898704,
        "global_alignment_gain_corr": 0.03844473893398875,
        "effective_alignment_weight": 0.06002499999999998,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8224745671918084,
          "constraint_total": 0.17752206237504928,
          "alignment": -0.08863869924462586,
          "lag": 0.0,
          "retention": 3.3854964836649358e-06
        },
        "mean_mastery_variance": 0.00989997331439059,
        "min_mastery_variance": 0.009875684976577759,
        "max_mastery_variance": 0.00990290753543377,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.12954882523259637,
        "gain_correlation": 0.06928933148801392,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0883246436715126,
        "alignment_corr_gain": 0.5418298840522766,
        "global_alignment_mastery_corr": 0.11533546411055189,
        "global_alignment_gain_corr": 0.04337654109898722,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7980428886223049,
          "constraint_total": 0.2019571054375238,
          "alignment": -0.08294462168985162,
          "lag": -0.001828051700933002,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899899802638768,
        "min_mastery_variance": 0.009872217662632465,
        "max_mastery_variance": 0.009902527555823326,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": -0.036205776035785675,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07790371775627136,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.011448592878878117,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.006213761866092682,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04741296172142029,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.015890756621956825,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13850435614585876,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.046421460807323456,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07225455343723297,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.039475008845329285,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.021768491715192795,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.15554827451705933,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16365750133991241,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1906421035528183,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03395868465304375,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04513770714402199,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08184212446212769,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.027826329693198204,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07396920025348663,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1381729245185852,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08429176360368729,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.048850350081920624,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04158119857311249,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.015120263211429119,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06103259325027466,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09281772375106812,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.017463741824030876,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.006624509114772081,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.010433894582092762,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.017283637076616287,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09075930714607239,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09436582773923874,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.009241039864718914,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1512475162744522,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.10342987626791,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.006644110661000013,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.031672295182943344,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05931904539465904,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13843673467636108,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07763228565454483,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13193635642528534,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05690265819430351,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.020771315321326256,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05897057428956032,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.043852388858795166,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04919326677918434,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10521860420703888,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0035819995682686567,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09322519600391388,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10526005923748016,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14307549595832825,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.005163209978491068,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07516179978847504,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1462283879518509,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.015617788769304752,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0154957240447402,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09577170759439468,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.032990820705890656,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0527799129486084,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11379329860210419,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.031985849142074585,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0861954540014267,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02017485536634922,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.010127761401236057,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.12211988121271133,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11665097624063492,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008782337419688702,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20752078294754028,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07393494248390198,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07941033691167831,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1392853558063507,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.033830638974905014,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.14591746032238007,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03446007892489433,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13294625282287598,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11550591886043549,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21244174242019653,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.016777699813246727,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008217955008149147,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04863326996564865,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02422349900007248,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09777402132749557,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04596812650561333,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08529593050479889,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.008349093608558178,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.026682188734412193,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04968976229429245,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1067003607749939,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.004041680134832859,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04020639508962631,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16656821966171265,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07483318448066711,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05257461220026016,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07833068072795868,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.039021652191877365,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06294427812099457,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07971572130918503,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10734808444976807,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09134703874588013,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.008709744550287724,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014024874195456505,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.042871102690696716,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.056572332978248596,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05905578285455704,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.006571338512003422,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.22792792320251465,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12250834703445435,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07585165649652481,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.010970627889037132,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1206851452589035,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08045851439237595,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.023217348381876945,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0061105177737772465,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05959351360797882,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.10991951823234558,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.048196226358413696,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06428477168083191,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1762666404247284,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2066892385482788,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06296641379594803,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02899562567472458,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.00019061203056480736,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.22303248941898346,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08068030327558517,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11570056527853012,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.033499833196401596,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03465857356786728,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.019440671429038048,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.011776518076658249,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01180559303611517,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08279687911272049,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08897692710161209,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.021059023216366768,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04089631885290146,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11122065037488937,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04743269830942154,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014225859194993973,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05748317018151283,
            "weight": 0.3
          }
        ]
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.12857895730669475,
        "gain_correlation": 0.06009925770918561,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08861864358186722,
        "alignment_corr_gain": 0.5467441082000732,
        "global_alignment_mastery_corr": 0.11454436049569873,
        "global_alignment_gain_corr": 0.04712127399955837,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.12026621168673349,
        "retention_loss_value": 0.00010105916674486604,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.7882523859476706,
          "constraint_total": 0.21174761620116422,
          "alignment": -0.09165604524214203,
          "lag": -0.006469164579806751,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899571972266997,
        "min_mastery_variance": 0.009833987802267075,
        "max_mastery_variance": 0.009904020465910435,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": 0.14353597164154053,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1242215484380722,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3367403745651245,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2801997661590576,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2747361361980438,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.24381357431411743,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2842327952384949,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20169557631015778,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04198256507515907,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06129145994782448,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0011991991195827723,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1346588283777237,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.32029038667678833,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.30916595458984375,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12037065625190735,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11721387505531311,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26018092036247253,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1126120537519455,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0691201314330101,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11047003418207169,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2069166600704193,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20646251738071442,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1995662897825241,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10419793426990509,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1944950371980667,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08682504296302795,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.028680304065346718,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.005426778923720121,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.027824554592370987,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09826892614364624,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18555967509746552,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1654035449028015,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09131427109241486,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07645498961210251,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1118336096405983,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03871224448084831,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09998299926519394,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06668298691511154,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24206796288490295,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18398837745189667,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21776637434959412,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16559186577796936,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.01535353809595108,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06871999800205231,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15024933218955994,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.008438863791525364,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3206750154495239,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10946632921695709,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17031151056289673,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09365168958902359,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.25081291794776917,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13131974637508392,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21812689304351807,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.19553829729557037,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.057964831590652466,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07266490161418915,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.32180094718933105,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1627960503101349,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05772697180509567,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12340562790632248,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0054001761600375175,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09152799844741821,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11881588399410248,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05808943137526512,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08858054131269455,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0900769755244255,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16142816841602325,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.27085354924201965,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05874309688806534,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10715848952531815,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.20079496502876282,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11431372165679932,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.11403240263462067,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.030649889260530472,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.22606182098388672,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.21221578121185303,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.295911967754364,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15744394063949585,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02800191193819046,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05906762555241585,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08197744935750961,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11827708035707474,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05963806062936783,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.060075633227825165,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12725265324115753,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.14305239915847778,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05254145711660385,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11943327635526657,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1468779295682907,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.022185010835528374,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.31613701581954956,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.22934255003929138,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1676359474658966,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07677812874317169,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05274586379528046,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04149442911148071,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05311499536037445,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10704953968524933,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.097648985683918,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05998330935835838,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16619674861431122,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16317135095596313,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07025513797998428,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08433683961629868,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.020892074331641197,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.23128651082515717,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23471446335315704,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.020572038367390633,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05126805603504181,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.045542020350694656,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02365122362971306,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03789544478058815,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0006734536145813763,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09892062097787857,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.14452579617500305,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01661829464137554,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0891171470284462,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1475999653339386,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.33029356598854065,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.21476835012435913,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09184354543685913,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07983802258968353,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.39795684814453125,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.30848053097724915,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24058040976524353,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1291290521621704,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17185483872890472,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.002616007113829255,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05161640793085098,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02296292595565319,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24943189322948456,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2882586121559143,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08052799105644226,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13210996985435486,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2741846740245819,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1962711662054062,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1937371790409088,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.048148561269044876,
            "weight": 0.3
          }
        ]
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "intrinsic_gain_attention": false,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 1.5,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-10T18:33:04.984570",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.12857895730669475,
    "local_gain_corr": 0.06009925770918561,
    "global_mastery_corr": 0.11454436049569873,
    "global_gain_corr": 0.04712127399955837,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}