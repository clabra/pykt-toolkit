{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7248544265474806,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.1041943633304358,
    "gain_correlation": 0.04961028989756451
  },
  "train_history": {
    "train_loss": [
      0.5288629198321406,
      0.5101966424000696,
      0.4986839164724004,
      0.48718980711358817
    ],
    "train_auc": [
      0.6935322332976502,
      0.7249231195479134,
      0.7378546260349902,
      0.7497831641242244
    ],
    "val_auc": [
      0.7179024417020111,
      0.7241479420117107,
      0.7248544265474806,
      0.7210851839098249
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14511937166653974,
        "gain_correlation": -0.011085145468718763
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.17319396366531423,
        "gain_correlation": -0.0085174281183093
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1576610929929473,
        "gain_correlation": 0.014365110643949342
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15651835316121687,
        "gain_correlation": 0.026776519283890812
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.14511937166653974,
        "gain_correlation": -0.011085145468718763,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.009930290281772614,
        "alignment_corr_gain": 0.14497332274913788,
        "global_alignment_mastery_corr": 0.12503303836332635,
        "global_alignment_gain_corr": 0.008366933030483779,
        "effective_alignment_weight": 0.0125,
        "peak_mastery_corr": 0.12503303836332635,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9995968433253907,
          "constraint_total": 0.00040315212605518153,
          "alignment": -0.0016792455868125957,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.020063984746229835,
        "min_mastery_variance": 0.011999931186437607,
        "max_mastery_variance": 0.06243344396352768,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.17319396366531423,
        "gain_correlation": -0.0085174281183093,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.013005778193473816,
        "alignment_corr_gain": 0.1869344413280487,
        "global_alignment_mastery_corr": 0.1333661271081354,
        "global_alignment_gain_corr": 0.008421035095088882,
        "effective_alignment_weight": 0.025,
        "peak_mastery_corr": 0.1333661271081354,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.006789016115135,
          "constraint_total": -0.006789020969667282,
          "alignment": -0.007457259764432517,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.019306968241312342,
        "min_mastery_variance": 0.01362693589180708,
        "max_mastery_variance": 0.024174390360713005,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.1576610929929473,
        "gain_correlation": 0.014365110643949342,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.012086383998394012,
        "alignment_corr_gain": 0.19352349638938904,
        "global_alignment_mastery_corr": 0.12291221119269419,
        "global_alignment_gain_corr": 0.028237658149640386,
        "effective_alignment_weight": 0.037500000000000006,
        "peak_mastery_corr": 0.1333661271081354,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0131048471013715,
          "constraint_total": -0.013104845406173116,
          "alignment": -0.013787856614826049,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.030638233203576018,
        "min_mastery_variance": 0.021842557936906815,
        "max_mastery_variance": 0.03735881671309471,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.15651835316121687,
        "gain_correlation": 0.026776519283890812,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.01644904911518097,
        "alignment_corr_gain": 0.2145780324935913,
        "global_alignment_mastery_corr": 0.1211706764922322,
        "global_alignment_gain_corr": 0.03507992130042112,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.1333661271081354,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0201852835761416,
          "constraint_total": -0.020185283152557625,
          "alignment": -0.02089156080827131,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.04741799329537802,
        "min_mastery_variance": 0.03638271242380142,
        "max_mastery_variance": 0.05788034200668335,
        "per_lag_correlations": []
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "intrinsic_gain_attention": false,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.0,
    "gain_performance_loss_weight": 0.0,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 4,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-11T22:01:27.037829",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 4,
    "local_mastery_corr": 0.15651835316121687,
    "local_gain_corr": 0.026776519283890812,
    "global_mastery_corr": 0.1211706764922322,
    "global_gain_corr": 0.03507992130042112,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}