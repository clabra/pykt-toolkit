{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7257377349250834,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.08667573538304907,
    "gain_correlation": 0.05858986421865886
  },
  "train_history": {
    "train_loss": [
      0.5415483563366331,
      0.5187057471337096,
      0.507576567521367,
      0.494828149753531,
      0.47734542152424553,
      0.47216681155516077,
      0.4448911041175763,
      0.432245786171503,
      0.41531724309056534,
      0.3786841593875786,
      0.34787859933672793,
      0.3203122220508793
    ],
    "train_auc": [
      0.6924200341278968,
      0.7244631198960132,
      0.7368756253630886,
      0.7470997152333407,
      0.7586408072915973,
      0.7745601340220462,
      0.7960327459358584,
      0.8229700564681599,
      0.8515171399985015,
      0.8881889376985767,
      0.9108227283793426,
      0.9248443047170586
    ],
    "val_auc": [
      0.7177893673982293,
      0.7250079897204291,
      0.7257377349250834,
      0.7238445624366929,
      0.7175798558622267,
      0.7063838970900855,
      0.6915044977679005,
      0.679265453697131,
      0.6715821468111431,
      0.666362277739357,
      0.6590990456418909,
      0.6491768463589114
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11105586413552167,
        "gain_correlation": 0.007931801612555883
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1035182332584719,
        "gain_correlation": 0.0085595049631516
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10984524729117279,
        "gain_correlation": 0.01811547533565849
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10119588679286837,
        "gain_correlation": 0.005008106931796875
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.08437370801400611,
        "gain_correlation": 0.005283719069333942
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12612482832314068,
        "gain_correlation": 0.00560632129545961
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1444819154260097,
        "gain_correlation": 0.02444032721307685
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13674532715112653,
        "gain_correlation": 0.028324278555513036
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13207639104303937,
        "gain_correlation": 0.06412635943805926
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14129694046212224,
        "gain_correlation": 0.07169829336546084
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12931252497120846,
        "gain_correlation": 0.06920956291221488
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12530760453813672,
        "gain_correlation": 0.071118236801165
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.11105586413552167,
        "gain_correlation": 0.007931801612555883,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.028315162286162376,
        "alignment_corr_gain": 0.15257342159748077,
        "global_alignment_mastery_corr": 0.1038509571091951,
        "global_alignment_gain_corr": 0.021153286755579755,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.1038509571091951,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9823855654948911,
          "constraint_total": 0.017614436622622954,
          "alignment": -0.005505896945801018,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014698396267977403,
        "min_mastery_variance": 0.009818008169531822,
        "max_mastery_variance": 0.04607861116528511,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.1035182332584719,
        "gain_correlation": 0.0085595049631516,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0662560984492302,
        "alignment_corr_gain": 0.1935359686613083,
        "global_alignment_mastery_corr": 0.10056719370467666,
        "global_alignment_gain_corr": 0.024885211393157077,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.1038509571091951,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.990820212042369,
          "constraint_total": 0.00917979205093893,
          "alignment": -0.02268702350840174,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009905706449300822,
        "min_mastery_variance": 0.00983949564397335,
        "max_mastery_variance": 0.009975009597837925,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.10984524729117279,
        "gain_correlation": 0.01811547533565849,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0692167580127716,
        "alignment_corr_gain": 0.24894200265407562,
        "global_alignment_mastery_corr": 0.10778088615537854,
        "global_alignment_gain_corr": 0.043317882281941514,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.10778088615537854,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9967532767448375,
          "constraint_total": 0.0032467258030253812,
          "alignment": -0.044008879885463176,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00991025582978917,
        "min_mastery_variance": 0.00988803245127201,
        "max_mastery_variance": 0.010137496516108513,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.10119588679286837,
        "gain_correlation": 0.005008106931796875,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0782167911529541,
        "alignment_corr_gain": 0.2745143473148346,
        "global_alignment_mastery_corr": 0.09847545139717112,
        "global_alignment_gain_corr": 0.04173880604813651,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.10778088615537854,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0080927268001785,
          "constraint_total": -0.008092732046690808,
          "alignment": -0.0719116390735609,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009903257789929914,
        "min_mastery_variance": 0.009891912341117859,
        "max_mastery_variance": 0.009953232482075691,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.08437370801400611,
        "gain_correlation": 0.005283719069333942,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.08105424046516418,
        "alignment_corr_gain": 0.31375405192375183,
        "global_alignment_mastery_corr": 0.08443509377054094,
        "global_alignment_gain_corr": 0.04016437343331442,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.10778088615537854,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0274565030702203,
          "constraint_total": -0.02745650547617263,
          "alignment": -0.10959193459158705,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900878419993455,
        "min_mastery_variance": 0.00989560130983591,
        "max_mastery_variance": 0.009955137968063354,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.12612482832314068,
        "gain_correlation": 0.00560632129545961,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.08790050446987152,
        "alignment_corr_gain": 0.35742902755737305,
        "global_alignment_mastery_corr": 0.11252350446167232,
        "global_alignment_gain_corr": 0.04779651401969507,
        "effective_alignment_weight": 0.13124999999999998,
        "peak_mastery_corr": 0.11252350446167232,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0126199458091931,
          "constraint_total": -0.012619942232222342,
          "alignment": -0.11183074972417424,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900028185214403,
        "min_mastery_variance": 0.009897354058921337,
        "max_mastery_variance": 0.009918480180203915,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.1444819154260097,
        "gain_correlation": 0.02444032721307685,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.0944046676158905,
        "alignment_corr_gain": 0.40314096212387085,
        "global_alignment_mastery_corr": 0.11636975509454107,
        "global_alignment_gain_corr": 0.04463546912447782,
        "effective_alignment_weight": 0.15312499999999998,
        "peak_mastery_corr": 0.11636975509454107,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.033951502427991,
          "constraint_total": -0.033951497959238505,
          "alignment": -0.1566705660898037,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899986179188434,
        "min_mastery_variance": 0.009888926520943642,
        "max_mastery_variance": 0.009911790490150452,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.13674532715112653,
        "gain_correlation": 0.028324278555513036,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0961792841553688,
        "alignment_corr_gain": 0.4619845151901245,
        "global_alignment_mastery_corr": 0.11510429984269042,
        "global_alignment_gain_corr": 0.04834620334719754,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.11636975509454107,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0046218693446811,
          "constraint_total": -0.00462186787105958,
          "alignment": -0.14890712049982774,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899700610594428,
        "min_mastery_variance": 0.009896459989249706,
        "max_mastery_variance": 0.009905620478093624,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.13207639104303937,
        "gain_correlation": 0.06412635943805926,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.09736326336860657,
        "alignment_corr_gain": 0.5327156186103821,
        "global_alignment_mastery_corr": 0.11675982824536428,
        "global_alignment_gain_corr": 0.049296352700330316,
        "effective_alignment_weight": 0.08574999999999998,
        "peak_mastery_corr": 0.11675982824536428,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9699522515661743,
          "constraint_total": 0.030047750106938987,
          "alignment": -0.12018728890475933,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899613481265893,
        "min_mastery_variance": 0.009893704205751419,
        "max_mastery_variance": 0.009907280094921589,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.14129694046212224,
        "gain_correlation": 0.07169829336546084,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.09546180069446564,
        "alignment_corr_gain": 0.5626441240310669,
        "global_alignment_mastery_corr": 0.11540628934277872,
        "global_alignment_gain_corr": 0.04822701897879597,
        "effective_alignment_weight": 0.06002499999999998,
        "peak_mastery_corr": 0.11675982824536428,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9368231716351971,
          "constraint_total": 0.06317682285990292,
          "alignment": -0.1016207921627508,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899973425377219,
        "min_mastery_variance": 0.00989775825291872,
        "max_mastery_variance": 0.009904604405164719,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.12931252497120846,
        "gain_correlation": 0.06920956291221488,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.08871347457170486,
        "alignment_corr_gain": 0.5702032446861267,
        "global_alignment_mastery_corr": 0.11522760125430068,
        "global_alignment_gain_corr": 0.043363332598819394,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.11675982824536428,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9186657960411224,
          "constraint_total": 0.08133420265498137,
          "alignment": -0.09592661870933233,
          "lag": -0.002112599337654985,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899798939921387,
        "min_mastery_variance": 0.009892475791275501,
        "max_mastery_variance": 0.009905287064611912,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": 0.0899924710392952,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08027996867895126,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.049997907131910324,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01782875880599022,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.034368690103292465,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07763472944498062,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.051256030797958374,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.013717399910092354,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02526487037539482,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08507750183343887,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02939859963953495,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.039357151836156845,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07089931517839432,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11226736009120941,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02348177321255207,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.030978813767433167,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05858076363801956,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.009666519239544868,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11803794652223587,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0952666848897934,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.062355928122997284,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11947155743837357,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0402500182390213,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.010122131556272507,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.015666591003537178,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0492650605738163,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.00221570348367095,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.008131920360028744,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0021056749392300844,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06831347942352295,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07243793457746506,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08394800126552582,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0226501002907753,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09267578274011612,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.11872513592243195,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.034143198281526566,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.027926422655582428,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05580929294228554,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12254129350185394,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.020711297169327736,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16424691677093506,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0697062611579895,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.025346118956804276,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11257730424404144,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.010936404578387737,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04579853266477585,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14164339005947113,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.005927713122218847,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03782328590750694,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.18043284118175507,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08401735126972198,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.024014823138713837,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07382753491401672,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11143989115953445,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04145209863781929,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.028951384127140045,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13252340257167816,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08688052743673325,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1306530386209488,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.00827268697321415,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06524128466844559,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.003872271627187729,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.00863418448716402,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.102861188352108,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.007844588719308376,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0652269646525383,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04965679347515106,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09015659242868423,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02618219517171383,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07104586809873581,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1709340363740921,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05633029341697693,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03605617582798004,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04621070250868797,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12413395196199417,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.074427530169487,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13356788456439972,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04051369056105614,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06858357787132263,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04694177210330963,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.015838798135519028,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1827830672264099,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02444971352815628,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0719422996044159,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03357645869255066,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0386318564414978,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.028413234278559685,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20461130142211914,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.017722729593515396,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0507536455988884,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1329932063817978,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07013929635286331,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.013078354299068451,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.033884644508361816,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09708774089813232,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09671899676322937,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012892455793917179,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09827234596014023,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.047848522663116455,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.011868699453771114,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03658677637577057,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.033644385635852814,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.041902147233486176,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07229219377040863,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.005565004423260689,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.25160375237464905,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08851722627878189,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12935470044612885,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11445830762386322,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0007236136007122695,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02204369381070137,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0600191093981266,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.023865528404712677,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07273835688829422,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.032559268176555634,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1012352705001831,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.058966632932424545,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08634424954652786,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1444612592458725,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06501024961471558,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.013217545114457607,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.027652839198708534,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26725465059280396,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13718988001346588,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.055820465087890625,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04602201282978058,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.00973600335419178,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.003943961579352617,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.010413137264549732,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06823749095201492,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10269444435834885,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07114464044570923,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.036823779344558716,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01893453486263752,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06267125904560089,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10108441859483719,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0679127648472786,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07189500331878662,
            "weight": 0.3
          }
        ]
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.12530760453813672,
        "gain_correlation": 0.071118236801165,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.09769001603126526,
        "alignment_corr_gain": 0.5631171464920044,
        "global_alignment_mastery_corr": 0.11443366670321363,
        "global_alignment_gain_corr": 0.042866001268572894,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.11675982824536428,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9194677050119976,
          "constraint_total": 0.08053229751892338,
          "alignment": -0.10635348142421987,
          "lag": -0.007942554902711957,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009899939062952069,
        "min_mastery_variance": 0.009898100979626179,
        "max_mastery_variance": 0.009904376231133938,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": 0.2402115911245346,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17111830413341522,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.28917720913887024,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1764279156923294,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11806832998991013,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.015889126807451248,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2754449248313904,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1667109876871109,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.004535297863185406,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06180441379547119,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08444581180810928,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02568265236914158,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3324221968650818,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.23390154540538788,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1704998016357422,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12873674929141998,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23704996705055237,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10475099831819534,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19819991290569305,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03263094276189804,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2551681101322174,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2114233523607254,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15281778573989868,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06728310883045197,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.020917844027280807,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.008029980584979057,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.025761403143405914,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.053634289652109146,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14249637722969055,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15646176040172577,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17572055757045746,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18256330490112305,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06822891533374786,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0007994725019671023,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0953129231929779,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.014799586497247219,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06908553838729858,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05858390033245087,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26827752590179443,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.14729224145412445,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.22933731973171234,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20090489089488983,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07450591772794724,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07584895193576813,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02186737209558487,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.022566605359315872,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2869240343570709,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04958413168787956,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.027251148596405983,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.17124930024147034,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23453716933727264,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11086814105510712,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.19622933864593506,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20319677889347076,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15117821097373962,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.020304935052990913,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3097642958164215,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15436600148677826,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2189352810382843,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02188762091100216,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11775119602680206,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16701500117778778,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014152000658214092,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.14029885828495026,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02043231949210167,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.043822430074214935,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18509455025196075,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.21713201701641083,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.029212063178420067,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04036856070160866,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26058298349380493,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09392832964658737,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0454268679022789,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.006005456671118736,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21071745455265045,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1369813084602356,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.25213485956192017,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1472405195236206,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012783799320459366,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.028587644919753075,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04668237641453743,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.15239226818084717,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06263630092144012,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03290034830570221,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14701446890830994,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13057902455329895,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06943114846944809,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.25567370653152466,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18614092469215393,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.029840650036931038,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.28937384486198425,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2236316055059433,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0451953187584877,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.006951396353542805,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.052988506853580475,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03585529699921608,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.005383176729083061,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.14340533316135406,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1373671293258667,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09304136037826538,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0007023466750979424,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.046777740120887756,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.021780114620923996,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10646302998065948,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.05492163449525833,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.27118638157844543,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.20907756686210632,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.009775367565453053,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2680274546146393,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1674923598766327,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14721795916557312,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2201245278120041,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1430985927581787,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02289118804037571,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05336907133460045,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1743578463792801,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14519909024238586,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1848926693201065,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3263823986053467,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2644710838794708,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.01922806352376938,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0054707275703549385,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.4824710786342621,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.3506947457790375,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17898431420326233,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08472776412963867,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.056705135852098465,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.012386573478579521,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.027322717010974884,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.036317288875579834,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2808903455734253,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20319519937038422,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09519176185131073,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0984107255935669,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24440588057041168,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.199894979596138,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.21489553153514862,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02602180279791355,
            "weight": 0.3
          }
        ]
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-02T09:24:11.587016",
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.12530760453813672,
    "local_gain_corr": 0.071118236801165,
    "global_mastery_corr": 0.11443366670321363,
    "global_gain_corr": 0.042866001268572894,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}