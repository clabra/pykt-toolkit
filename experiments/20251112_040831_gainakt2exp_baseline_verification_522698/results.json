{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7243324911670221,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.09882955152016999,
    "gain_correlation": 0.02822253807717071
  },
  "train_history": {
    "train_loss": [
      0.5379500629988359,
      0.5167028466963397,
      0.5047759444602413,
      0.4946366780162475,
      0.4848376704003527
    ],
    "train_auc": [
      0.677956528822259,
      0.7133329817991777,
      0.7252976923352595,
      0.7335663081420989,
      0.7403550770941191
    ],
    "val_auc": [
      0.7072663970991618,
      0.7177495716274883,
      0.7222639950722327,
      0.7239592593888151,
      0.7243324911670221
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15724881001006824,
        "gain_correlation": 0.055963194843236114
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15415261444384323,
        "gain_correlation": 0.015932357081152867
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1588217861376368,
        "gain_correlation": -0.007644659483307439
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15160726879343248,
        "gain_correlation": -0.0053984914445593625
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15064626518765353,
        "gain_correlation": 0.0006681914737267571
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.15724881001006824,
        "gain_correlation": 0.055963194843236114,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.008717404678463936,
        "alignment_corr_gain": 0.08822748064994812,
        "global_alignment_mastery_corr": 0.09579664442700707,
        "global_alignment_gain_corr": 0.02073649890633533,
        "effective_alignment_weight": 0.01875,
        "peak_mastery_corr": 0.09579664442700707,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9961969410989683,
          "constraint_total": 0.003803055165124318,
          "alignment": -0.0014503798129673784,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.030502399153192528,
        "min_mastery_variance": 0.01271606795489788,
        "max_mastery_variance": 0.06578079611063004,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.15415261444384323,
        "gain_correlation": 0.015932357081152867,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.009054205380380154,
        "alignment_corr_gain": 0.17974933981895447,
        "global_alignment_mastery_corr": 0.11658584350234984,
        "global_alignment_gain_corr": 0.007544224675172397,
        "effective_alignment_weight": 0.0375,
        "peak_mastery_corr": 0.11658584350234984,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0077437481663611,
          "constraint_total": -0.007743747149865442,
          "alignment": -0.00863307953219624,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.015851290717991212,
        "min_mastery_variance": 0.01208367571234703,
        "max_mastery_variance": 0.020763566717505455,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.1588217861376368,
        "gain_correlation": -0.007644659483307439,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.011534586548805237,
        "alignment_corr_gain": 0.18556338548660278,
        "global_alignment_mastery_corr": 0.12336681810712131,
        "global_alignment_gain_corr": 0.011263483242219081,
        "effective_alignment_weight": 0.056249999999999994,
        "peak_mastery_corr": 0.12336681810712131,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.017018028700159,
          "constraint_total": -0.0170180292136939,
          "alignment": -0.017873580819245193,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.018396430412413543,
        "min_mastery_variance": 0.013606219552457333,
        "max_mastery_variance": 0.02267165668308735,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.15160726879343248,
        "gain_correlation": -0.0053984914445593625,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.010268325917422771,
        "alignment_corr_gain": 0.1879708617925644,
        "global_alignment_mastery_corr": 0.12052139141965502,
        "global_alignment_gain_corr": 0.019397607039960955,
        "effective_alignment_weight": 0.075,
        "peak_mastery_corr": 0.12336681810712131,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0271274187955644,
          "constraint_total": -0.027127416635601073,
          "alignment": -0.028001918349814574,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.024793615342730686,
        "min_mastery_variance": 0.0190853513777256,
        "max_mastery_variance": 0.03014644980430603,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.15064626518765353,
        "gain_correlation": 0.0006681914737267571,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.011756807565689087,
        "alignment_corr_gain": 0.2006673365831375,
        "global_alignment_mastery_corr": 0.11811666646147691,
        "global_alignment_gain_corr": 0.02595992541366286,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.12336681810712131,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0385477218605899,
          "constraint_total": -0.03854772094772887,
          "alignment": -0.03945523113767573,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.03276831220468709,
        "min_mastery_variance": 0.027262242510914803,
        "max_mastery_variance": 0.03694777563214302,
        "per_lag_correlations": []
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 5,
    "local_mastery_corr": 0.15064626518765353,
    "local_gain_corr": 0.0006681914737267571,
    "global_mastery_corr": 0.11811666646147691,
    "global_gain_corr": 0.02595992541366286,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}