{
  "experiment_name": "optimal_v1",
  "best_val_auc": 0.7255093624420091,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.11011013689718331,
    "gain_correlation": 0.07637430183512402
  },
  "train_history": {
    "train_loss": [
      0.5451487287338533,
      0.5323414780933005,
      0.5275329124433389,
      0.5214351875794366,
      0.5100697851860462,
      0.49111561639321283,
      0.4875256076377908,
      0.4823139732983446,
      0.44636660212062185,
      0.39273958672513615,
      0.35152391850021836,
      0.3477387789617548
    ],
    "train_auc": [
      0.6935369342645058,
      0.724358375692818,
      0.736814466295446,
      0.7470278549187669,
      0.7585487953081338,
      0.7739713891044957,
      0.7969258095618676,
      0.8238573588331568,
      0.8507768978418353,
      0.8863140757021487,
      0.909312005307015,
      0.9241412259570058
    ],
    "val_auc": [
      0.7173204779388027,
      0.7246751364673608,
      0.7255093624420091,
      0.7231689656081359,
      0.7174375573859757,
      0.7080211000047384,
      0.694078706207996,
      0.6787591443118164,
      0.6642362795981906,
      0.664949299554583,
      0.6561411527899716,
      0.6520190671426218
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11295525627354384,
        "gain_correlation": 0.023686848485301504
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11179025058639078,
        "gain_correlation": 0.03870696379115133
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.09416183980188687,
        "gain_correlation": 0.031051930580880523
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11428069408346271,
        "gain_correlation": 0.033465281868759494
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1436402247455972,
        "gain_correlation": 0.01302178669934027
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12834879486416614,
        "gain_correlation": 0.024164784726565688
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.08834862357802159,
        "gain_correlation": 0.028710101495825535
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11231218599288614,
        "gain_correlation": 0.032076491991116
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14730227284496142,
        "gain_correlation": 0.04728525752043983
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15224901785630698,
        "gain_correlation": 0.06779119719234208
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1475857384265184,
        "gain_correlation": 0.07284557835879117
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.16201787984575622,
        "gain_correlation": 0.07775299116557675
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.11295525627354384,
        "gain_correlation": 0.023686848485301504,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.028321338817477226,
        "alignment_corr_gain": 0.1610816866159439,
        "global_alignment_mastery_corr": 0.10219722548121353,
        "global_alignment_gain_corr": 0.02490405141674273,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.10219722548121353,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9695747184533582,
          "constraint_total": 0.03042528083470044,
          "alignment": -0.004837445071102084,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.013638309460172119,
        "min_mastery_variance": 0.009856918826699257,
        "max_mastery_variance": 0.04052708297967911,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.11179025058639078,
        "gain_correlation": 0.03870696379115133,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.059221431612968445,
        "alignment_corr_gain": 0.21237178146839142,
        "global_alignment_mastery_corr": 0.1113426549503735,
        "global_alignment_gain_corr": 0.02105012630141573,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.1113426549503735,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.965510753018337,
          "constraint_total": 0.03448924501462731,
          "alignment": -0.021676722301619256,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009905802694009376,
        "min_mastery_variance": 0.009860441088676453,
        "max_mastery_variance": 0.00999220460653305,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.09416183980188687,
        "gain_correlation": 0.031051930580880523,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.0772181823849678,
        "alignment_corr_gain": 0.2438211292028427,
        "global_alignment_mastery_corr": 0.09782267303744448,
        "global_alignment_gain_corr": 0.03673413313163716,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.1113426549503735,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9590035775650899,
          "constraint_total": 0.0409964252248387,
          "alignment": -0.042343537216850996,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009910096785951155,
        "min_mastery_variance": 0.009889417327940464,
        "max_mastery_variance": 0.010002460330724716,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.11428069408346271,
        "gain_correlation": 0.033465281868759494,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.0732128918170929,
        "alignment_corr_gain": 0.27967706322669983,
        "global_alignment_mastery_corr": 0.10927283335171524,
        "global_alignment_gain_corr": 0.04334215396704773,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.1113426549503735,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9568887364529018,
          "constraint_total": 0.04311126260316195,
          "alignment": -0.06839096913691337,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009904058852807228,
        "min_mastery_variance": 0.009893282316625118,
        "max_mastery_variance": 0.010002896189689636,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.1436402247455972,
        "gain_correlation": 0.01302178669934027,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.07035213708877563,
        "alignment_corr_gain": 0.3059380352497101,
        "global_alignment_mastery_corr": 0.11682072072828305,
        "global_alignment_gain_corr": 0.04734664278769439,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.11682072072828305,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9617628475348946,
          "constraint_total": 0.038237153297627745,
          "alignment": -0.1037964345793498,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009903279726678225,
        "min_mastery_variance": 0.009895398281514645,
        "max_mastery_variance": 0.009971479885280132,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.12834879486416614,
        "gain_correlation": 0.024164784726565688,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.07299438863992691,
        "alignment_corr_gain": 0.35303276777267456,
        "global_alignment_mastery_corr": 0.10508689641496555,
        "global_alignment_gain_corr": 0.048127572767843955,
        "effective_alignment_weight": 0.1875,
        "peak_mastery_corr": 0.11682072072828305,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9746508001591913,
          "constraint_total": 0.025349198622434413,
          "alignment": -0.1513611542168652,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00990127494626249,
        "min_mastery_variance": 0.009894715622067451,
        "max_mastery_variance": 0.009914505295455456,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.08834862357802159,
        "gain_correlation": 0.028710101495825535,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.09200822561979294,
        "alignment_corr_gain": 0.4291764795780182,
        "global_alignment_mastery_corr": 0.09310991162628246,
        "global_alignment_gain_corr": 0.05402151136091561,
        "effective_alignment_weight": 0.15312499999999998,
        "peak_mastery_corr": 0.11682072072828305,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9420620021866488,
          "constraint_total": 0.05793799322070098,
          "alignment": -0.14944368890703078,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009902405451230435,
        "min_mastery_variance": 0.00989757850766182,
        "max_mastery_variance": 0.009922429919242859,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.11231218599288614,
        "gain_correlation": 0.032076491991116,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.09661396592855453,
        "alignment_corr_gain": 0.47679513692855835,
        "global_alignment_mastery_corr": 0.10791331110049214,
        "global_alignment_gain_corr": 0.05489611229353007,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.11682072072828305,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8987582303567556,
          "constraint_total": 0.10124177144412733,
          "alignment": -0.13800622245328648,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.00990163777120064,
        "min_mastery_variance": 0.009897073730826378,
        "max_mastery_variance": 0.009915165603160858,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.14730227284496142,
        "gain_correlation": 0.04728525752043983,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0900578573346138,
        "alignment_corr_gain": 0.5135930180549622,
        "global_alignment_mastery_corr": 0.11439066034569502,
        "global_alignment_gain_corr": 0.04564484418932504,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.11682072072828305,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9044525809939422,
          "constraint_total": 0.09554741684393121,
          "alignment": -0.16327461128885434,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009902180278664118,
        "min_mastery_variance": 0.009898243471980095,
        "max_mastery_variance": 0.009940792806446552,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.15224901785630698,
        "gain_correlation": 0.06779119719234208,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.09490618854761124,
        "alignment_corr_gain": 0.5260413885116577,
        "global_alignment_mastery_corr": 0.12292226300036418,
        "global_alignment_gain_corr": 0.05065989237676452,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.12292226300036418,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.911726580536458,
          "constraint_total": 0.08827341882462937,
          "alignment": -0.20619477667874864,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900326748894904,
        "min_mastery_variance": 0.00989218894392252,
        "max_mastery_variance": 0.009904206730425358,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.1475857384265184,
        "gain_correlation": 0.07284557835879117,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.09679378569126129,
        "alignment_corr_gain": 0.5524112582206726,
        "global_alignment_mastery_corr": 0.12114111097313678,
        "global_alignment_gain_corr": 0.05223900041465337,
        "effective_alignment_weight": 0.12249999999999998,
        "peak_mastery_corr": 0.12292226300036418,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9166532734938423,
          "constraint_total": 0.08334672573742398,
          "alignment": -0.2441139790449303,
          "lag": -0.0016382910232173359,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009900550555843145,
        "min_mastery_variance": 0.00989694707095623,
        "max_mastery_variance": 0.00990856159478426,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": -0.03752719983458519,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0988750010728836,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1066824346780777,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01931270770728588,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0830763652920723,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.057217326015233994,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1735576093196869,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.053117137402296066,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06039344519376755,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01560791302472353,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.007093959022313356,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08484023809432983,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12441305816173553,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1661650389432907,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.006071573588997126,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.009394106455147266,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07131319493055344,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.008540244773030281,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07964809238910675,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05245397612452507,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.060061316937208176,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04240074381232262,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.01611088402569294,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.012433482334017754,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0465284064412117,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10113746672868729,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014853337779641151,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04731222987174988,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03292466700077057,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.040256209671497345,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07753690332174301,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08333846926689148,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02482115849852562,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.135127454996109,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08892983198165894,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.026183903217315674,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03421485424041748,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09776239842176437,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03745410963892937,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03496652841567993,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08316147327423096,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06492193788290024,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0017832128796726465,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11180142313241959,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.011223908513784409,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08338751643896103,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12995541095733643,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04653054103255272,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05976114422082901,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08777716755867004,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15765318274497986,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01928320713341236,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09461011737585068,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12965074181556702,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03741287812590599,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.027255713939666748,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10774275660514832,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04685504734516144,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.025759082287549973,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.14844869077205658,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.008368583396077156,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.006315216422080994,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.010047304444015026,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10160364955663681,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04779091849923134,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.15159064531326294,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.013901771977543831,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.14789870381355286,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08439567685127258,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09400571882724762,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11972371488809586,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.029133005067706108,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09757931530475616,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05063220113515854,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.020124047994613647,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.048846177756786346,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.20789982378482819,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.012075522914528847,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03976698964834213,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.032799236476421356,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014594530686736107,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10561694949865341,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04199108108878136,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11928185075521469,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03368189558386803,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0144998449832201,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07156823575496674,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.014725940302014351,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.015863638371229172,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.020675087347626686,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1218462660908699,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06687729060649872,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.019565455615520477,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03693096339702606,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.028010888025164604,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.023900119587779045,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07502633333206177,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11832544952630997,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04404456540942192,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05326483026146889,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.035437095910310745,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.01418046560138464,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1022757962346077,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02921419031918049,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.009145389311015606,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1972968876361847,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17898915708065033,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06625210493803024,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03753724694252014,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05546439439058304,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07231588661670685,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04265561327338219,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.024045472964644432,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10114257037639618,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.047635797411203384,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0594385527074337,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04156770929694176,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1348673552274704,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24961112439632416,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09423542767763138,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.062153711915016174,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.046486418694257736,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15237343311309814,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1058584600687027,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11241486668586731,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.015514793805778027,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04067552462220192,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.043468352407217026,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04161836579442024,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.009705331176519394,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03827052563428879,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11948894709348679,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06977707147598267,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.004000688903033733,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.00801329966634512,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06319242715835571,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0008920478285290301,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.004175608046352863,
            "weight": 0.3
          }
        ]
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.16201787984575622,
        "gain_correlation": 0.07775299116557675,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0976889505982399,
        "alignment_corr_gain": 0.5712807178497314,
        "global_alignment_mastery_corr": 0.12646481166467613,
        "global_alignment_gain_corr": 0.0485292197317843,
        "effective_alignment_weight": 0.08574999999999998,
        "peak_mastery_corr": 0.12646481166467613,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.0,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.8508804885002924,
          "constraint_total": 0.14911951027854825,
          "alignment": -0.17810559794972608,
          "lag": -0.005453670555158605,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.009901213821583462,
        "min_mastery_variance": 0.009894181974232197,
        "max_mastery_variance": 0.009911400265991688,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": 0.14839135110378265,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1810591220855713,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.35730427503585815,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1543375849723816,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2706347107887268,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.16304638981819153,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.34685018658638,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2052093744277954,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03894919902086258,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06667598336935043,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.002735750051215291,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07472304254770279,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23277056217193604,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.28649696707725525,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10933391749858856,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10442633926868439,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23841582238674164,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08613934367895126,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11421284824609756,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.027527805417776108,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.15175284445285797,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1702030599117279,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.13534404337406158,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09624440222978592,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03721175715327263,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06565508991479874,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06335364282131195,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07696757465600967,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.00910139549523592,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05550588667392731,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1187288910150528,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13329528272151947,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06317970156669617,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05747527256608009,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.057730283588171005,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0032575700897723436,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07235068082809448,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10103379935026169,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.16645187139511108,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08182333409786224,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1807684600353241,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17451204359531403,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014394047670066357,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09383215010166168,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.029601499438285828,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10405340045690536,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26068565249443054,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12854410707950592,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12112144380807877,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.037908006459474564,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.2774849534034729,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09060154855251312,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.18351058661937714,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.19594910740852356,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08482697606086731,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02366035059094429,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.23821356892585754,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06690831482410431,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012330630794167519,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11574508249759674,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0003102375194430351,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.031849730759859085,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.028459450230002403,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07614174485206604,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06966158747673035,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1249239444732666,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14567497372627258,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2187393605709076,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09229269623756409,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1045934408903122,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1836065649986267,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02527356892824173,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06917524337768555,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.014553436078131199,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.17808283865451813,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1989114135503769,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.27168747782707214,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08825355768203735,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08659391105175018,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08595263212919235,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04097914323210716,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.14761507511138916,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.039348054677248,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08201034367084503,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07503458112478256,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09538284689188004,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.014803745783865452,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0662863701581955,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1048053726553917,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.039750535041093826,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26362189650535583,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1068839579820633,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.028009122237563133,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.027381859719753265,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0811753123998642,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.013600483536720276,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07667000591754913,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.14186473190784454,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05684249475598335,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02589740976691246,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02233639545738697,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07274950295686722,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.13210490345954895,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05818957835435867,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.011051857843995094,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.18134725093841553,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.26245173811912537,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.011817198246717453,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.24606992304325104,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1441270411014557,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.022068357095122337,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12879899144172668,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07552425563335419,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0680304765701294,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06615156680345535,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11139893531799316,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1526426076889038,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.21266992390155792,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.3323669731616974,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.2046864777803421,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10374720394611359,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.021073805168271065,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.37878119945526123,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.24661746621131897,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.22973741590976715,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08049214631319046,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09555619955062866,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.017327819019556046,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.010667931288480759,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0038933379109948874,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11593426018953323,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.046721186488866806,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.075766421854496,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03261871263384819,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08709101378917694,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08648484200239182,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0019134079338982701,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06866464763879776,
            "weight": 0.3
          }
        ]
      }
    ],
    "determinism_fallback_batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "intrinsic_gain_attention": false,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 1.5,
    "gain_performance_loss_weight": 0.0,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.0
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0
  },
  "timestamp": "2025-11-10T21:03:01.475090",
  "determinism_fallback": {
    "count": 1,
    "batches": [
      {
        "epoch": 1,
        "batch": 0
      }
    ]
  },
  "correlation_sampling": {
    "deterministic": true,
    "epoch": 12,
    "local_mastery_corr": 0.16201787984575622,
    "local_gain_corr": 0.07775299116557675,
    "global_mastery_corr": 0.12646481166467613,
    "global_gain_corr": 0.0485292197317843,
    "notes": "Deterministic stratified selection (sorted slice) applied; seeds fixed."
  }
}