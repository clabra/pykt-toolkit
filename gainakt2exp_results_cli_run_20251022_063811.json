{
  "experiment_name": "cli_run",
  "best_val_auc": 0.7242163405308526,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": -0.01776367684782373,
    "gain_correlation": 0.054494435037123465
  },
  "train_history": {
    "train_loss": [
      0.5386377349109848,
      0.5094640329094131,
      0.49352007980791396,
      0.4767081434862601,
      0.45442197606971224,
      0.4530236565078478,
      0.4221696748634694,
      0.3723638292421331,
      0.3615636793134126,
      0.31510296101088353,
      0.306766295371278,
      0.2856286725540853
    ],
    "train_auc": [
      0.6899790429480214,
      0.7229818813475716,
      0.735152813156385,
      0.7449362584674746,
      0.7571201903031153,
      0.7741368111411546,
      0.794409984328959,
      0.8185321356320673,
      0.8460127038879285,
      0.880163044022558,
      0.90148374300701,
      0.9165030123450222
    ],
    "val_auc": [
      0.7149799013032767,
      0.7227144457490162,
      0.7242163405308526,
      0.723128603339037,
      0.7162515231231994,
      0.7047662583193792,
      0.6914841580138107,
      0.6754406119549744,
      0.661201045434789,
      0.6523059586597775,
      0.6463297435908728,
      0.6414426129946614
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.0013641099892762716,
        "gain_correlation": 0.11379576923251189
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.003165302704811293,
        "gain_correlation": 0.117187887295312
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.003202288790708535,
        "gain_correlation": 0.07569981791776537
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.029105691118561084,
        "gain_correlation": 0.07073713980476592
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.002624792251836801,
        "gain_correlation": 0.10379817264062083
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -3.746062700658228e-05,
        "gain_correlation": 0.12223540473216547
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.04207841387171002,
        "gain_correlation": 0.07915889012415785
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.04950498537794176,
        "gain_correlation": 0.04394479365389233
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.04312325055641478,
        "gain_correlation": 0.09104024980258614
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.010537081930257475,
        "gain_correlation": 0.09242657208619262
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0018504658207759604,
        "gain_correlation": 0.08943681127087781
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0028595351284393077,
        "gain_correlation": 0.07777233367194278
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": -0.0013641099892762716,
        "gain_correlation": 0.11379576923251189,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.16806909441947937,
        "alignment_corr_gain": 0.25734686851501465,
        "global_alignment_mastery_corr": 0.003650860089668034,
        "global_alignment_gain_corr": 0.023660494576470226,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9901174053150917,
          "constraint_total": 0.009882592675634875,
          "alignment": -0.01390508513742833,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.018442210118850895,
        "min_mastery_variance": 0.012118426151573658,
        "max_mastery_variance": 0.04236399009823799,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": -0.003165302704811293,
        "gain_correlation": 0.117187887295312,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.1738254278898239,
        "alignment_corr_gain": 0.282279908657074,
        "global_alignment_mastery_corr": 0.004819399966315056,
        "global_alignment_gain_corr": 0.027237776065109454,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0105180268782867,
          "constraint_total": -0.010518023421105591,
          "alignment": -0.04451775891540295,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01930310876335505,
        "min_mastery_variance": 0.014741717837750912,
        "max_mastery_variance": 0.025773372501134872,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.003202288790708535,
        "gain_correlation": 0.07569981791776537,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.17580552399158478,
        "alignment_corr_gain": 0.30294305086135864,
        "global_alignment_mastery_corr": -0.005701054753153585,
        "global_alignment_gain_corr": 0.023687197332910727,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0274970385292803,
          "constraint_total": -0.027497038451058303,
          "alignment": -0.0783414639686355,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01856478163248671,
        "min_mastery_variance": 0.014461512677371502,
        "max_mastery_variance": 0.02320651151239872,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.029105691118561084,
        "gain_correlation": 0.07073713980476592,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.19316606223583221,
        "alignment_corr_gain": 0.3284509479999542,
        "global_alignment_mastery_corr": 0.016469630199329306,
        "global_alignment_gain_corr": 0.029886672259757083,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0501524508979032,
          "constraint_total": -0.050152449379519626,
          "alignment": -0.11915836947626211,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.017956402365098965,
        "min_mastery_variance": 0.014323024079203606,
        "max_mastery_variance": 0.025204332545399666,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": -0.002624792251836801,
        "gain_correlation": 0.10379817264062083,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.17406031489372253,
        "alignment_corr_gain": 0.34843504428863525,
        "global_alignment_mastery_corr": -0.013148289533079756,
        "global_alignment_gain_corr": 0.03261000112218122,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0826743901967106,
          "constraint_total": -0.08267439312755373,
          "alignment": -0.17228815513994997,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01880540612872709,
        "min_mastery_variance": 0.014032645151019096,
        "max_mastery_variance": 0.024703796952962875,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": -3.746062700658228e-05,
        "gain_correlation": 0.12223540473216547,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.2129339873790741,
        "alignment_corr_gain": 0.3908662796020508,
        "global_alignment_mastery_corr": 0.002736356799820593,
        "global_alignment_gain_corr": 0.03238789752542895,
        "effective_alignment_weight": 0.13124999999999998,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.057762476066167,
          "constraint_total": -0.057762478665199866,
          "alignment": -0.1640563942780327,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01713699839738984,
        "min_mastery_variance": 0.014324271120131016,
        "max_mastery_variance": 0.02233368530869484,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.04207841387171002,
        "gain_correlation": 0.07915889012415785,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.20345459878444672,
        "alignment_corr_gain": 0.4385942816734314,
        "global_alignment_mastery_corr": 0.02820766217036483,
        "global_alignment_gain_corr": 0.033082762386329706,
        "effective_alignment_weight": 0.15312499999999998,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0950603733156576,
          "constraint_total": -0.09506037656184914,
          "alignment": -0.22735001841737226,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01670426109545126,
        "min_mastery_variance": 0.013876763172447681,
        "max_mastery_variance": 0.02126496657729149,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.04950498537794176,
        "gain_correlation": 0.04394479365389233,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.20887212455272675,
        "alignment_corr_gain": 0.4724525213241577,
        "global_alignment_mastery_corr": 0.0011733130622693958,
        "global_alignment_gain_corr": 0.039427222868155996,
        "effective_alignment_weight": 0.1902546368911862,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.1811018565845588,
          "constraint_total": -0.181101858969036,
          "alignment": -0.35211277630366866,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01593119996102826,
        "min_mastery_variance": 0.01269324030727148,
        "max_mastery_variance": 0.019740626215934753,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.04312325055641478,
        "gain_correlation": 0.09104024980258614,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.22179104387760162,
        "alignment_corr_gain": 0.563403308391571,
        "global_alignment_mastery_corr": 0.019328529743749337,
        "global_alignment_gain_corr": 0.049651560624673345,
        "effective_alignment_weight": 0.14642507662577553,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.136004861003939,
          "constraint_total": -0.1360048596159329,
          "alignment": -0.3117315015352942,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01575543656173148,
        "min_mastery_variance": 0.012978890910744667,
        "max_mastery_variance": 0.019861383363604546,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.010537081930257475,
        "gain_correlation": 0.09242657208619262,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.23726220428943634,
        "alignment_corr_gain": 0.6311516761779785,
        "global_alignment_mastery_corr": -0.003970019684832854,
        "global_alignment_gain_corr": 0.04769803271561007,
        "effective_alignment_weight": 0.13752902078256007,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.1682664948382444,
          "constraint_total": -0.16826649471573213,
          "alignment": -0.3697083215747184,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014826724971668708,
        "min_mastery_variance": 0.012640255503356457,
        "max_mastery_variance": 0.017256075516343117,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.0018504658207759604,
        "gain_correlation": 0.08943681127087781,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.24372361600399017,
        "alignment_corr_gain": 0.6511999368667603,
        "global_alignment_mastery_corr": 0.018438660333922597,
        "global_alignment_gain_corr": 0.049117540662215714,
        "effective_alignment_weight": 0.10426171669512985,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.09736778028437,
          "constraint_total": -0.09736777669787666,
          "alignment": -0.3037206872415045,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014442869751603183,
        "min_mastery_variance": 0.012584279291331768,
        "max_mastery_variance": 0.016374094411730766,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.0028595351284393077,
        "gain_correlation": 0.07777233367194278,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.22844156622886658,
        "alignment_corr_gain": 0.6752718091011047,
        "global_alignment_mastery_corr": -0.001071105924784206,
        "global_alignment_gain_corr": 0.026854614674230105,
        "effective_alignment_weight": 0.09657553975433109,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0901102952750281,
          "constraint_total": -0.09011028784152204,
          "alignment": -0.3112602365250027,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.013814217208310421,
        "min_mastery_variance": 0.012034938670694828,
        "max_mastery_variance": 0.015316017903387547,
        "per_lag_correlations": []
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 8,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 600,
      "use_residual_alignment": false,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": false,
      "retention_delta": 0.005,
      "retention_weight": 0.14,
      "enable_lag_gain_loss": false,
      "lag_gain_weight": 0.06,
      "lag_max_lag": 3,
      "lag_l1_weight": 0.5,
      "lag_l2_weight": 0.3,
      "lag_l3_weight": 0.2,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5,
      "alignment_share_cap": 0.08,
      "alignment_share_decay_factor": 0.7
    }
  },
  "timestamp": "2025-10-22T06:38:11.510290"
}