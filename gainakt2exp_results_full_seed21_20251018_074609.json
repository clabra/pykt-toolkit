{
  "experiment_name": "full_seed21",
  "best_val_auc": 0.7173455718456345,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.07661834731029034,
    "gain_correlation": 0.033919612999684955
  },
  "train_history": {
    "train_loss": [
      0.6345472400670225,
      0.5799796556561722,
      0.5796156794296028,
      0.5845325156814694,
      0.5753385208431303,
      0.5685381826032628,
      0.5586203745918571,
      0.5520701944210369,
      0.5427232115997551,
      0.5348670439398968,
      0.5330319396881242,
      0.5263147179635695
    ],
    "train_auc": [
      0.6190100732784573,
      0.6684910082387991,
      0.6742967199224021,
      0.6782448199996458,
      0.6839507672806667,
      0.683770777088433,
      0.6887640312570384,
      0.6887506521649687,
      0.7010957030864521,
      0.7108399666739863,
      0.7125223766201207,
      0.7179884943692284
    ],
    "val_auc": [
      0.6695313077312627,
      0.670938933984375,
      0.6797471056256533,
      0.6855151108732607,
      0.6874747459342301,
      0.6896666623169445,
      0.691540910804533,
      0.6927856219820201,
      0.7097467453819583,
      0.7111263925274709,
      0.7155147688560346,
      0.7173455718456345
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0715163017239669,
        "gain_correlation": -0.006863309946542558
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10579812473314697,
        "gain_correlation": -0.023697387087069473
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12919637168143286,
        "gain_correlation": -0.035737191021085905
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1478803138447512,
        "gain_correlation": -0.04227128778779842
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14370076316250185,
        "gain_correlation": -0.03611523344718205
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14972052221665955,
        "gain_correlation": -0.03929499707905324
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14378655333122312,
        "gain_correlation": -0.03407738864043209
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1446303714767187,
        "gain_correlation": -0.036060219537543084
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13410382923889613,
        "gain_correlation": -0.02906479097031837
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12603319090838352,
        "gain_correlation": -0.022938071060886925
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12572624178947045,
        "gain_correlation": -0.01140515652316863
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11898591588196758,
        "gain_correlation": -0.0022200328158488596
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.0715163017239669,
        "gain_correlation": -0.006863309946542558,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.0099558774381876,
        "alignment_corr_gain": 0.06434360146522522,
        "global_alignment_mastery_corr": 0.019003688912847184,
        "global_alignment_gain_corr": 0.05678823243419174,
        "effective_alignment_weight": 0.03125
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.10579812473314697,
        "gain_correlation": -0.023697387087069473,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.015029787085950375,
        "alignment_corr_gain": 0.13942508399486542,
        "global_alignment_mastery_corr": 0.03995774426017306,
        "global_alignment_gain_corr": 0.09997268149571027,
        "effective_alignment_weight": 0.0625
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.12919637168143286,
        "gain_correlation": -0.035737191021085905,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.017046621069312096,
        "alignment_corr_gain": 0.167851522564888,
        "global_alignment_mastery_corr": 0.05204866090876749,
        "global_alignment_gain_corr": 0.11195831739072067,
        "effective_alignment_weight": 0.09375
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.1478803138447512,
        "gain_correlation": -0.04227128778779842,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.021194832399487495,
        "alignment_corr_gain": 0.1779084950685501,
        "global_alignment_mastery_corr": 0.0649072137461917,
        "global_alignment_gain_corr": 0.11962465379775192,
        "effective_alignment_weight": 0.125
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.14370076316250185,
        "gain_correlation": -0.03611523344718205,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.019337940961122513,
        "alignment_corr_gain": 0.18001320958137512,
        "global_alignment_mastery_corr": 0.06120936247773898,
        "global_alignment_gain_corr": 0.12270028507414585,
        "effective_alignment_weight": 0.15625
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.14972052221665955,
        "gain_correlation": -0.03929499707905324,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.024270761758089066,
        "alignment_corr_gain": 0.1841398924589157,
        "global_alignment_mastery_corr": 0.06820764141072383,
        "global_alignment_gain_corr": 0.12419051764261288,
        "effective_alignment_weight": 0.1875
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.14378655333122312,
        "gain_correlation": -0.03407738864043209,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02198615111410618,
        "alignment_corr_gain": 0.19503620266914368,
        "global_alignment_mastery_corr": 0.06391968969051959,
        "global_alignment_gain_corr": 0.12886629943192626,
        "effective_alignment_weight": 0.21875
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.1446303714767187,
        "gain_correlation": -0.036060219537543084,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0270872563123703,
        "alignment_corr_gain": 0.1907297968864441,
        "global_alignment_mastery_corr": 0.06780596155841825,
        "global_alignment_gain_corr": 0.12956820140350223,
        "effective_alignment_weight": 0.25
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.13410382923889613,
        "gain_correlation": -0.02906479097031837,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025892330333590508,
        "alignment_corr_gain": 0.20506666600704193,
        "global_alignment_mastery_corr": 0.061579084285892045,
        "global_alignment_gain_corr": 0.13061840324099952,
        "effective_alignment_weight": 0.25
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.12603319090838352,
        "gain_correlation": -0.022938071060886925,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025001639500260353,
        "alignment_corr_gain": 0.20567777752876282,
        "global_alignment_mastery_corr": 0.056705551530467344,
        "global_alignment_gain_corr": 0.13180029333530305,
        "effective_alignment_weight": 0.25
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.12572624178947045,
        "gain_correlation": -0.01140515652316863,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.028547393158078194,
        "alignment_corr_gain": 0.21993036568164825,
        "global_alignment_mastery_corr": 0.05930340596501386,
        "global_alignment_gain_corr": 0.13410199836983036,
        "effective_alignment_weight": 0.25
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.11898591588196758,
        "gain_correlation": -0.0022200328158488596,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025446034967899323,
        "alignment_corr_gain": 0.22511477768421173,
        "global_alignment_mastery_corr": 0.05365346321241911,
        "global_alignment_gain_corr": 0.13271479016422139,
        "effective_alignment_weight": 0.25
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 8,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 300,
      "use_residual_alignment": true,
      "alignment_residual_window": 5
    }
  },
  "timestamp": "2025-10-18T07:46:09.165855"
}