{
  "experiment_name": "full_seed21",
  "best_val_auc": 0.7192513533559568,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.0740536458959149,
    "gain_correlation": 0.043223545818303025
  },
  "train_history": {
    "train_loss": [
      0.6197235411312914,
      0.5656240746147274,
      0.5635258604825469,
      0.562190042876209,
      0.5560991059930831,
      0.5533255323227205,
      0.5420121403864628,
      0.5358150145859298,
      0.5348588211239929,
      0.5288286181311533,
      0.5272585040855902,
      0.521262809865833
    ],
    "train_auc": [
      0.6308066848219037,
      0.6734297523371917,
      0.6779390211894676,
      0.6821242803208272,
      0.6876212474291082,
      0.6903639884299205,
      0.7048724060014172,
      0.7114975068662494,
      0.7118989922696322,
      0.7167640867350956,
      0.717366169292835,
      0.7210737377813348
    ],
    "val_auc": [
      0.6731169502215084,
      0.6791378718630073,
      0.6840220226778553,
      0.6884674623860237,
      0.6907828310761354,
      0.7023126623057819,
      0.7110930045920703,
      0.7136456321540645,
      0.7140375295605615,
      0.71676137435477,
      0.7163812881927343,
      0.7192513533559568
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.07315751725218314,
        "gain_correlation": 0.05396543874212248
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1146130656571173,
        "gain_correlation": -0.0036004258101060105
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13856378460444807,
        "gain_correlation": -0.026963441945801945
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14632138134549033,
        "gain_correlation": -0.030561241936393417
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14125267863363497,
        "gain_correlation": -0.02130621585137848
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13664475338521834,
        "gain_correlation": -0.010456742894554547
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13128613332001055,
        "gain_correlation": -0.002031849097657525
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.123132256079813,
        "gain_correlation": -0.004297899758209165
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12197275030174938,
        "gain_correlation": 0.003913261001961249
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11648776234106809,
        "gain_correlation": 0.01330872249206701
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11759950188189507,
        "gain_correlation": 0.019960404196731448
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11521864991446948,
        "gain_correlation": 0.030976055530574947
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.07315751725218314,
        "gain_correlation": 0.05396543874212248,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.010599411092698574,
        "alignment_corr_gain": 0.054512277245521545,
        "global_alignment_mastery_corr": 0.018446759983304827,
        "global_alignment_gain_corr": 0.05642628096218687,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.018446759983304827,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.1146130656571173,
        "gain_correlation": -0.0036004258101060105,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.014304887503385544,
        "alignment_corr_gain": 0.15459752082824707,
        "global_alignment_mastery_corr": 0.04211448593855797,
        "global_alignment_gain_corr": 0.10107107196255431,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.04211448593855797,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.13856378460444807,
        "gain_correlation": -0.026963441945801945,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.020263366401195526,
        "alignment_corr_gain": 0.18031103909015656,
        "global_alignment_mastery_corr": 0.05657322724019953,
        "global_alignment_gain_corr": 0.1153959849558305,
        "effective_alignment_weight": 0.1875,
        "peak_mastery_corr": 0.05657322724019953,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.14632138134549033,
        "gain_correlation": -0.030561241936393417,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.027449877932667732,
        "alignment_corr_gain": 0.18895454704761505,
        "global_alignment_mastery_corr": 0.06492759267887474,
        "global_alignment_gain_corr": 0.12310540518801039,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.14125267863363497,
        "gain_correlation": -0.02130621585137848,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.024568870663642883,
        "alignment_corr_gain": 0.1980341523885727,
        "global_alignment_mastery_corr": 0.06078192607625776,
        "global_alignment_gain_corr": 0.12521621700065833,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.13664475338521834,
        "gain_correlation": -0.010456742894554547,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02683192305266857,
        "alignment_corr_gain": 0.1827116161584854,
        "global_alignment_mastery_corr": 0.06104365160726502,
        "global_alignment_gain_corr": 0.11955677217260624,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.13128613332001055,
        "gain_correlation": -0.002031849097657525,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.027596808969974518,
        "alignment_corr_gain": 0.2016417235136032,
        "global_alignment_mastery_corr": 0.05819844466537082,
        "global_alignment_gain_corr": 0.1261202100941591,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.123132256079813,
        "gain_correlation": -0.004297899758209165,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.023882608860731125,
        "alignment_corr_gain": 0.2074032425880432,
        "global_alignment_mastery_corr": 0.05176317293672279,
        "global_alignment_gain_corr": 0.12238349564092156,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0003164419742151948,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.12197275030174938,
        "gain_correlation": 0.003913261001961249,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.030629664659500122,
        "alignment_corr_gain": 0.21026456356048584,
        "global_alignment_mastery_corr": 0.0558843571091226,
        "global_alignment_gain_corr": 0.12528154171071948,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.11648776234106809,
        "gain_correlation": 0.01330872249206701,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.028221990913152695,
        "alignment_corr_gain": 0.22044533491134644,
        "global_alignment_mastery_corr": 0.052387317573496454,
        "global_alignment_gain_corr": 0.12427493511854361,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0002540275105378286,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.11759950188189507,
        "gain_correlation": 0.019960404196731448,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.036357950419187546,
        "alignment_corr_gain": 0.21584229171276093,
        "global_alignment_mastery_corr": 0.06018621711817104,
        "global_alignment_gain_corr": 0.128303917759816,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.11521864991446948,
        "gain_correlation": 0.030976055530574947,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0381537564098835,
        "alignment_corr_gain": 0.23670285940170288,
        "global_alignment_mastery_corr": 0.05961431788300009,
        "global_alignment_gain_corr": 0.12837402334727813,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06492759267887474,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 4,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 300,
      "use_residual_alignment": true,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": true,
      "retention_delta": 0.01,
      "retention_weight": 0.1,
      "enable_lag_gain_loss": true,
      "lag_gain_weight": 0.05,
      "lag_max_lag": 3,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5
    }
  },
  "timestamp": "2025-10-18T08:34:19.267899"
}