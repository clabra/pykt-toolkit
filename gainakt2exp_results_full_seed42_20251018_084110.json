{
  "experiment_name": "full_seed42",
  "best_val_auc": 0.7176007180263242,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.06762713322479724,
    "gain_correlation": 0.047802055560648135
  },
  "train_history": {
    "train_loss": [
      0.6325656456650848,
      0.5660862598394483,
      0.5633211870885266,
      0.5630728549907862,
      0.5569489721807174,
      0.5545368622312892,
      0.552437067649525,
      0.5422637810052368,
      0.537556913850221,
      0.5319576297399293,
      0.5259283276110733,
      0.5242113826188399
    ],
    "train_auc": [
      0.6209126132758387,
      0.6725543296832569,
      0.6775474690370682,
      0.6816160175538285,
      0.6867943319440428,
      0.6891263583232352,
      0.6918069231539881,
      0.7048413875744599,
      0.7096477266168261,
      0.7143153438276719,
      0.719212104114637,
      0.719573472029191
    ],
    "val_auc": [
      0.6706324504909622,
      0.6783836342249954,
      0.6834643055369781,
      0.6865328461092777,
      0.6897900052655282,
      0.6907860638113307,
      0.7032521229858477,
      0.7104642121041576,
      0.7121824641851979,
      0.7159487691594117,
      0.7176007180263242,
      0.715604648254002
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.07326142103762501,
        "gain_correlation": 0.040762545523592104
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11451282931737546,
        "gain_correlation": 0.0020867431148115104
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13843059955776915,
        "gain_correlation": -0.017043080908583894
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1465959118230902,
        "gain_correlation": -0.023539987071140474
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14294204199907054,
        "gain_correlation": -0.011976370469836845
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13724024617226505,
        "gain_correlation": -0.005869438954125944
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1348161503276247,
        "gain_correlation": 0.006881983812613533
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12668757632879288,
        "gain_correlation": 0.009175074559332934
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12381206924621545,
        "gain_correlation": 0.028541410265592433
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1170620958883555,
        "gain_correlation": 0.03765820503595555
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11313419199726338,
        "gain_correlation": 0.04872563927566369
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.10927468878382911,
        "gain_correlation": 0.04219317391569281
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.07326142103762501,
        "gain_correlation": 0.040762545523592104,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.00990402139723301,
        "alignment_corr_gain": 0.07234232872724533,
        "global_alignment_mastery_corr": 0.018076681310876665,
        "global_alignment_gain_corr": 0.053042366632726046,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.018076681310876665,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.11451282931737546,
        "gain_correlation": 0.0020867431148115104,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.014057226479053497,
        "alignment_corr_gain": 0.16512344777584076,
        "global_alignment_mastery_corr": 0.042958249712961936,
        "global_alignment_gain_corr": 0.11068704834304906,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.042958249712961936,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.13843059955776915,
        "gain_correlation": -0.017043080908583894,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.01991313323378563,
        "alignment_corr_gain": 0.1809716522693634,
        "global_alignment_mastery_corr": 0.05723613777644156,
        "global_alignment_gain_corr": 0.12404685524783417,
        "effective_alignment_weight": 0.1875,
        "peak_mastery_corr": 0.05723613777644156,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.1465959118230902,
        "gain_correlation": -0.023539987071140474,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.026696253567934036,
        "alignment_corr_gain": 0.18465469777584076,
        "global_alignment_mastery_corr": 0.06452279015798315,
        "global_alignment_gain_corr": 0.12720254425968355,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.14294204199907054,
        "gain_correlation": -0.011976370469836845,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025363950058817863,
        "alignment_corr_gain": 0.191089928150177,
        "global_alignment_mastery_corr": 0.062251851129355294,
        "global_alignment_gain_corr": 0.1301792536644886,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.13724024617226505,
        "gain_correlation": -0.005869438954125944,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0226103737950325,
        "alignment_corr_gain": 0.19911201298236847,
        "global_alignment_mastery_corr": 0.057418607690002926,
        "global_alignment_gain_corr": 0.13062742273631253,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.1348161503276247,
        "gain_correlation": 0.006881983812613533,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025143742561340332,
        "alignment_corr_gain": 0.18412932753562927,
        "global_alignment_mastery_corr": 0.0563005199728362,
        "global_alignment_gain_corr": 0.12371403801992226,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.12668757632879288,
        "gain_correlation": 0.009175074559332934,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02518349513411522,
        "alignment_corr_gain": 0.19987449049949646,
        "global_alignment_mastery_corr": 0.05373791371098681,
        "global_alignment_gain_corr": 0.1279016562079778,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 7.848764469963414e-05,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.12381206924621545,
        "gain_correlation": 0.028541410265592433,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.029375828802585602,
        "alignment_corr_gain": 0.19394312798976898,
        "global_alignment_mastery_corr": 0.05452032256507664,
        "global_alignment_gain_corr": 0.1315268375951564,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 2.4675929065094e-07,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.1170620958883555,
        "gain_correlation": 0.03765820503595555,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.030222689732909203,
        "alignment_corr_gain": 0.20724929869174957,
        "global_alignment_mastery_corr": 0.05305863664485514,
        "global_alignment_gain_corr": 0.1300982506107539,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.00014641535131280098,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.11313419199726338,
        "gain_correlation": 0.04872563927566369,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02748734876513481,
        "alignment_corr_gain": 0.2152245193719864,
        "global_alignment_mastery_corr": 0.04831106918398291,
        "global_alignment_gain_corr": 0.12671748067834415,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.000621172097400024,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.10927468878382911,
        "gain_correlation": 0.04219317391569281,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.0323299877345562,
        "alignment_corr_gain": 0.2001398801803589,
        "global_alignment_mastery_corr": 0.05110645303381413,
        "global_alignment_gain_corr": 0.12743236850753117,
        "effective_alignment_weight": 0.2516889303922653,
        "peak_mastery_corr": 0.06452279015798315,
        "retention_loss_value": 0.00034163371241690226,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 4,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 300,
      "use_residual_alignment": true,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": true,
      "retention_delta": 0.01,
      "retention_weight": 0.1,
      "enable_lag_gain_loss": true,
      "lag_gain_weight": 0.05,
      "lag_max_lag": 3,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5
    }
  },
  "timestamp": "2025-10-18T08:41:10.203111"
}