{
  "experiment_name": "full_seed63",
  "best_val_auc": 0.7191079176958279,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.06888996068011335,
    "gain_correlation": 0.04481444227745068
  },
  "train_history": {
    "train_loss": [
      0.6232507831074413,
      0.5657776946230874,
      0.5622318666524838,
      0.5620845460521124,
      0.556297998354225,
      0.5548622146480442,
      0.5444826740057357,
      0.5367870702953537,
      0.5354765188817533,
      0.5282261878097613,
      0.5264637802240144,
      0.521119841022195
    ],
    "train_auc": [
      0.6265272179288279,
      0.6728174956502764,
      0.6786923040768169,
      0.6818231458987202,
      0.6868837173150297,
      0.68753118798872,
      0.7009794091218278,
      0.7098898483516599,
      0.7106379175747033,
      0.7166901344201649,
      0.7172759292961265,
      0.7209454406109405
    ],
    "val_auc": [
      0.6714433675212136,
      0.6751040139014559,
      0.6826123225481455,
      0.6867551624786009,
      0.6895012312496986,
      0.6929740213557368,
      0.7080847749127888,
      0.7119788129515575,
      0.7139679416411717,
      0.7166325922830383,
      0.7162282242772517,
      0.7191079176958279
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.07649784770844303,
        "gain_correlation": 0.0677436002410453
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11660771305278622,
        "gain_correlation": -0.001110823735639925
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13363229754151495,
        "gain_correlation": -0.014659829569003243
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14294891779939164,
        "gain_correlation": -0.02039018636429114
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1371458468401948,
        "gain_correlation": -0.017300775164767544
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13679975329878968,
        "gain_correlation": -0.007399660014909514
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12697764268875208,
        "gain_correlation": -0.0002726004448744226
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12003080688698795,
        "gain_correlation": 0.008206279346905196
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1191221367813417,
        "gain_correlation": 0.013928347978243735
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11388772203657216,
        "gain_correlation": 0.025041665192422968
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11114409033076864,
        "gain_correlation": 0.030697339407084828
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.11089212638886299,
        "gain_correlation": 0.03143722560535025
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.07649784770844303,
        "gain_correlation": 0.0677436002410453,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.010576263070106506,
        "alignment_corr_gain": 0.049691811203956604,
        "global_alignment_mastery_corr": 0.01720239485906859,
        "global_alignment_gain_corr": 0.047039121924948024,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.01720239485906859,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.11660771305278622,
        "gain_correlation": -0.001110823735639925,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.015666084364056587,
        "alignment_corr_gain": 0.1483047902584076,
        "global_alignment_mastery_corr": 0.04333858473333142,
        "global_alignment_gain_corr": 0.10621253597938145,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.04333858473333142,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.13363229754151495,
        "gain_correlation": -0.014659829569003243,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.018933888524770737,
        "alignment_corr_gain": 0.17416247725486755,
        "global_alignment_mastery_corr": 0.054688968792009594,
        "global_alignment_gain_corr": 0.12090555964891489,
        "effective_alignment_weight": 0.1875,
        "peak_mastery_corr": 0.054688968792009594,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.14294891779939164,
        "gain_correlation": -0.02039018636429114,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025241263210773468,
        "alignment_corr_gain": 0.18604618310928345,
        "global_alignment_mastery_corr": 0.06359979689160052,
        "global_alignment_gain_corr": 0.1277589625920033,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.1371458468401948,
        "gain_correlation": -0.017300775164767544,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.022516367956995964,
        "alignment_corr_gain": 0.19789180159568787,
        "global_alignment_mastery_corr": 0.05836691552870131,
        "global_alignment_gain_corr": 0.12866224299417808,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.13679975329878968,
        "gain_correlation": -0.007399660014909514,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.025847535580396652,
        "alignment_corr_gain": 0.194556325674057,
        "global_alignment_mastery_corr": 0.060453403887028495,
        "global_alignment_gain_corr": 0.12576046265008092,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.12697764268875208,
        "gain_correlation": -0.0002726004448744226,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02506687305867672,
        "alignment_corr_gain": 0.19716309010982513,
        "global_alignment_mastery_corr": 0.05473208729119506,
        "global_alignment_gain_corr": 0.1255704619931445,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.12003080688698795,
        "gain_correlation": 0.008206279346905196,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.022203829139471054,
        "alignment_corr_gain": 0.2104388177394867,
        "global_alignment_mastery_corr": 0.0497493842534944,
        "global_alignment_gain_corr": 0.12521386530871192,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0003850412638106116,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.1191221367813417,
        "gain_correlation": 0.013928347978243735,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02792000025510788,
        "alignment_corr_gain": 0.2075192630290985,
        "global_alignment_mastery_corr": 0.052224338889015294,
        "global_alignment_gain_corr": 0.1291157538773647,
        "effective_alignment_weight": 0.25025061443448066,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.00013754580025852217,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.11388772203657216,
        "gain_correlation": 0.025041665192422968,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02590031921863556,
        "alignment_corr_gain": 0.2238573282957077,
        "global_alignment_mastery_corr": 0.04827096632196723,
        "global_alignment_gain_corr": 0.12812350889202206,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0005328830569633286,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.11114409033076864,
        "gain_correlation": 0.030697339407084828,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.035135138779878616,
        "alignment_corr_gain": 0.2135373055934906,
        "global_alignment_mastery_corr": 0.052498199701464424,
        "global_alignment_gain_corr": 0.1295321462629363,
        "effective_alignment_weight": 0.25172903314232825,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 0.0001101597190136092,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.11089212638886299,
        "gain_correlation": 0.03143722560535025,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.03610885143280029,
        "alignment_corr_gain": 0.23971068859100342,
        "global_alignment_mastery_corr": 0.05303568877735718,
        "global_alignment_gain_corr": 0.12953575752209873,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.06359979689160052,
        "retention_loss_value": 5.641081142433325e-05,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 4,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 300,
      "use_residual_alignment": true,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": true,
      "retention_delta": 0.01,
      "retention_weight": 0.1,
      "enable_lag_gain_loss": true,
      "lag_gain_weight": 0.05,
      "lag_max_lag": 3,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5
    }
  },
  "timestamp": "2025-10-18T08:48:04.570705"
}