{
  "experiment_name": "full_seed84",
  "best_val_auc": 0.7172437856373957,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": 0.07703848436632639,
    "gain_correlation": 0.038716287402337075
  },
  "train_history": {
    "train_loss": [
      0.6173336441035098,
      0.5556895589272592,
      0.5498921542278843,
      0.5495988093509575,
      0.5498546116401495,
      0.5481101246695445,
      0.5493823662014206,
      0.5434583718912589,
      0.5499519217817277,
      0.5477832623713993,
      0.5428029019289066,
      0.5403466950426448
    ],
    "train_auc": [
      0.6144385785195106,
      0.6730190312797333,
      0.6805829152475267,
      0.6851530390881894,
      0.6855542749475795,
      0.6900797193202111,
      0.6895889030669909,
      0.6995667323513614,
      0.7096630392831841,
      0.7125502078250809,
      0.717555072994377,
      0.7193106844499574
    ],
    "val_auc": [
      0.669292678918568,
      0.6776075127554124,
      0.6864171942379669,
      0.6843399656941402,
      0.6902863198956819,
      0.6920584299608352,
      0.6927848857804583,
      0.7069690283180263,
      0.712404385729796,
      0.71421079332967,
      0.7172437856373957,
      0.7165042574987055
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.08055870409024161,
        "gain_correlation": 0.01844997768031611
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12145181162916763,
        "gain_correlation": -0.037952257374912396
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1437839117500529,
        "gain_correlation": -0.035734344783717564
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14118828351140938,
        "gain_correlation": -0.04224905346611796
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.15055864682834866,
        "gain_correlation": -0.0340631464369776
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14573389662040565,
        "gain_correlation": -0.02358786923348801
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14883030188930454,
        "gain_correlation": -0.014333327881516566
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.14231044837772291,
        "gain_correlation": -0.002373588697496592
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13313679209269785,
        "gain_correlation": 0.0026092806721179523
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.13128278650222436,
        "gain_correlation": 0.01526385409144678
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.12462701389155054,
        "gain_correlation": 0.03241755532834498
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.1216944255687502,
        "gain_correlation": 0.03205393328933423
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": 0.08055870409024161,
        "gain_correlation": 0.01844997768031611,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.0082876430824399,
        "alignment_corr_gain": 0.09042084217071533,
        "global_alignment_mastery_corr": 0.06308637472238236,
        "global_alignment_gain_corr": 0.034376954727680036,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.06308637472238236,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9211607561258638,
          "constraint_total": 0.07883924796690606,
          "alignment": -0.001001306610267585,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.030256755611439444,
        "min_mastery_variance": 0.0188140869140625,
        "max_mastery_variance": 0.03582763671875,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": 0.12145181162916763,
        "gain_correlation": -0.037952257374912396,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.013901179656386375,
        "alignment_corr_gain": 0.1569175273180008,
        "global_alignment_mastery_corr": 0.09040791842261872,
        "global_alignment_gain_corr": 0.009759246581961634,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.09040791842261872,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9746940616169437,
          "constraint_total": 0.02530593765578687,
          "alignment": -0.014537499448758347,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.019223820977878076,
        "min_mastery_variance": 0.01543426513671875,
        "max_mastery_variance": 0.029266357421875,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.1437839117500529,
        "gain_correlation": -0.035734344783717564,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.01667811907827854,
        "alignment_corr_gain": 0.17741428315639496,
        "global_alignment_mastery_corr": 0.10099483238018972,
        "global_alignment_gain_corr": 0.002280072450133351,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.10099483238018972,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.978875534821528,
          "constraint_total": 0.021124466073559507,
          "alignment": -0.026279073410337597,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014211387831930052,
        "min_mastery_variance": 0.01293182373046875,
        "max_mastery_variance": 0.016693115234375,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.14118828351140938,
        "gain_correlation": -0.04224905346611796,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.017979741096496582,
        "alignment_corr_gain": 0.17313918471336365,
        "global_alignment_mastery_corr": 0.10966187333877314,
        "global_alignment_gain_corr": 0.010746831917592015,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.10966187333877314,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.97575213909211,
          "constraint_total": 0.024247859555762058,
          "alignment": -0.03726124980866653,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.013707017651493686,
        "min_mastery_variance": 0.01264190673828125,
        "max_mastery_variance": 0.0145263671875,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.15055864682834866,
        "gain_correlation": -0.0340631464369776,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.021969951689243317,
        "alignment_corr_gain": 0.18692882359027863,
        "global_alignment_mastery_corr": 0.09463904251611893,
        "global_alignment_gain_corr": -9.0339446226911e-05,
        "effective_alignment_weight": 0.15625,
        "peak_mastery_corr": 0.10966187333877314,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9746380714319856,
          "constraint_total": 0.02536192856801433,
          "alignment": -0.0477768323127338,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.012282060217980895,
        "min_mastery_variance": 0.01153564453125,
        "max_mastery_variance": 0.0132904052734375,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.14573389662040565,
        "gain_correlation": -0.02358786923348801,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.020598450675606728,
        "alignment_corr_gain": 0.19553512334823608,
        "global_alignment_mastery_corr": 0.0988901884071917,
        "global_alignment_gain_corr": 0.01857987884740093,
        "effective_alignment_weight": 0.1875,
        "peak_mastery_corr": 0.10966187333877314,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.973799480157805,
          "constraint_total": 0.026200523134852723,
          "alignment": -0.0610065248457997,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01205385040125081,
        "min_mastery_variance": 0.01140594482421875,
        "max_mastery_variance": 0.0125274658203125,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.14883030188930454,
        "gain_correlation": -0.014333327881516566,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.024820955470204353,
        "alignment_corr_gain": 0.19550305604934692,
        "global_alignment_mastery_corr": 0.12187077997931435,
        "global_alignment_gain_corr": 0.018750063625326826,
        "effective_alignment_weight": 0.21875,
        "peak_mastery_corr": 0.12187077997931435,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9717843319120985,
          "constraint_total": 0.028215669651366265,
          "alignment": -0.07180887704111394,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01151524677177785,
        "min_mastery_variance": 0.01096343994140625,
        "max_mastery_variance": 0.0125274658203125,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.14231044837772291,
        "gain_correlation": -0.002373588697496592,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.024954304099082947,
        "alignment_corr_gain": 0.20423561334609985,
        "global_alignment_mastery_corr": 0.09470487885756787,
        "global_alignment_gain_corr": 0.0073336768841060496,
        "effective_alignment_weight": 0.25,
        "peak_mastery_corr": 0.12187077997931435,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9731177034425704,
          "constraint_total": 0.026882300411026436,
          "alignment": -0.08773057319208154,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011276126525562662,
        "min_mastery_variance": 0.01081085205078125,
        "max_mastery_variance": 0.01161956787109375,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.13313679209269785,
        "gain_correlation": 0.0026092806721179523,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02142910473048687,
        "alignment_corr_gain": 0.21577070653438568,
        "global_alignment_mastery_corr": 0.10994226556739402,
        "global_alignment_gain_corr": 0.02188790899080535,
        "effective_alignment_weight": 0.175,
        "peak_mastery_corr": 0.12187077997931435,
        "retention_loss_value": 0.0009699920176688466,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9511907744209248,
          "constraint_total": 0.04880922377154604,
          "alignment": -0.06416140229256112,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.011197500278295013,
        "min_mastery_variance": 0.01062774658203125,
        "max_mastery_variance": 0.0115814208984375,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.13128278650222436,
        "gain_correlation": 0.01526385409144678,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.02357281558215618,
        "alignment_corr_gain": 0.2090914398431778,
        "global_alignment_mastery_corr": 0.10497463775769575,
        "global_alignment_gain_corr": 0.031592781739260924,
        "effective_alignment_weight": 0.175,
        "peak_mastery_corr": 0.12187077997931435,
        "retention_loss_value": 0.0016654599110266042,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9516605750601707,
          "constraint_total": 0.048330278116274064,
          "alignment": -0.06456368090871668,
          "lag": 0.0,
          "retention": 9.174916054395415e-06
        },
        "mean_mastery_variance": 0.010968539381274288,
        "min_mastery_variance": 0.010528564453125,
        "max_mastery_variance": 0.01151275634765625,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.12462701389155054,
        "gain_correlation": 0.03241755532834498,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.022574402391910553,
        "alignment_corr_gain": 0.2283085435628891,
        "global_alignment_mastery_corr": 0.10341112380488388,
        "global_alignment_gain_corr": 0.046069346313743154,
        "effective_alignment_weight": 0.175,
        "peak_mastery_corr": 0.12187077997931435,
        "retention_loss_value": 0.0018843518644202665,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9550214229951614,
          "constraint_total": 0.044962649810106066,
          "alignment": -0.06783646182417472,
          "lag": -0.0007764503563659892,
          "retention": 1.5897714838154355e-05
        },
        "mean_mastery_variance": 0.010804487633581605,
        "min_mastery_variance": 0.0104217529296875,
        "max_mastery_variance": 0.0110931396484375,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": -0.09379337728023529,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.10513469576835632,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.024043280631303787,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.042531244456768036,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.019076038151979446,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0049468656070530415,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04105784371495247,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04277421534061432,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012190264649689198,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09863405674695969,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02828080579638481,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.038701582700014114,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1858728528022766,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.14799240231513977,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06920958310365677,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0036386647261679173,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.027467695996165276,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.030959295108914375,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.02499440684914589,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.048936352133750916,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04386301338672638,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04435688629746437,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03328286483883858,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09987416118383408,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0782761424779892,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03985854238271713,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.026974279433488846,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06423819065093994,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.12109401822090149,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.026521306484937668,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04816669225692749,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.026116417720913887,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.020722394809126854,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05991261452436447,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.050319187343120575,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11263052374124527,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.11713588237762451,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0030198609456419945,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.002514446387067437,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.028511567041277885,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.031940024346113205,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.011451641097664833,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09151922166347504,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11226136982440948,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.029249783605337143,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0031671258620917797,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10792612284421921,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03477571904659271,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.02451242320239544,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.006864796858280897,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0753173679113388,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.15102341771125793,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.027528289705514908,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05287854000926018,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10166468471288681,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.038797248154878616,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03119216486811638,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.031020833179354668,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04800637066364288,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.00544246518984437,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1036163866519928,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.038674648851156235,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.012976737692952156,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.013917697593569756,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.013160950504243374,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0171704962849617,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.12672898173332214,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0012724221451207995,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03890856355428696,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0322616808116436,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.00471528060734272,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06768301874399185,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.06984388083219528,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09287341684103012,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07018470019102097,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06813829392194748,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08259856700897217,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1717546135187149,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06939697265625,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.014927842654287815,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.19600901007652283,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.15372423827648163,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06096541881561279,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06027153506875038,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08505286276340485,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1379835158586502,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.025060253217816353,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.13407683372497559,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0005065221339464188,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.021934879943728447,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.13853336870670319,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0427519790828228,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06411343067884445,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02512136660516262,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06616737693548203,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09551706165075302,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.019090784713625908,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08828364312648773,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.004831360187381506,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.043766655027866364,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.16942062973976135,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03226938471198082,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.00921323150396347,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11985407024621964,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12145642191171646,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.011193878948688507,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09204686433076859,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.016115562990307808,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.046571407467126846,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0849604457616806,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1573704034090042,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.08484306186437607,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.13505853712558746,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.037155814468860626,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1231892928481102,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.039556246250867844,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.019399838522076607,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.21443288028240204,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07405779510736465,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1436951458454132,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.059760987758636475,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06380476802587509,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.2245897799730301,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.12885943055152893,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08991894870996475,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03863617777824402,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.03685979172587395,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09656014293432236,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.03916166350245476,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.005596162285655737,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.01154313888400793,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.02765500545501709,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008537783287465572,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.049086011946201324,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0038561122491955757,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.09868401288986206,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.002812804887071252,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18087700009346008,
            "weight": 0.3
          }
        ]
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.1216944255687502,
        "gain_correlation": 0.03205393328933423,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.027248935773968697,
        "alignment_corr_gain": 0.22406011819839478,
        "global_alignment_mastery_corr": 0.07945614157268817,
        "global_alignment_gain_corr": 0.04057121723366436,
        "effective_alignment_weight": 0.175,
        "peak_mastery_corr": 0.12187077997931435,
        "retention_loss_value": 0.005238049376927666,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.957458105574412,
          "constraint_total": 0.042523802317091984,
          "alignment": -0.07017839620997288,
          "lag": -0.0012632173294240378,
          "retention": 1.8068919810712728e-05
        },
        "mean_mastery_variance": 0.010754560559524774,
        "min_mastery_variance": 0.01042938232421875,
        "max_mastery_variance": 0.0110626220703125,
        "per_lag_correlations": [
          {
            "lag": 1,
            "corr": -0.08059486001729965,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07539509236812592,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.020226124674081802,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04099052771925926,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.041941527277231216,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06021090969443321,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0316072516143322,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.043624334037303925,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.09523802995681763,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.17091134190559387,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05800645425915718,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.013284682296216488,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1336897760629654,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10291974246501923,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07583184540271759,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0026036426424980164,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.01855434663593769,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.028725573793053627,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.015881314873695374,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.05271316319704056,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.07562968134880066,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08148545026779175,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.009088498540222645,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1002713143825531,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07514017820358276,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0364384725689888,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05301068350672722,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08224211633205414,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.10321632027626038,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.03581560403108597,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.048224370926618576,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.015182862989604473,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.007956893183290958,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.07034604996442795,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.016872934997081757,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11551911383867264,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1333702951669693,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.017018767073750496,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.018060605973005295,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.031052742153406143,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.029699159786105156,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.01782807894051075,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08842635899782181,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11000606417655945,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.054045263677835464,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0081768948584795,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.12990814447402954,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06644798815250397,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.01120295375585556,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.0013933293521404266,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08541876822710037,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.148597851395607,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.021416615694761276,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08052967488765717,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10819032043218613,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05315349996089935,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.10104890167713165,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07364655286073685,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06490453332662582,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.022469673305749893,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09147249907255173,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.03164045140147209,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.041336946189403534,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.009455231949687004,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05979372188448906,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0058905137702822685,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0856679305434227,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04512455314397812,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0710836797952652,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.005809142719954252,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.004834440536797047,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.06744856387376785,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.060329388827085495,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.08173345774412155,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14756621420383453,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1073577031493187,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1248803660273552,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.18471965193748474,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1410323977470398,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.053769223392009735,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.2269379198551178,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1990250051021576,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.057720135897397995,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.06596799194812775,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0687582939863205,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1194739118218422,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.04345634579658508,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1423729956150055,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0024177792947739363,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.007307364605367184,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.1325615644454956,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04763725772500038,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.06624539196491241,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.0473005436360836,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08708221465349197,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.07199744135141373,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.0290614515542984,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.10944497585296631,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.014821273274719715,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04258377477526665,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.16781601309776306,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.029122332111001015,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.008635584264993668,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.11355376988649368,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.14101220667362213,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.013274864293634892,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.1281701624393463,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.053125783801078796,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0019036128651350737,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.04792022705078125,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.14163030683994293,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.09293954819440842,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.11687550693750381,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.039265234023332596,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.09910167753696442,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.053560592234134674,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.019413474947214127,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.20765726268291473,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.08831505477428436,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.1579907238483429,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.08042068779468536,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05622489005327225,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.2176504284143448,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": -0.11923900246620178,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.07539024949073792,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.04413381591439247,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.05569615215063095,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.1100645661354065,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.04382330924272537,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.023227423429489136,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": -0.009003665298223495,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.05212337523698807,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.030499955639243126,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.052897755056619644,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.0369131900370121,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.12493723630905151,
            "weight": 0.3
          },
          {
            "lag": 1,
            "corr": 0.029692910611629486,
            "weight": 0.5
          },
          {
            "lag": 2,
            "corr": 0.21006536483764648,
            "weight": 0.3
          }
        ]
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 8,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 600,
      "use_residual_alignment": true,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": true,
      "retention_delta": 0.005,
      "retention_weight": 0.14,
      "enable_lag_gain_loss": true,
      "lag_gain_weight": 0.06,
      "lag_max_lag": 3,
      "lag_l1_weight": 0.5,
      "lag_l2_weight": 0.3,
      "lag_l3_weight": 0.2,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5,
      "alignment_share_cap": 0.08,
      "alignment_share_decay_factor": 0.7
    }
  },
  "timestamp": "2025-10-21T23:33:09.675341"
}