{
  "experiment_name": "phase3semantic_global_seed105",
  "best_val_auc": 0.7242818055737144,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": -0.020489359897554214,
    "gain_correlation": 0.06239093535846921
  },
  "train_history": {
    "train_loss": [
      0.5378995414224931,
      0.5091968873621886,
      0.4936881581118687,
      0.47464251549132747,
      0.4713566085526363,
      0.4460670188300968,
      0.439449238035963,
      0.3902015857437114,
      0.35769348649472155,
      0.33512411787719926,
      0.29809228064482696,
      0.29285706355781754
    ],
    "train_auc": [
      0.6922592199257895,
      0.7237965007821011,
      0.7353422707493353,
      0.7467854282860839,
      0.7620434908025319,
      0.7803844204811957,
      0.8041834770250953,
      0.828648787307935,
      0.8532489205743911,
      0.889296769306172,
      0.9111188956043539,
      0.9259922840308736
    ],
    "val_auc": [
      0.7161527721146417,
      0.7232778382182266,
      0.7242818055737144,
      0.720713261974343,
      0.7133660122590934,
      0.7017108417899101,
      0.6851136184624002,
      0.6706229185403292,
      0.6638443634726174,
      0.6585191486124748,
      0.6507637656477869,
      0.6429837047831047
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.01414646052315823,
        "gain_correlation": 0.09281494726567312
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.0013329897873018575,
        "gain_correlation": 0.07632382068228005
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.012013843320636887,
        "gain_correlation": 0.07182210082626896
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.002275248701638341,
        "gain_correlation": 0.038701236194938475
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.010312579998773044,
        "gain_correlation": 0.0641217454155249
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.00596294382244721,
        "gain_correlation": 0.0536171928578751
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.032476434985469475,
        "gain_correlation": 0.07035166986308675
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.021668869102074283,
        "gain_correlation": 0.1274459934731419
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.008424433998084062,
        "gain_correlation": 0.12085830721228569
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.003781868886039128,
        "gain_correlation": 0.10787012971965755
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.002101148158287331,
        "gain_correlation": 0.11405370566560546
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.012214671031036229,
        "gain_correlation": 0.11406867540527
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": -0.01414646052315823,
        "gain_correlation": 0.09281494726567312,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.16763052344322205,
        "alignment_corr_gain": 0.22153985500335693,
        "global_alignment_mastery_corr": -0.0056428332032131346,
        "global_alignment_gain_corr": 0.02167686195583277,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9892168019176992,
          "constraint_total": 0.010783199873140026,
          "alignment": -0.013405973434663812,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.017953468438411623,
        "min_mastery_variance": 0.012190918438136578,
        "max_mastery_variance": 0.04175310209393501,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": -0.0013329897873018575,
        "gain_correlation": 0.07632382068228005,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.17063137888908386,
        "alignment_corr_gain": 0.26064375042915344,
        "global_alignment_mastery_corr": 0.01085126302903518,
        "global_alignment_gain_corr": 0.02133773831281966,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0101292279655183,
          "constraint_total": -0.010129230761144374,
          "alignment": -0.04417487520885811,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.017438388902481665,
        "min_mastery_variance": 0.012688073329627514,
        "max_mastery_variance": 0.02569570206105709,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": -0.012013843320636887,
        "gain_correlation": 0.07182210082626896,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.16792500019073486,
        "alignment_corr_gain": 0.2898915410041809,
        "global_alignment_mastery_corr": -0.0008639989396518406,
        "global_alignment_gain_corr": 0.03639611845072977,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0265076706679863,
          "constraint_total": -0.02650766701236056,
          "alignment": -0.0775069687007564,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.018255211142678335,
        "min_mastery_variance": 0.012548094615340233,
        "max_mastery_variance": 0.022647498175501823,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": -0.002275248701638341,
        "gain_correlation": 0.038701236194938475,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.18259409070014954,
        "alignment_corr_gain": 0.32970312237739563,
        "global_alignment_mastery_corr": -0.006625018918081575,
        "global_alignment_gain_corr": 0.0335591703014749,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.051690645150464,
          "constraint_total": -0.05169064807844773,
          "alignment": -0.12124207445451494,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.02205778711953157,
        "min_mastery_variance": 0.015540406107902527,
        "max_mastery_variance": 0.030172649770975113,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": -0.010312579998773044,
        "gain_correlation": 0.0641217454155249,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.19191808998584747,
        "alignment_corr_gain": 0.37777724862098694,
        "global_alignment_mastery_corr": 0.0023902468722856915,
        "global_alignment_gain_corr": 0.02619716149182447,
        "effective_alignment_weight": 0.109375,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0360330297205704,
          "constraint_total": -0.03603302740689914,
          "alignment": -0.12168785172601079,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01869183577539235,
        "min_mastery_variance": 0.015199302695691586,
        "max_mastery_variance": 0.022682303562760353,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.00596294382244721,
        "gain_correlation": 0.0536171928578751,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.1924235224723816,
        "alignment_corr_gain": 0.41880935430526733,
        "global_alignment_mastery_corr": -0.01657702139840694,
        "global_alignment_gain_corr": 0.0451264308373599,
        "effective_alignment_weight": 0.13124999999999998,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0631508533785232,
          "constraint_total": -0.06315085026296995,
          "alignment": -0.1708901205505635,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.018624693546154647,
        "min_mastery_variance": 0.01414992194622755,
        "max_mastery_variance": 0.02489609271287918,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.032476434985469475,
        "gain_correlation": 0.07035166986308675,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.21894314885139465,
        "alignment_corr_gain": 0.4769591689109802,
        "global_alignment_mastery_corr": 5.367328093901354e-05,
        "global_alignment_gain_corr": 0.04688884107143773,
        "effective_alignment_weight": 0.10718749999999999,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0326260796805278,
          "constraint_total": -0.03262608117391699,
          "alignment": -0.15910355126559314,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.016551320339731602,
        "min_mastery_variance": 0.013177352026104927,
        "max_mastery_variance": 0.02238333597779274,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.021668869102074283,
        "gain_correlation": 0.1274459934731419,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.21222594380378723,
        "alignment_corr_gain": 0.5105958580970764,
        "global_alignment_mastery_corr": 0.008882175722780328,
        "global_alignment_gain_corr": 0.05387771436333424,
        "effective_alignment_weight": 0.14697370009255972,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.1020759153725646,
          "constraint_total": -0.10207591453162906,
          "alignment": -0.26465591114103243,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.017300716697822273,
        "min_mastery_variance": 0.013464502990245819,
        "max_mastery_variance": 0.02227923832833767,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": 0.008424433998084062,
        "gain_correlation": 0.12085830721228569,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.20291513204574585,
        "alignment_corr_gain": 0.5857071280479431,
        "global_alignment_mastery_corr": 0.01040074389144138,
        "global_alignment_gain_corr": 0.043160361145831605,
        "effective_alignment_weight": 0.14264773369580505,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.1259097621834167,
          "constraint_total": -0.1259097592694436,
          "alignment": -0.3034020729136584,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01718195411014742,
        "min_mastery_variance": 0.013412542641162872,
        "max_mastery_variance": 0.023546438664197922,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": 0.003781868886039128,
        "gain_correlation": 0.10787012971965755,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.22314304113388062,
        "alignment_corr_gain": 0.6338538527488708,
        "global_alignment_mastery_corr": 0.01600068911483201,
        "global_alignment_gain_corr": 0.041572694426098074,
        "effective_alignment_weight": 0.09933254475481805,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.061276741277217,
          "constraint_total": -0.061276740701250644,
          "alignment": -0.25028747264996604,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.016500390038241684,
        "min_mastery_variance": 0.013387726619839668,
        "max_mastery_variance": 0.019777826964855194,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": -0.002101148158287331,
        "gain_correlation": 0.11405370566560546,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.22287340462207794,
        "alignment_corr_gain": 0.645758867263794,
        "global_alignment_mastery_corr": 0.005107363576626085,
        "global_alignment_gain_corr": 0.031135829588941608,
        "effective_alignment_weight": 0.09741176335103807,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0786322508879875,
          "constraint_total": -0.07863225192401686,
          "alignment": -0.2905119080769767,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014764130482247456,
        "min_mastery_variance": 0.012253772467374802,
        "max_mastery_variance": 0.017404256388545036,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.012214671031036229,
        "gain_correlation": 0.11406867540527,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.2181681990623474,
        "alignment_corr_gain": 0.6733296513557434,
        "global_alignment_mastery_corr": 0.011263606954792825,
        "global_alignment_gain_corr": 0.02077225842619858,
        "effective_alignment_weight": 0.07080372197899965,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0071879384762026,
          "constraint_total": -0.007187938080746306,
          "alignment": -0.22217487965918015,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01408011043550437,
        "min_mastery_variance": 0.012297878973186016,
        "max_mastery_variance": 0.016585377976298332,
        "per_lag_correlations": []
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 8,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": true,
      "alignment_global_students": 600,
      "use_residual_alignment": false,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": false,
      "retention_delta": 0.005,
      "retention_weight": 0.14,
      "enable_lag_gain_loss": false,
      "lag_gain_weight": 0.06,
      "lag_max_lag": 3,
      "lag_l1_weight": 0.5,
      "lag_l2_weight": 0.3,
      "lag_l3_weight": 0.2,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5,
      "alignment_share_cap": 0.08,
      "alignment_share_decay_factor": 0.7
    }
  },
  "timestamp": "2025-10-21T22:44:41.056863"
}