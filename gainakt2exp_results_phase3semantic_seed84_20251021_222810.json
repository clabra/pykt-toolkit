{
  "experiment_name": "phase3semantic_seed84",
  "best_val_auc": 0.7242163405308526,
  "final_consistency_metrics": {
    "monotonicity_violation_rate": 0.0,
    "negative_gain_rate": 0.0,
    "bounds_violation_rate": 0.0,
    "mastery_correlation": -0.011009451461956305,
    "gain_correlation": 0.06392131756175817
  },
  "train_history": {
    "train_loss": [
      0.5386377349109848,
      0.5094640329094131,
      0.49352007980791396,
      0.4767081434862601,
      0.47551835139180715,
      0.4738689800000561,
      0.467215101799199,
      0.4549838367830286,
      0.42781363219177165,
      0.38384029130243885,
      0.3501952673487095,
      0.3228198494472652
    ],
    "train_auc": [
      0.6899790429480214,
      0.7229818813475716,
      0.735152813156385,
      0.7449362584674746,
      0.758402554907074,
      0.7751401370949897,
      0.7977611117207595,
      0.8248518064913177,
      0.8533783749960538,
      0.8852106294833801,
      0.9061537565938553,
      0.921053738638995
    ],
    "val_auc": [
      0.7149799013032767,
      0.7227144457490162,
      0.7242163405308526,
      0.723128603339037,
      0.7151818200371564,
      0.7045865271094514,
      0.6902750529822516,
      0.6722602665278223,
      0.6589797359153127,
      0.6513534103898193,
      0.6466311574165884,
      0.6451812053618075
    ],
    "consistency_metrics": [
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.0013641099892762716,
        "gain_correlation": 0.11379576923251189
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.003165302704811293,
        "gain_correlation": 0.117187887295312
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.003202288790708535,
        "gain_correlation": 0.07569981791776537
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.029105691118561084,
        "gain_correlation": 0.07073713980476592
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.019013975465787713,
        "gain_correlation": 0.08637104429067444
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.018883161061334638,
        "gain_correlation": 0.10765559105093497
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.015969594464834334,
        "gain_correlation": 0.0963509794733184
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.022096317505847136,
        "gain_correlation": 0.09475660734131866
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.0018133088923263862,
        "gain_correlation": 0.10571283393900502
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": -0.0013354139562754073,
        "gain_correlation": 0.07765331509939226
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.0018959032322374482,
        "gain_correlation": 0.07044432614951437
      },
      {
        "monotonicity_violation_rate": 0.0,
        "negative_gain_rate": 0.0,
        "bounds_violation_rate": 0.0,
        "mastery_correlation": 0.00752721132056379,
        "gain_correlation": 0.0798680812529692
      }
    ],
    "semantic_trajectory": [
      {
        "epoch": 1,
        "mastery_correlation": -0.0013641099892762716,
        "gain_correlation": 0.11379576923251189,
        "warmup_scale": 0.125,
        "alignment_corr_mastery": 0.16806909441947937,
        "alignment_corr_gain": 0.25734686851501465,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.03125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9901174053150917,
          "constraint_total": 0.009882592675634875,
          "alignment": -0.01390508513742833,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.018442210118850895,
        "min_mastery_variance": 0.012118426151573658,
        "max_mastery_variance": 0.04236399009823799,
        "per_lag_correlations": []
      },
      {
        "epoch": 2,
        "mastery_correlation": -0.003165302704811293,
        "gain_correlation": 0.117187887295312,
        "warmup_scale": 0.25,
        "alignment_corr_mastery": 0.1738254278898239,
        "alignment_corr_gain": 0.282279908657074,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.0625,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0105180268782867,
          "constraint_total": -0.010518023421105591,
          "alignment": -0.04451775891540295,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01930310876335505,
        "min_mastery_variance": 0.014741717837750912,
        "max_mastery_variance": 0.025773372501134872,
        "per_lag_correlations": []
      },
      {
        "epoch": 3,
        "mastery_correlation": 0.003202288790708535,
        "gain_correlation": 0.07569981791776537,
        "warmup_scale": 0.375,
        "alignment_corr_mastery": 0.17580552399158478,
        "alignment_corr_gain": 0.30294305086135864,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.09375,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0274970385292803,
          "constraint_total": -0.027497038451058303,
          "alignment": -0.0783414639686355,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01856478163248671,
        "min_mastery_variance": 0.014461512677371502,
        "max_mastery_variance": 0.02320651151239872,
        "per_lag_correlations": []
      },
      {
        "epoch": 4,
        "mastery_correlation": 0.029105691118561084,
        "gain_correlation": 0.07073713980476592,
        "warmup_scale": 0.5,
        "alignment_corr_mastery": 0.19316606223583221,
        "alignment_corr_gain": 0.3284509479999542,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.125,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0501524508979032,
          "constraint_total": -0.050152449379519626,
          "alignment": -0.11915836947626211,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.017956402365098965,
        "min_mastery_variance": 0.014323024079203606,
        "max_mastery_variance": 0.025204332545399666,
        "per_lag_correlations": []
      },
      {
        "epoch": 5,
        "mastery_correlation": 0.019013975465787713,
        "gain_correlation": 0.08637104429067444,
        "warmup_scale": 0.625,
        "alignment_corr_mastery": 0.20405313372612,
        "alignment_corr_gain": 0.3584999442100525,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.109375,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0325978644173714,
          "constraint_total": -0.03259786589896266,
          "alignment": -0.11742850080277076,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.017640500498327567,
        "min_mastery_variance": 0.014105373993515968,
        "max_mastery_variance": 0.025330565869808197,
        "per_lag_correlations": []
      },
      {
        "epoch": 6,
        "mastery_correlation": 0.018883161061334638,
        "gain_correlation": 0.10765559105093497,
        "warmup_scale": 0.75,
        "alignment_corr_mastery": 0.2238176465034485,
        "alignment_corr_gain": 0.39007097482681274,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.09187499999999998,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 1.0093623388265736,
          "constraint_total": -0.009362335608680456,
          "alignment": -0.11006047718383358,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.01609169239168649,
        "min_mastery_variance": 0.013944044709205627,
        "max_mastery_variance": 0.018321603536605835,
        "per_lag_correlations": []
      },
      {
        "epoch": 7,
        "mastery_correlation": 0.015969594464834334,
        "gain_correlation": 0.0963509794733184,
        "warmup_scale": 0.875,
        "alignment_corr_mastery": 0.22385793924331665,
        "alignment_corr_gain": 0.4380118250846863,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.07503124999999998,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.3,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9829967569972232,
          "constraint_total": 0.017003245812055704,
          "alignment": -0.10105028878178822,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.015387444510824322,
        "min_mastery_variance": 0.013620537705719471,
        "max_mastery_variance": 0.017630258575081825,
        "per_lag_correlations": []
      },
      {
        "epoch": 8,
        "mastery_correlation": 0.022096317505847136,
        "gain_correlation": 0.09475660734131866,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.21550048887729645,
        "alignment_corr_gain": 0.4631985127925873,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.06002499999999998,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9524335169658177,
          "constraint_total": 0.047566484243253104,
          "alignment": -0.09010063757148186,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014860911236911857,
        "min_mastery_variance": 0.01324605755507946,
        "max_mastery_variance": 0.01661684736609459,
        "per_lag_correlations": []
      },
      {
        "epoch": 9,
        "mastery_correlation": -0.0018133088923263862,
        "gain_correlation": 0.10571283393900502,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.23745062947273254,
        "alignment_corr_gain": 0.5103539824485779,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9395534644868773,
          "constraint_total": 0.060446530888545305,
          "alignment": -0.08558202056801843,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.014271489185295574,
        "min_mastery_variance": 0.01261189952492714,
        "max_mastery_variance": 0.016581011936068535,
        "per_lag_correlations": []
      },
      {
        "epoch": 10,
        "mastery_correlation": -0.0013354139562754073,
        "gain_correlation": 0.07765331509939226,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.21132118999958038,
        "alignment_corr_gain": 0.5730229020118713,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9405146142930063,
          "constraint_total": 0.059485378616583436,
          "alignment": -0.10332261050086582,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.0135527772327084,
        "min_mastery_variance": 0.012205729261040688,
        "max_mastery_variance": 0.01493780966848135,
        "per_lag_correlations": []
      },
      {
        "epoch": 11,
        "mastery_correlation": 0.0018959032322374482,
        "gain_correlation": 0.07044432614951437,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.24549788236618042,
        "alignment_corr_gain": 0.5877899527549744,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9403293523061156,
          "constraint_total": 0.05967063904037658,
          "alignment": -0.1187735481625811,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.013190102498071182,
        "min_mastery_variance": 0.011797522194683552,
        "max_mastery_variance": 0.014627611264586449,
        "per_lag_correlations": []
      },
      {
        "epoch": 12,
        "mastery_correlation": 0.00752721132056379,
        "gain_correlation": 0.0798680812529692,
        "warmup_scale": 1.0,
        "alignment_corr_mastery": 0.21234136819839478,
        "alignment_corr_gain": 0.6143193244934082,
        "global_alignment_mastery_corr": null,
        "global_alignment_gain_corr": null,
        "effective_alignment_weight": 0.05,
        "peak_mastery_corr": 0.0,
        "retention_loss_value": 0.0,
        "mean_lag_corr": 0.0,
        "lag_corr_count": 0,
        "consistency_loss_weight_current": 0.2,
        "sparsity_loss_weight_current": 0.2,
        "loss_shares": {
          "main": 0.9399459150076097,
          "constraint_total": 0.06005408421509512,
          "alignment": -0.13332909457170936,
          "lag": 0.0,
          "retention": 0.0
        },
        "mean_mastery_variance": 0.012951629284595579,
        "min_mastery_variance": 0.011567308567464352,
        "max_mastery_variance": 0.014033686369657516,
        "per_lag_correlations": []
      }
    ]
  },
  "model_config": {
    "num_c": 100,
    "seq_len": 200,
    "d_model": 512,
    "n_heads": 8,
    "num_encoder_blocks": 6,
    "d_ff": 1024,
    "dropout": 0.2,
    "emb_type": "qid",
    "monitor_frequency": 50,
    "use_mastery_head": true,
    "use_gain_head": true,
    "non_negative_loss_weight": 0.0,
    "monotonicity_loss_weight": 0.1,
    "mastery_performance_loss_weight": 0.8,
    "gain_performance_loss_weight": 0.8,
    "sparsity_loss_weight": 0.2,
    "consistency_loss_weight": 0.3
  },
  "training_args": {
    "dataset_name": "assist2015",
    "num_epochs": 12,
    "batch_size": 64,
    "learning_rate": 0.000174,
    "weight_decay": 1.7571e-05,
    "enhanced_constraints": true,
    "fold": 0,
    "constraint_weights": {
      "non_negative_loss_weight": 0.0,
      "monotonicity_loss_weight": 0.1,
      "mastery_performance_loss_weight": 0.8,
      "gain_performance_loss_weight": 0.8,
      "sparsity_loss_weight": 0.2,
      "consistency_loss_weight": 0.3
    },
    "alignment": {
      "enable_alignment_loss": true,
      "alignment_weight": 0.25,
      "alignment_warmup_epochs": 8,
      "adaptive_alignment": true,
      "alignment_min_correlation": 0.05
    },
    "global_alignment": {
      "enable_global_alignment_pass": false,
      "alignment_global_students": 600,
      "use_residual_alignment": false,
      "alignment_residual_window": 5
    },
    "refinement": {
      "enable_retention_loss": false,
      "retention_delta": 0.005,
      "retention_weight": 0.14,
      "enable_lag_gain_loss": false,
      "lag_gain_weight": 0.06,
      "lag_max_lag": 3,
      "lag_l1_weight": 0.5,
      "lag_l2_weight": 0.3,
      "lag_l3_weight": 0.2,
      "enable_cosine_perf_schedule": false,
      "consistency_rebalance_epoch": 8,
      "consistency_rebalance_threshold": 0.1,
      "consistency_rebalance_new_weight": 0.2,
      "variance_floor": 0.0001,
      "variance_floor_patience": 3,
      "variance_floor_reduce_factor": 0.5,
      "alignment_share_cap": 0.08,
      "alignment_share_decay_factor": 0.7
    }
  },
  "timestamp": "2025-10-21T22:28:10.835033"
}