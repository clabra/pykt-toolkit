
================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.88
Lambda Mastery: 0.12 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1157, BCE: 0.1086, Mastery: 0.1681
Valid - Loss: 0.0921, Total AUC: 0.6846, BCE AUC: 0.6847, Mastery AUC: 0.5387
‚úì Saved best model (AUC: 0.6846)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0954, BCE: 0.0936, Mastery: 0.1091
Valid - Loss: 0.0902, Total AUC: 0.7028, BCE AUC: 0.7035, Mastery AUC: 0.5839
‚úì Saved best model (AUC: 0.7028)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0936, BCE: 0.0920, Mastery: 0.1056
Valid - Loss: 0.0889, Total AUC: 0.7111, BCE AUC: 0.7126, Mastery AUC: 0.5977
‚úì Saved best model (AUC: 0.7111)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0924, BCE: 0.0910, Mastery: 0.1032
Valid - Loss: 0.0883, Total AUC: 0.7167, BCE AUC: 0.7181, Mastery AUC: 0.6043
‚úì Saved best model (AUC: 0.7167)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0916, BCE: 0.0902, Mastery: 0.1021
Valid - Loss: 0.0878, Total AUC: 0.7201, BCE AUC: 0.7214, Mastery AUC: 0.6141
‚úì Saved best model (AUC: 0.7201)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0909, BCE: 0.0896, Mastery: 0.1009
Valid - Loss: 0.0875, Total AUC: 0.7222, BCE AUC: 0.7235, Mastery AUC: 0.6224
‚úì Saved best model (AUC: 0.7222)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0903, BCE: 0.0890, Mastery: 0.0998
Valid - Loss: 0.0873, Total AUC: 0.7234, BCE AUC: 0.7244, Mastery AUC: 0.6289
‚úì Saved best model (AUC: 0.7234)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0898, BCE: 0.0885, Mastery: 0.0992
Valid - Loss: 0.0872, Total AUC: 0.7244, BCE AUC: 0.7251, Mastery AUC: 0.6327
‚úì Saved best model (AUC: 0.7244)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0894, BCE: 0.0881, Mastery: 0.0986
Valid - Loss: 0.0872, Total AUC: 0.7246, BCE AUC: 0.7253, Mastery AUC: 0.6365
‚úì Saved best model (AUC: 0.7246)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0889, BCE: 0.0876, Mastery: 0.0981
Valid - Loss: 0.0872, Total AUC: 0.7244, BCE AUC: 0.7248, Mastery AUC: 0.6379
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0884, BCE: 0.0872, Mastery: 0.0978
Valid - Loss: 0.0873, Total AUC: 0.7240, BCE AUC: 0.7244, Mastery AUC: 0.6402
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0880, BCE: 0.0867, Mastery: 0.0975
Valid - Loss: 0.0874, Total AUC: 0.7234, BCE AUC: 0.7237, Mastery AUC: 0.6414
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0876, BCE: 0.0863, Mastery: 0.0973
Valid - Loss: 0.0875, Total AUC: 0.7229, BCE AUC: 0.7230, Mastery AUC: 0.6429
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7246
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7182, Acc: 0.7472
BCE Head - AUC: 0.7190, Acc: 0.7478
Mastery Head - AUC: 0.6325, Acc: 0.7263
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 696333
‚úì Created experiment folder: 20251123_222517_gainakt4_lambda_bce_0.88_696333
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.88 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            696333
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.88 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_222517_gainakt4_lambda_bce_0.88_696333

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 696333

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.89
Lambda Mastery: 0.10999999999999999 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1151, BCE: 0.1085, Mastery: 0.1685
Valid - Loss: 0.0920, Total AUC: 0.6849, BCE AUC: 0.6848, Mastery AUC: 0.5385
‚úì Saved best model (AUC: 0.6849)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0953, BCE: 0.0935, Mastery: 0.1092
Valid - Loss: 0.0901, Total AUC: 0.7032, BCE AUC: 0.7038, Mastery AUC: 0.5836
‚úì Saved best model (AUC: 0.7032)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0935, BCE: 0.0920, Mastery: 0.1057
Valid - Loss: 0.0888, Total AUC: 0.7114, BCE AUC: 0.7126, Mastery AUC: 0.5979
‚úì Saved best model (AUC: 0.7114)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0923, BCE: 0.0909, Mastery: 0.1033
Valid - Loss: 0.0882, Total AUC: 0.7170, BCE AUC: 0.7182, Mastery AUC: 0.6037
‚úì Saved best model (AUC: 0.7170)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0915, BCE: 0.0902, Mastery: 0.1022
Valid - Loss: 0.0877, Total AUC: 0.7203, BCE AUC: 0.7214, Mastery AUC: 0.6137
‚úì Saved best model (AUC: 0.7203)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0908, BCE: 0.0896, Mastery: 0.1011
Valid - Loss: 0.0874, Total AUC: 0.7224, BCE AUC: 0.7235, Mastery AUC: 0.6209
‚úì Saved best model (AUC: 0.7224)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0902, BCE: 0.0890, Mastery: 0.1000
Valid - Loss: 0.0873, Total AUC: 0.7235, BCE AUC: 0.7244, Mastery AUC: 0.6270
‚úì Saved best model (AUC: 0.7235)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0897, BCE: 0.0885, Mastery: 0.0995
Valid - Loss: 0.0872, Total AUC: 0.7243, BCE AUC: 0.7250, Mastery AUC: 0.6305
‚úì Saved best model (AUC: 0.7243)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0893, BCE: 0.0881, Mastery: 0.0989
Valid - Loss: 0.0871, Total AUC: 0.7246, BCE AUC: 0.7252, Mastery AUC: 0.6346
‚úì Saved best model (AUC: 0.7246)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0888, BCE: 0.0876, Mastery: 0.0984
Valid - Loss: 0.0872, Total AUC: 0.7242, BCE AUC: 0.7246, Mastery AUC: 0.6358
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0883, BCE: 0.0871, Mastery: 0.0979
Valid - Loss: 0.0872, Total AUC: 0.7240, BCE AUC: 0.7244, Mastery AUC: 0.6383
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0879, BCE: 0.0867, Mastery: 0.0977
Valid - Loss: 0.0874, Total AUC: 0.7234, BCE AUC: 0.7236, Mastery AUC: 0.6394
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0875, BCE: 0.0863, Mastery: 0.0975
Valid - Loss: 0.0875, Total AUC: 0.7228, BCE AUC: 0.7229, Mastery AUC: 0.6410
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7246
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7183, Acc: 0.7474
BCE Head - AUC: 0.7190, Acc: 0.7479
Mastery Head - AUC: 0.6309, Acc: 0.7260
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 242447
‚úì Created experiment folder: 20251123_223233_gainakt4_lambda_bce_0.89_242447
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.89 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            242447
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.89 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_223233_gainakt4_lambda_bce_0.89_242447

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 242447

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.9
Lambda Mastery: 0.09999999999999998 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1146, BCE: 0.1085, Mastery: 0.1689
Valid - Loss: 0.0918, Total AUC: 0.6851, BCE AUC: 0.6850, Mastery AUC: 0.5376
‚úì Saved best model (AUC: 0.6851)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0951, BCE: 0.0935, Mastery: 0.1093
Valid - Loss: 0.0899, Total AUC: 0.7035, BCE AUC: 0.7040, Mastery AUC: 0.5833
‚úì Saved best model (AUC: 0.7035)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0934, BCE: 0.0920, Mastery: 0.1059
Valid - Loss: 0.0887, Total AUC: 0.7117, BCE AUC: 0.7128, Mastery AUC: 0.5977
‚úì Saved best model (AUC: 0.7117)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0922, BCE: 0.0909, Mastery: 0.1034
Valid - Loss: 0.0881, Total AUC: 0.7173, BCE AUC: 0.7184, Mastery AUC: 0.6030
‚úì Saved best model (AUC: 0.7173)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0914, BCE: 0.0901, Mastery: 0.1023
Valid - Loss: 0.0876, Total AUC: 0.7205, BCE AUC: 0.7215, Mastery AUC: 0.6125
‚úì Saved best model (AUC: 0.7205)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0907, BCE: 0.0895, Mastery: 0.1011
Valid - Loss: 0.0873, Total AUC: 0.7227, BCE AUC: 0.7236, Mastery AUC: 0.6194
‚úì Saved best model (AUC: 0.7227)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0901, BCE: 0.0890, Mastery: 0.1001
Valid - Loss: 0.0872, Total AUC: 0.7235, BCE AUC: 0.7243, Mastery AUC: 0.6246
‚úì Saved best model (AUC: 0.7235)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0896, BCE: 0.0885, Mastery: 0.0996
Valid - Loss: 0.0871, Total AUC: 0.7244, BCE AUC: 0.7250, Mastery AUC: 0.6285
‚úì Saved best model (AUC: 0.7244)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0891, BCE: 0.0880, Mastery: 0.0990
Valid - Loss: 0.0871, Total AUC: 0.7247, BCE AUC: 0.7252, Mastery AUC: 0.6329
‚úì Saved best model (AUC: 0.7247)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0887, BCE: 0.0876, Mastery: 0.0985
Valid - Loss: 0.0871, Total AUC: 0.7244, BCE AUC: 0.7247, Mastery AUC: 0.6340
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0882, BCE: 0.0871, Mastery: 0.0981
Valid - Loss: 0.0872, Total AUC: 0.7240, BCE AUC: 0.7243, Mastery AUC: 0.6369
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0878, BCE: 0.0867, Mastery: 0.0978
Valid - Loss: 0.0873, Total AUC: 0.7234, BCE AUC: 0.7236, Mastery AUC: 0.6380
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0874, BCE: 0.0862, Mastery: 0.0976
Valid - Loss: 0.0874, Total AUC: 0.7229, BCE AUC: 0.7229, Mastery AUC: 0.6402
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7247
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7183, Acc: 0.7472
BCE Head - AUC: 0.7189, Acc: 0.7473
Mastery Head - AUC: 0.6297, Acc: 0.7262
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 999963
‚úì Created experiment folder: 20251123_223951_gainakt4_lambda_bce_0.90_999963
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.9 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            999963
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.9 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_223951_gainakt4_lambda_bce_0.90_999963

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 999963

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.91
Lambda Mastery: 0.08999999999999997 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1140, BCE: 0.1085, Mastery: 0.1693
Valid - Loss: 0.0917, Total AUC: 0.6853, BCE AUC: 0.6852, Mastery AUC: 0.5376
‚úì Saved best model (AUC: 0.6853)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0949, BCE: 0.0935, Mastery: 0.1094
Valid - Loss: 0.0898, Total AUC: 0.7038, BCE AUC: 0.7042, Mastery AUC: 0.5823
‚úì Saved best model (AUC: 0.7038)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0932, BCE: 0.0919, Mastery: 0.1060
Valid - Loss: 0.0886, Total AUC: 0.7121, BCE AUC: 0.7130, Mastery AUC: 0.5972
‚úì Saved best model (AUC: 0.7121)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0920, BCE: 0.0909, Mastery: 0.1035
Valid - Loss: 0.0880, Total AUC: 0.7176, BCE AUC: 0.7185, Mastery AUC: 0.6025
‚úì Saved best model (AUC: 0.7176)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0912, BCE: 0.0901, Mastery: 0.1025
Valid - Loss: 0.0875, Total AUC: 0.7207, BCE AUC: 0.7216, Mastery AUC: 0.6114
‚úì Saved best model (AUC: 0.7207)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0906, BCE: 0.0895, Mastery: 0.1013
Valid - Loss: 0.0872, Total AUC: 0.7228, BCE AUC: 0.7236, Mastery AUC: 0.6185
‚úì Saved best model (AUC: 0.7228)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0900, BCE: 0.0890, Mastery: 0.1004
Valid - Loss: 0.0871, Total AUC: 0.7236, BCE AUC: 0.7243, Mastery AUC: 0.6223
‚úì Saved best model (AUC: 0.7236)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0895, BCE: 0.0885, Mastery: 0.0999
Valid - Loss: 0.0871, Total AUC: 0.7244, BCE AUC: 0.7249, Mastery AUC: 0.6264
‚úì Saved best model (AUC: 0.7244)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0890, BCE: 0.0880, Mastery: 0.0993
Valid - Loss: 0.0870, Total AUC: 0.7248, BCE AUC: 0.7253, Mastery AUC: 0.6306
‚úì Saved best model (AUC: 0.7248)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0885, BCE: 0.0875, Mastery: 0.0987
Valid - Loss: 0.0871, Total AUC: 0.7243, BCE AUC: 0.7246, Mastery AUC: 0.6318
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0881, BCE: 0.0871, Mastery: 0.0983
Valid - Loss: 0.0872, Total AUC: 0.7240, BCE AUC: 0.7243, Mastery AUC: 0.6345
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0877, BCE: 0.0866, Mastery: 0.0981
Valid - Loss: 0.0873, Total AUC: 0.7233, BCE AUC: 0.7235, Mastery AUC: 0.6358
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0873, BCE: 0.0862, Mastery: 0.0979
Valid - Loss: 0.0874, Total AUC: 0.7227, BCE AUC: 0.7227, Mastery AUC: 0.6382
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7248
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7184, Acc: 0.7473
BCE Head - AUC: 0.7189, Acc: 0.7473
Mastery Head - AUC: 0.6276, Acc: 0.7259
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 653622
‚úì Created experiment folder: 20251123_224735_gainakt4_lambda_bce_0.91_653622
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.91 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            653622
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.91 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_224735_gainakt4_lambda_bce_0.91_653622

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 653622

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.92
Lambda Mastery: 0.07999999999999996 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1134, BCE: 0.1085, Mastery: 0.1698
Valid - Loss: 0.0916, Total AUC: 0.6855, BCE AUC: 0.6854, Mastery AUC: 0.5385
‚úì Saved best model (AUC: 0.6855)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0948, BCE: 0.0935, Mastery: 0.1095
Valid - Loss: 0.0896, Total AUC: 0.7041, BCE AUC: 0.7044, Mastery AUC: 0.5813
‚úì Saved best model (AUC: 0.7041)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0931, BCE: 0.0919, Mastery: 0.1061
Valid - Loss: 0.0884, Total AUC: 0.7125, BCE AUC: 0.7132, Mastery AUC: 0.5971
‚úì Saved best model (AUC: 0.7125)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0919, BCE: 0.0909, Mastery: 0.1037
Valid - Loss: 0.0878, Total AUC: 0.7179, BCE AUC: 0.7186, Mastery AUC: 0.6024
‚úì Saved best model (AUC: 0.7179)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0911, BCE: 0.0901, Mastery: 0.1026
Valid - Loss: 0.0874, Total AUC: 0.7209, BCE AUC: 0.7216, Mastery AUC: 0.6101
‚úì Saved best model (AUC: 0.7209)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0904, BCE: 0.0895, Mastery: 0.1015
Valid - Loss: 0.0872, Total AUC: 0.7230, BCE AUC: 0.7236, Mastery AUC: 0.6168
‚úì Saved best model (AUC: 0.7230)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0899, BCE: 0.0889, Mastery: 0.1006
Valid - Loss: 0.0870, Total AUC: 0.7238, BCE AUC: 0.7243, Mastery AUC: 0.6208
‚úì Saved best model (AUC: 0.7238)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0894, BCE: 0.0884, Mastery: 0.1000
Valid - Loss: 0.0870, Total AUC: 0.7245, BCE AUC: 0.7249, Mastery AUC: 0.6248
‚úì Saved best model (AUC: 0.7245)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0889, BCE: 0.0880, Mastery: 0.0995
Valid - Loss: 0.0869, Total AUC: 0.7247, BCE AUC: 0.7251, Mastery AUC: 0.6285
‚úì Saved best model (AUC: 0.7247)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0884, BCE: 0.0875, Mastery: 0.0989
Valid - Loss: 0.0870, Total AUC: 0.7242, BCE AUC: 0.7245, Mastery AUC: 0.6297
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0879, BCE: 0.0870, Mastery: 0.0985
Valid - Loss: 0.0871, Total AUC: 0.7239, BCE AUC: 0.7242, Mastery AUC: 0.6313
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0875, BCE: 0.0866, Mastery: 0.0983
Valid - Loss: 0.0873, Total AUC: 0.7232, BCE AUC: 0.7233, Mastery AUC: 0.6330
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0871, BCE: 0.0862, Mastery: 0.0981
Valid - Loss: 0.0873, Total AUC: 0.7226, BCE AUC: 0.7226, Mastery AUC: 0.6355
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7247
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7185, Acc: 0.7474
BCE Head - AUC: 0.7189, Acc: 0.7474
Mastery Head - AUC: 0.6260, Acc: 0.7251
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 834494
‚úì Created experiment folder: 20251123_225452_gainakt4_lambda_bce_0.92_834494
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.92 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            834494
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.92 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_225452_gainakt4_lambda_bce_0.92_834494

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 834494

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.93
Lambda Mastery: 0.06999999999999995 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1128, BCE: 0.1085, Mastery: 0.1702
Valid - Loss: 0.0914, Total AUC: 0.6858, BCE AUC: 0.6857, Mastery AUC: 0.5390
‚úì Saved best model (AUC: 0.6858)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0946, BCE: 0.0935, Mastery: 0.1096
Valid - Loss: 0.0895, Total AUC: 0.7044, BCE AUC: 0.7047, Mastery AUC: 0.5809
‚úì Saved best model (AUC: 0.7044)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0929, BCE: 0.0919, Mastery: 0.1062
Valid - Loss: 0.0883, Total AUC: 0.7128, BCE AUC: 0.7134, Mastery AUC: 0.5967
‚úì Saved best model (AUC: 0.7128)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0918, BCE: 0.0909, Mastery: 0.1038
Valid - Loss: 0.0877, Total AUC: 0.7182, BCE AUC: 0.7188, Mastery AUC: 0.6027
‚úì Saved best model (AUC: 0.7182)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0910, BCE: 0.0901, Mastery: 0.1028
Valid - Loss: 0.0873, Total AUC: 0.7213, BCE AUC: 0.7219, Mastery AUC: 0.6090
‚úì Saved best model (AUC: 0.7213)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0903, BCE: 0.0895, Mastery: 0.1017
Valid - Loss: 0.0871, Total AUC: 0.7233, BCE AUC: 0.7238, Mastery AUC: 0.6149
‚úì Saved best model (AUC: 0.7233)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0898, BCE: 0.0889, Mastery: 0.1008
Valid - Loss: 0.0869, Total AUC: 0.7240, BCE AUC: 0.7244, Mastery AUC: 0.6187
‚úì Saved best model (AUC: 0.7240)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0892, BCE: 0.0884, Mastery: 0.1003
Valid - Loss: 0.0869, Total AUC: 0.7246, BCE AUC: 0.7250, Mastery AUC: 0.6226
‚úì Saved best model (AUC: 0.7246)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0888, BCE: 0.0880, Mastery: 0.0997
Valid - Loss: 0.0869, Total AUC: 0.7248, BCE AUC: 0.7251, Mastery AUC: 0.6258
‚úì Saved best model (AUC: 0.7248)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0883, BCE: 0.0875, Mastery: 0.0992
Valid - Loss: 0.0870, Total AUC: 0.7243, BCE AUC: 0.7246, Mastery AUC: 0.6272
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0878, BCE: 0.0870, Mastery: 0.0988
Valid - Loss: 0.0871, Total AUC: 0.7239, BCE AUC: 0.7241, Mastery AUC: 0.6288
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0874, BCE: 0.0865, Mastery: 0.0986
Valid - Loss: 0.0872, Total AUC: 0.7231, BCE AUC: 0.7232, Mastery AUC: 0.6300
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0870, BCE: 0.0861, Mastery: 0.0983
Valid - Loss: 0.0873, Total AUC: 0.7225, BCE AUC: 0.7225, Mastery AUC: 0.6334
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7248
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7186, Acc: 0.7477
BCE Head - AUC: 0.7189, Acc: 0.7473
Mastery Head - AUC: 0.6238, Acc: 0.7245
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 213595
‚úì Created experiment folder: 20251123_230213_gainakt4_lambda_bce_0.93_213595
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.93 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            213595
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.93 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_230213_gainakt4_lambda_bce_0.93_213595

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 213595

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.94
Lambda Mastery: 0.06000000000000005 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1122, BCE: 0.1085, Mastery: 0.1707
Valid - Loss: 0.0913, Total AUC: 0.6860, BCE AUC: 0.6859, Mastery AUC: 0.5390
‚úì Saved best model (AUC: 0.6860)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0944, BCE: 0.0935, Mastery: 0.1097
Valid - Loss: 0.0893, Total AUC: 0.7046, BCE AUC: 0.7048, Mastery AUC: 0.5805
‚úì Saved best model (AUC: 0.7046)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0928, BCE: 0.0919, Mastery: 0.1064
Valid - Loss: 0.0882, Total AUC: 0.7131, BCE AUC: 0.7135, Mastery AUC: 0.5958
‚úì Saved best model (AUC: 0.7131)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0916, BCE: 0.0908, Mastery: 0.1040
Valid - Loss: 0.0876, Total AUC: 0.7185, BCE AUC: 0.7190, Mastery AUC: 0.6027
‚úì Saved best model (AUC: 0.7185)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0908, BCE: 0.0901, Mastery: 0.1029
Valid - Loss: 0.0872, Total AUC: 0.7215, BCE AUC: 0.7220, Mastery AUC: 0.6079
‚úì Saved best model (AUC: 0.7215)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0902, BCE: 0.0894, Mastery: 0.1019
Valid - Loss: 0.0870, Total AUC: 0.7234, BCE AUC: 0.7239, Mastery AUC: 0.6132
‚úì Saved best model (AUC: 0.7234)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0896, BCE: 0.0889, Mastery: 0.1011
Valid - Loss: 0.0869, Total AUC: 0.7241, BCE AUC: 0.7245, Mastery AUC: 0.6164
‚úì Saved best model (AUC: 0.7241)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0891, BCE: 0.0884, Mastery: 0.1006
Valid - Loss: 0.0868, Total AUC: 0.7247, BCE AUC: 0.7251, Mastery AUC: 0.6200
‚úì Saved best model (AUC: 0.7247)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0887, BCE: 0.0879, Mastery: 0.1001
Valid - Loss: 0.0868, Total AUC: 0.7249, BCE AUC: 0.7252, Mastery AUC: 0.6220
‚úì Saved best model (AUC: 0.7249)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0882, BCE: 0.0874, Mastery: 0.0996
Valid - Loss: 0.0869, Total AUC: 0.7244, BCE AUC: 0.7246, Mastery AUC: 0.6239
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0877, BCE: 0.0869, Mastery: 0.0992
Valid - Loss: 0.0870, Total AUC: 0.7239, BCE AUC: 0.7240, Mastery AUC: 0.6251
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0872, BCE: 0.0865, Mastery: 0.0989
Valid - Loss: 0.0871, Total AUC: 0.7231, BCE AUC: 0.7232, Mastery AUC: 0.6265
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0868, BCE: 0.0861, Mastery: 0.0987
Valid - Loss: 0.0872, Total AUC: 0.7224, BCE AUC: 0.7224, Mastery AUC: 0.6299
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7249
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7187, Acc: 0.7478
BCE Head - AUC: 0.7190, Acc: 0.7477
Mastery Head - AUC: 0.6208, Acc: 0.7256
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 498563
‚úì Created experiment folder: 20251123_230934_gainakt4_lambda_bce_0.94_498563
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.94 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            498563
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.94 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_230934_gainakt4_lambda_bce_0.94_498563

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 498563

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.95
Lambda Mastery: 0.050000000000000044 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1116, BCE: 0.1085, Mastery: 0.1713
Valid - Loss: 0.0911, Total AUC: 0.6862, BCE AUC: 0.6861, Mastery AUC: 0.5396
‚úì Saved best model (AUC: 0.6862)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0943, BCE: 0.0935, Mastery: 0.1098
Valid - Loss: 0.0892, Total AUC: 0.7049, BCE AUC: 0.7051, Mastery AUC: 0.5795
‚úì Saved best model (AUC: 0.7049)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0926, BCE: 0.0919, Mastery: 0.1066
Valid - Loss: 0.0881, Total AUC: 0.7134, BCE AUC: 0.7137, Mastery AUC: 0.5957
‚úì Saved best model (AUC: 0.7134)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0915, BCE: 0.0908, Mastery: 0.1043
Valid - Loss: 0.0875, Total AUC: 0.7187, BCE AUC: 0.7191, Mastery AUC: 0.6031
‚úì Saved best model (AUC: 0.7187)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0907, BCE: 0.0900, Mastery: 0.1032
Valid - Loss: 0.0871, Total AUC: 0.7218, BCE AUC: 0.7221, Mastery AUC: 0.6069
‚úì Saved best model (AUC: 0.7218)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0901, BCE: 0.0894, Mastery: 0.1022
Valid - Loss: 0.0869, Total AUC: 0.7236, BCE AUC: 0.7239, Mastery AUC: 0.6116
‚úì Saved best model (AUC: 0.7236)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0895, BCE: 0.0889, Mastery: 0.1014
Valid - Loss: 0.0868, Total AUC: 0.7242, BCE AUC: 0.7245, Mastery AUC: 0.6140
‚úì Saved best model (AUC: 0.7242)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0890, BCE: 0.0884, Mastery: 0.1009
Valid - Loss: 0.0867, Total AUC: 0.7248, BCE AUC: 0.7250, Mastery AUC: 0.6176
‚úì Saved best model (AUC: 0.7248)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0885, BCE: 0.0879, Mastery: 0.1005
Valid - Loss: 0.0867, Total AUC: 0.7249, BCE AUC: 0.7251, Mastery AUC: 0.6189
‚úì Saved best model (AUC: 0.7249)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0880, BCE: 0.0874, Mastery: 0.1000
Valid - Loss: 0.0868, Total AUC: 0.7244, BCE AUC: 0.7245, Mastery AUC: 0.6214
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0876, BCE: 0.0869, Mastery: 0.0995
Valid - Loss: 0.0869, Total AUC: 0.7239, BCE AUC: 0.7241, Mastery AUC: 0.6224
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0871, BCE: 0.0865, Mastery: 0.0993
Valid - Loss: 0.0871, Total AUC: 0.7230, BCE AUC: 0.7231, Mastery AUC: 0.6235
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0867, BCE: 0.0860, Mastery: 0.0991
Valid - Loss: 0.0872, Total AUC: 0.7224, BCE AUC: 0.7224, Mastery AUC: 0.6261
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7249
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7187, Acc: 0.7475
BCE Head - AUC: 0.7189, Acc: 0.7476
Mastery Head - AUC: 0.6180, Acc: 0.7264
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 303348
‚úì Created experiment folder: 20251123_231655_gainakt4_lambda_bce_0.95_303348
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.95 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            303348
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.95 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_231655_gainakt4_lambda_bce_0.95_303348

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 303348

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.96
Lambda Mastery: 0.040000000000000036 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1110, BCE: 0.1084, Mastery: 0.1720
Valid - Loss: 0.0910, Total AUC: 0.6864, BCE AUC: 0.6862, Mastery AUC: 0.5392
‚úì Saved best model (AUC: 0.6864)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0941, BCE: 0.0935, Mastery: 0.1100
Valid - Loss: 0.0890, Total AUC: 0.7051, BCE AUC: 0.7052, Mastery AUC: 0.5790
‚úì Saved best model (AUC: 0.7051)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0925, BCE: 0.0919, Mastery: 0.1069
Valid - Loss: 0.0880, Total AUC: 0.7137, BCE AUC: 0.7139, Mastery AUC: 0.5950
‚úì Saved best model (AUC: 0.7137)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0914, BCE: 0.0908, Mastery: 0.1046
Valid - Loss: 0.0874, Total AUC: 0.7190, BCE AUC: 0.7192, Mastery AUC: 0.6027
‚úì Saved best model (AUC: 0.7190)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0906, BCE: 0.0900, Mastery: 0.1035
Valid - Loss: 0.0870, Total AUC: 0.7219, BCE AUC: 0.7222, Mastery AUC: 0.6066
‚úì Saved best model (AUC: 0.7219)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0899, BCE: 0.0894, Mastery: 0.1025
Valid - Loss: 0.0868, Total AUC: 0.7237, BCE AUC: 0.7239, Mastery AUC: 0.6100
‚úì Saved best model (AUC: 0.7237)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0894, BCE: 0.0889, Mastery: 0.1018
Valid - Loss: 0.0867, Total AUC: 0.7243, BCE AUC: 0.7245, Mastery AUC: 0.6109
‚úì Saved best model (AUC: 0.7243)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0889, BCE: 0.0883, Mastery: 0.1013
Valid - Loss: 0.0866, Total AUC: 0.7248, BCE AUC: 0.7250, Mastery AUC: 0.6150
‚úì Saved best model (AUC: 0.7248)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0884, BCE: 0.0879, Mastery: 0.1010
Valid - Loss: 0.0866, Total AUC: 0.7248, BCE AUC: 0.7250, Mastery AUC: 0.6164
‚úì Saved best model (AUC: 0.7248)

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0879, BCE: 0.0874, Mastery: 0.1005
Valid - Loss: 0.0867, Total AUC: 0.7244, BCE AUC: 0.7245, Mastery AUC: 0.6183
Patience: 1/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0874, BCE: 0.0869, Mastery: 0.1001
Valid - Loss: 0.0868, Total AUC: 0.7238, BCE AUC: 0.7239, Mastery AUC: 0.6189
Patience: 2/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0870, BCE: 0.0864, Mastery: 0.0998
Valid - Loss: 0.0870, Total AUC: 0.7230, BCE AUC: 0.7231, Mastery AUC: 0.6208
Patience: 3/4

================================================================================
Epoch 13/30
================================================================================
Train - Loss: 0.0866, BCE: 0.0860, Mastery: 0.0997
Valid - Loss: 0.0871, Total AUC: 0.7223, BCE AUC: 0.7223, Mastery AUC: 0.6224
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7248
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7187, Acc: 0.7477
BCE Head - AUC: 0.7189, Acc: 0.7478
Mastery Head - AUC: 0.6159, Acc: 0.7262
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 945652
‚úì Created experiment folder: 20251123_232416_gainakt4_lambda_bce_0.96_945652
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.96 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            945652
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.96 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_232416_gainakt4_lambda_bce_0.96_945652

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 945652

================================================================================
REPRODUCIBILITY INFRASTRUCTURE AUDIT
================================================================================
Verifying 'Explicit Parameters, Zero Defaults' compliance...
Enhanced with Priority 1 checks for complete protocol coverage

üìã CHECK 1: parameter_default.json MD5 Integrity
--------------------------------------------------------------------------------
  Stored MD5:   c20a1432f7f3fe5bd4d8790e5d6b7c32
  Computed MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32
  Total parameters: 27
  ‚úÖ Match: YES

üìã CHECK 2: Hardcoded Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------

  Result: ‚úÖ PASS - All 3 fallback values synchronized

üìã CHECK 3: Model Initialization Fallback Removal (Priority 2)
--------------------------------------------------------------------------------
  config.get() calls:          0
  config['key'] direct access: 21
  Fail-fast error handling:    ‚úÖ Present

  Result: ‚úÖ PASS - Model uses fail-fast approach

üìã CHECK 4: Eval Script Documentation (Priority 3)
--------------------------------------------------------------------------------
  Documentation header:        ‚úÖ Present
  All architectural flags doc: ‚úÖ Present

  Result: ‚úÖ PASS - Documentation complete

üìã CHECK 5: Parameter Coverage in parameter_default.json
--------------------------------------------------------------------------------
  Required parameters checked: 13
  Missing from defaults:       0

  Result: ‚úÖ PASS - All required parameters present

üìã CHECK 6: No Suspicious Hardcoded Values
--------------------------------------------------------------------------------
  ‚úÖ No suspicious hardcoded values found

  Result: ‚úÖ PASS

üìã CHECK 7: Argparse Completeness Validation (Priority 1)
--------------------------------------------------------------------------------
  Total parameters in defaults:    27
  Launcher-only (excluded):         4
  Should have argparse:             24
  Found in argparse:                24
  Boolean flags (store_true/false): 3
  Non-boolean params:               21
  Missing argparse entries:         0
  Missing required=True:            0

  Result: ‚úÖ PASS - All parameters have proper argparse entries
           (3 boolean flags, 21 with required=True)

üìã CHECK 8: Dynamic Fallback Synchronization (Priority 1)
--------------------------------------------------------------------------------
  Found 0 getattr() calls in training script

  Correct fallbacks: 0/0

  Result: ‚úÖ PASS - All 0 fallback values synchronized

üìã CHECK 9: Launcher Filter Validation (Priority 1)
--------------------------------------------------------------------------------
  ‚ö†Ô∏è  Could not find explicit filter logic in launcher
  Checking for implicit filtering patterns...
  ‚úÖ All 4 launcher-only params referenced in code

  Total parameters in defaults: 27
  Should be excluded:           4
  Should pass to training:      24

  Result: ‚úÖ PASS - Launcher filter logic correct

================================================================================
REPRODUCIBILITY AUDIT SUMMARY
================================================================================
‚úÖ PASS  MD5 Integrity
‚úÖ PASS  Fallback Synchronization (8 params)
‚úÖ PASS  Model Init Fallback Removal
‚úÖ PASS  Eval Script Documentation
‚úÖ PASS  Parameter Coverage
‚úÖ PASS  No Suspicious Values
‚úÖ PASS  Argparse Completeness (Priority 1)
‚úÖ PASS  Dynamic Fallback Sync (Priority 1)
‚úÖ PASS  Launcher Filter Validation (Priority 1)

================================================================================
üéâ ALL CHECKS PASSED (9/9)
‚úÖ REPRODUCIBILITY INFRASTRUCTURE: FULLY COMPLIANT
================================================================================

All reproducibility requirements verified:
  ‚Ä¢ Priority 1 (Critical Protection):
    - All parameters have argparse with required=True ‚úÖ
    - All getattr() fallbacks synchronized dynamically ‚úÖ
    - Launcher filter logic validated ‚úÖ
  ‚Ä¢ Priority 2 (Model Quality):
    - Model .get() fallbacks removed ‚úÖ
  ‚Ä¢ Priority 3 (Documentation):
    - Eval documentation present ‚úÖ
  ‚Ä¢ Infrastructure Integrity:
    - MD5 integrity maintained ‚úÖ
    - Parameter coverage complete ‚úÖ
    - No suspicious values ‚úÖ

‚úÖ Protocol Coverage: ~85% (up from 60%)
‚úÖ Risk Level: LOW (down from MEDIUM)

Safe to launch training/evaluation experiments.
================================================================================
================================================================================
GainAKT4 Training
================================================================================
Dataset: assist2015
Fold: 0
Epochs: 30
Batch size: 64
Learning rate: 0.0001
Lambda BCE: 0.97
Lambda Mastery: 0.030000000000000027 (automatically computed)
Device: cuda
Experiment dir: /workspaces/pykt-toolkit/examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440
================================================================================

üìä Loading dataset...
dataset_name:assist2015
data_config:{'assist2015': {'dpath': '/workspaces/pykt-toolkit/data/assist2015', 'num_q': 0, 'num_c': 100, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv', 'trajectories_file': 'trajectories.csv'}, 'algebra2005': {'dpath': '/workspaces/pykt-toolkit/data/algebra2005', 'num_q': 173113, 'num_c': 112, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'assist2009': {'dpath': '/workspaces/pykt-toolkit/data/assist2009', 'num_q': 17737, 'num_c': 123, 'input_type': ['questions', 'concepts'], 'max_concepts': 4, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'slepemapy': {'dpath': '/workspaces/pykt-toolkit/data/slepemapy', 'num_q': 2913, 'num_c': 1458, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2017': {'dpath': '/workspaces/pykt-toolkit/data/assist2017', 'num_q': 3162, 'num_c': 102, 'input_type': ['questions', 'concepts'], 'min_seq_len': 3, 'maxlen': 500, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'assist2012': {'dpath': '/workspaces/pykt-toolkit/data/assist2012', 'num_q': 53070, 'num_c': 265, 'input_type': ['questions', 'concepts'], 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'statics2011': {'dpath': '/workspaces/pykt-toolkit/data/statics2011', 'num_q': 0, 'num_c': 1223, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'junyi2015': {'dpath': '/workspaces/pykt-toolkit/data/junyi2015', 'num_q': 721, 'num_c': 39, 'input_type': ['questions', 'concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv'}, 'bridge2algebra2006': {'dpath': '/workspaces/pykt-toolkit/data/bridge2algebra2006', 'num_q': 129263, 'num_c': 493, 'input_type': ['questions', 'concepts'], 'max_concepts': 5, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet': {'dpath': '/workspaces/pykt-toolkit/data/ednet', 'num_q': 11901, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'nips_task34': {'dpath': '/workspaces/pykt-toolkit/data/nips_task34', 'num_q': 948, 'num_c': 57, 'input_type': ['questions', 'concepts'], 'max_concepts': 2, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'poj': {'dpath': '/workspaces/pykt-toolkit/data/poj', 'num_q': 0, 'num_c': 2748, 'input_type': ['concepts'], 'max_concepts': 1, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'peiyou': {'dpath': '/workspaces/pykt-toolkit/data/peiyou', 'num_q': 7652, 'num_c': 865, 'input_type': ['questions', 'concepts'], 'max_concepts': 6, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'train_valid_original_file': 'train_valid.csv', 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'ednet5w': {'dpath': '/workspaces/pykt-toolkit/data/ednet5w', 'num_q': 12235, 'num_c': 188, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 200, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}, 'pretrain': {'dpath': '/workspaces/pykt-toolkit/data/pretrain', 'num_q': 340614, 'num_c': 1838, 'input_type': ['questions', 'concepts'], 'max_concepts': 7, 'min_seq_len': 3, 'maxlen': 1024, 'emb_path': '', 'train_valid_original_file': 'train_valid.csv', 'train_valid_file': 'train_valid_sequences.csv', 'folds': [0, 1, 2, 3, 4], 'test_original_file': 'test.csv', 'test_file': 'test_sequences.csv', 'test_window_file': 'test_window_sequences.csv', 'test_question_file': 'test_question_sequences.csv', 'test_question_window_file': 'test_question_window_sequences.csv', 'train_valid_original_file_quelevel': 'train_valid_quelevel.csv', 'train_valid_file_quelevel': 'train_valid_sequences_quelevel_200.csv', 'test_file_quelevel': 'test_sequences_quelevel.csv', 'test_window_file_quelevel': 'test_window_sequences_quelevel.csv', 'test_original_file_quelevel': 'test_quelevel.csv'}}
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_0.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 3082, rlen: 3082
Read data from processed file: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv_1_2_3_4.pkl
file path: /workspaces/pykt-toolkit/data/assist2015/train_valid_sequences.csv, qlen: 0, clen: 12344, rlen: 12344
‚úì Dataset loaded: 100 concepts
‚úì Training batches: 193
‚úì Validation batches: 49

üèóÔ∏è  Initializing model...
‚úì Multi-GPU detected: 6 GPUs available
  CUDA_VISIBLE_DEVICES: 0,1,2,3,4,5
  GPU devices: Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB, Tesla V100-SXM2-32GB
‚úì Wrapping model with DataParallel for multi-GPU training
‚úì Model initialized: 10,731,090 parameters

üöÄ Starting training...

================================================================================
Epoch 1/30
================================================================================
Train - Loss: 0.1104, BCE: 0.1084, Mastery: 0.1729
Valid - Loss: 0.0908, Total AUC: 0.6866, BCE AUC: 0.6865, Mastery AUC: 0.5421
‚úì Saved best model (AUC: 0.6866)

================================================================================
Epoch 2/30
================================================================================
Train - Loss: 0.0940, BCE: 0.0934, Mastery: 0.1102
Valid - Loss: 0.0889, Total AUC: 0.7054, BCE AUC: 0.7054, Mastery AUC: 0.5793
‚úì Saved best model (AUC: 0.7054)

================================================================================
Epoch 3/30
================================================================================
Train - Loss: 0.0923, BCE: 0.0919, Mastery: 0.1073
Valid - Loss: 0.0879, Total AUC: 0.7139, BCE AUC: 0.7141, Mastery AUC: 0.5948
‚úì Saved best model (AUC: 0.7139)

================================================================================
Epoch 4/30
================================================================================
Train - Loss: 0.0912, BCE: 0.0908, Mastery: 0.1051
Valid - Loss: 0.0873, Total AUC: 0.7191, BCE AUC: 0.7193, Mastery AUC: 0.6017
‚úì Saved best model (AUC: 0.7191)

================================================================================
Epoch 5/30
================================================================================
Train - Loss: 0.0904, BCE: 0.0900, Mastery: 0.1039
Valid - Loss: 0.0869, Total AUC: 0.7221, BCE AUC: 0.7223, Mastery AUC: 0.6059
‚úì Saved best model (AUC: 0.7221)

================================================================================
Epoch 6/30
================================================================================
Train - Loss: 0.0898, BCE: 0.0894, Mastery: 0.1030
Valid - Loss: 0.0867, Total AUC: 0.7239, BCE AUC: 0.7240, Mastery AUC: 0.6086
‚úì Saved best model (AUC: 0.7239)

================================================================================
Epoch 7/30
================================================================================
Train - Loss: 0.0892, BCE: 0.0888, Mastery: 0.1023
Valid - Loss: 0.0866, Total AUC: 0.7245, BCE AUC: 0.7246, Mastery AUC: 0.6087
‚úì Saved best model (AUC: 0.7245)

================================================================================
Epoch 8/30
================================================================================
Train - Loss: 0.0887, BCE: 0.0883, Mastery: 0.1018
Valid - Loss: 0.0866, Total AUC: 0.7250, BCE AUC: 0.7251, Mastery AUC: 0.6121
‚úì Saved best model (AUC: 0.7250)

================================================================================
Epoch 9/30
================================================================================
Train - Loss: 0.0883, BCE: 0.0879, Mastery: 0.1015
Valid - Loss: 0.0866, Total AUC: 0.7250, BCE AUC: 0.7251, Mastery AUC: 0.6137
Patience: 1/4

================================================================================
Epoch 10/30
================================================================================
Train - Loss: 0.0878, BCE: 0.0874, Mastery: 0.1010
Valid - Loss: 0.0867, Total AUC: 0.7245, BCE AUC: 0.7245, Mastery AUC: 0.6151
Patience: 2/4

================================================================================
Epoch 11/30
================================================================================
Train - Loss: 0.0873, BCE: 0.0869, Mastery: 0.1007
Valid - Loss: 0.0868, Total AUC: 0.7239, BCE AUC: 0.7240, Mastery AUC: 0.6156
Patience: 3/4

================================================================================
Epoch 12/30
================================================================================
Train - Loss: 0.0868, BCE: 0.0864, Mastery: 0.1005
Valid - Loss: 0.0869, Total AUC: 0.7231, BCE AUC: 0.7231, Mastery AUC: 0.6181
Patience: 4/4

‚èπÔ∏è  Early stopping triggered

================================================================================
‚úÖ Training completed successfully
Best validation AUC: 0.7250
Results saved to: /workspaces/pykt-toolkit/examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440
================================================================================

================================================================================
üìä LAUNCHING EVALUATION
================================================================================
‚úÖ Evaluation completed successfully
================================================================================
================================================================================
================================================================================
================================================================================
Test Results:
================================================================================
Combined (Total) - AUC: 0.7189, Acc: 0.7474
BCE Head - AUC: 0.7190, Acc: 0.7473
Mastery Head - AUC: 0.6114, Acc: 0.7260
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================
================================================================================

================================================================================
LAUNCHING MASTERY STATES ANALYSIS
================================================================================
Mastery states command: /home/vscode/.pykt-env/bin/python3 examples/mastery_states.py --run_dir /workspaces/pykt-toolkit/examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440 --num_students 20 --split test
‚úÖ Mastery states analysis completed successfully
‚úì Saved 761 rows to: /workspaces/pykt-toolkit/examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440/mastery_states_test.csv
‚úì Saved summary to: /workspaces/pykt-toolkit/examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440/mastery_states_summary_test.json
‚úÖ Mastery states analysis completed successfully
================================================================================

================================================================================
REPRODUCIBILITY PRE-FLIGHT CHECK
================================================================================
Running parameter audit to verify infrastructure compliance...


‚úÖ Pre-flight check PASSED - Safe to proceed

================================================================================
TRAINING MODE
================================================================================
Generated experiment ID: 740440
‚úì Created experiment folder: 20251123_233135_gainakt4_lambda_bce_0.97_740440
  Override: seed = 42 (type: int)
  Override: epochs = 30 (type: int)
  Override: batch_size = 64 (type: int)
  Override: learning_rate = 0.0001 (type: float)
  Override: weight_decay = 1.7571e-05 (type: float)
  Override: optimizer = Adam (type: str)
  Override: gradient_clip = 1.0 (type: float)
  Override: patience = 4 (type: int)
  Override: monitor_freq = 50 (type: int)
  Override: seq_len = 200 (type: int)
  Override: d_model = 256 (type: int)
  Override: n_heads = 4 (type: int)
  Override: num_encoder_blocks = 8 (type: int)
  Override: d_ff = 1536 (type: int)
  Override: dropout = 0.2 (type: float)
  Override: emb_type = qid (type: str)
  Override: lambda_bce = 0.97 (type: float)
  Override: num_trajectories = 10 (type: int)
  Override: min_trajectory_steps = 10 (type: int)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================

‚úì Saved config.json
‚úì Config integrity verified (MD5: c20a1432f7f3fe5bd4d8790e5d6b7c32)

================================================================================
GPU SELECTION
================================================================================
Total GPUs available: 8
GPUs selected for training: 6 (75%)
CUDA_VISIBLE_DEVICES will be set to: 0,1,2,3,4,5
================================================================================


Experiment ID:            740440
Dataset:                  assist2015
Fold:                     0
Epochs:                   30
Batch size:               64
Learning rate:            0.0001

Training command:        
  CUDA_VISIBLE_DEVICES=0,1,2,3,4,5 EXPERIMENT_DIR=/workspaces/pykt-toolkit/examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440 /home/vscode/.pykt-env/bin/python3 examples/train_gainakt4.py --auto_shifted_eval --batch_size 64 --d_ff 1536 --d_model 256 --dataset assist2015 --dropout 0.2 --emb_type qid --epochs 30 --fold 0 --gradient_clip 1.0 --lambda_bce 0.97 --learning_rate 0.0001 --min_trajectory_steps 10 --monitor_freq 50 --n_heads 4 --num_encoder_blocks 8 --num_trajectories 10 --optimizer Adam --patience 4 --seed 42 --seq_len 200 --weight_decay 1.7571e-05

================================================================================
LAUNCHING TRAINING
================================================================================


================================================================================
‚úì TRAINING COMPLETED SUCCESSFULLY
================================================================================

Results saved to: examples/experiments/20251123_233135_gainakt4_lambda_bce_0.97_740440

Note: Evaluation is automatically launched by the training script

To reproduce this experiment:
  python examples/run_repro_experiment.py \
    --repro_experiment_id 740440
================================================================================
Lambda BCE Sweep for GainAKT4 on ASSISTments 2015
================================================================================

Baseline: Experiment 276818 (lambda_bce=1.0, test AUC: 0.7193)
Sweep range: lambda_bce ‚àà [0.88, 0.97]
Total experiments: 10

Fixed parameters:
  dataset: assist2015
  fold: 0
  seed: 42
  epochs: 30
  batch_size: 64
  learning_rate: 0.0001
  weight_decay: 1.7571e-05
  optimizer: Adam
  gradient_clip: 1.0
  patience: 4
  monitor_freq: 50
  seq_len: 200
  d_model: 256
  n_heads: 4
  num_encoder_blocks: 8
  d_ff: 1536
  dropout: 0.2
  emb_type: qid
  num_trajectories: 10
  min_trajectory_steps: 10

Starting sweep...


================================================================================
Experiment 1/10: lambda_bce=0.88, lambda_mastery=0.12
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.88 --lambda_bce=0.88 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 1/10 completed successfully in 7.3 minutes

================================================================================
Experiment 2/10: lambda_bce=0.89, lambda_mastery=0.11
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.89 --lambda_bce=0.89 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 2/10 completed successfully in 7.3 minutes

================================================================================
Experiment 3/10: lambda_bce=0.90, lambda_mastery=0.10
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.90 --lambda_bce=0.9 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 3/10 completed successfully in 7.7 minutes

================================================================================
Experiment 4/10: lambda_bce=0.91, lambda_mastery=0.09
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.91 --lambda_bce=0.91 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 4/10 completed successfully in 7.3 minutes

================================================================================
Experiment 5/10: lambda_bce=0.92, lambda_mastery=0.08
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.92 --lambda_bce=0.92 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 5/10 completed successfully in 7.3 minutes

================================================================================
Experiment 6/10: lambda_bce=0.93, lambda_mastery=0.07
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.93 --lambda_bce=0.93 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 6/10 completed successfully in 7.4 minutes

================================================================================
Experiment 7/10: lambda_bce=0.94, lambda_mastery=0.06
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.94 --lambda_bce=0.94 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 7/10 completed successfully in 7.4 minutes

================================================================================
Experiment 8/10: lambda_bce=0.95, lambda_mastery=0.05
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.95 --lambda_bce=0.95 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 8/10 completed successfully in 7.3 minutes

================================================================================
Experiment 9/10: lambda_bce=0.96, lambda_mastery=0.04
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.96 --lambda_bce=0.96 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 9/10 completed successfully in 7.3 minutes

================================================================================
Experiment 10/10: lambda_bce=0.97, lambda_mastery=0.03
================================================================================

Command: /home/vscode/.pykt-env/bin/python3 examples/run_repro_experiment.py --short_title=lambda_bce_0.97 --lambda_bce=0.97 --dataset=assist2015 --fold=0 --seed=42 --epochs=30 --batch_size=64 --learning_rate=0.0001 --weight_decay=1.7571e-05 --optimizer=Adam --gradient_clip=1.0 --patience=4 --monitor_freq=50 --seq_len=200 --d_model=256 --n_heads=4 --num_encoder_blocks=8 --d_ff=1536 --dropout=0.2 --emb_type=qid --num_trajectories=10 --min_trajectory_steps=10


‚úÖ Experiment 10/10 completed successfully in 7.0 minutes

================================================================================
SWEEP SUMMARY
================================================================================

Total experiments: 10
Successful: 10
Failed: 0

Results:
  ‚úÖ lambda_bce=0.88 (lambda_mastery=0.12)
  ‚úÖ lambda_bce=0.89 (lambda_mastery=0.11)
  ‚úÖ lambda_bce=0.90 (lambda_mastery=0.10)
  ‚úÖ lambda_bce=0.91 (lambda_mastery=0.09)
  ‚úÖ lambda_bce=0.92 (lambda_mastery=0.08)
  ‚úÖ lambda_bce=0.93 (lambda_mastery=0.07)
  ‚úÖ lambda_bce=0.94 (lambda_mastery=0.06)
  ‚úÖ lambda_bce=0.95 (lambda_mastery=0.05)
  ‚úÖ lambda_bce=0.96 (lambda_mastery=0.04)
  ‚úÖ lambda_bce=0.97 (lambda_mastery=0.03)
